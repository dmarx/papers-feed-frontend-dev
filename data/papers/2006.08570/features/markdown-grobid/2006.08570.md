# Cross-temporal forecast reconciliation: Optimal combination method and heuristic alternatives

## Abstract

## 

Forecast reconciliation is a post-forecasting process aimed to improve the quality of the base forecasts for a system of hierarchical/grouped time series [(Hyndman et al., 2011)](#b23). Contemporaneous (cross-sectional) and temporal hierarchies have been considered in the literature, but -except for Kourentzes and Athanasopoulos (2019) -generally these two features have not been fully considered together. Adopting a notation able to simultaneously deal with both forecast reconciliation dimensions, the paper shows two new results: (i) an iterative cross-temporal forecast reconciliation procedure which extends, and overcomes some weaknesses of, the two-step procedure by Kourentzes and Athanasopoulos (2019), and (ii) the closed-form expression of the optimal (in least squares sense) point forecasts which fulfill both contemporaneous and temporal constraints. The feasibility of the proposed procedures, along with first evaluations of their performance as compared to the most performing 'single dimension' (either cross-sectional or temporal) forecast reconciliation procedures, is studied through a forecasting experiment on the 95 quarterly time series of the Australian GDP from Income and Expenditure sides considered by [Athanasopoulos et al. (2019)](#b2).

## Introduction

In several operational fields, decisions to be successful require the support of accurate, detailed but also coherent forecasts. Forecasts are coherent when the predicted values at the disaggregate and aggregate scales are equal when brought to the same level. For example, temporally coherent monthly predictions sum up to annual ones and similarly geographically coherent regional predictions add up to country level ones. Such a coherence is an important qualifier for forecasts, so as to support aligned decision making across different planning units and horizons, while avoiding that different decision making units plan on different views of the future. For example, [Kourentzes and Athanasopoulos (2019)](#b34) generate forecasts for Australian domestic tourism that are coherent across multiple geographical divisions (regions, zones, states, and whole country), but are also coherent across time (at monthly, bi-monthly, quarterly, 4-monthly, 6-monthly, and annual levels), i.e. for different planning horizons.

As a matter of fact, in the growing literature on hierarchical forecast reconciliation the cross-sectional (contemporaneous) and temporal coherency dimensions are mostly considered in separate ways: either 'time-by-time' cross-sectional forecast reconciliation for a n-dimensional time series [(Hyndman et al., 2011](#b23)[(Hyndman et al., , 2020))](#), or temporal coherency for the forecasts of a single variable for different time frequencies [(Athanasopoulos et al., 2017, Hyndman and](#b3)[Kourentzes, 2018)](#b33). The issue of getting coherent forecasts along both crosssectional and temporal dimensions (i.e., cross-temporal coherency) has been dealt with by [Yagli et al. (2019)](#b61) and [Spiliotis et al. (2020)](#). However, as far as we know, the procedure proposed by [Kourentzes and Athanasopoulos (2019)](#b34) is the only one able to simultaneously fulfill both cross-sectional and temporal coherency in the final reconciled point forecasts at any considered aggregation dimension.

Whereas the most recent forecast reconciliation procedures for each single coherence dimension are based on some optimality criterion [(van Erven and](#b17)[Cugliari, 2015, Wickramasuriya et al., 2019)](#), the cross-temporal reconciliation procedure by [Kourentzes and Athanasopoulos (2019)](#b34) can be considered as an heuristic with a simple and effective structure, i.e. an approach that employs a practical method that is not guaranteed to be optimal, but which is nevertheless sufficient for reaching an immediate goal, which in our case is the coherency along all the considered dimensions of the reconciled forecasts. This fact is probably due to the consideration that in a cross-temporal forecast reconciliation framework the complexity and the dimensions of the problem grow very quickly along with the requested computational time and memory [(Kourentzes and](#)[Athanasopoulos, 2019, Nystrup et al., 2020)](#). This is certainly true, but nevertheless an appropriate, thorough use of some well known linear algebra tools, and the expanding computation facilities, in terms of both calculation power and memory, makes it feasible to look for the optimal solution (in least squares sense) expanding the field of application of the 'forecast reconciliation methodology' to simultaneously encompass both contemporaneous (cross-sectional) and temporal coherency dimensions.

Bottom-up and top-down approaches to forecast reconciliation are well known to both practitioners and researchers. In short, according to the bottom-up approach [(Dunn et al., 1976)](#b15), the forecasts at the most disaggregated level are summed up to obtain the aggregates of interest. On the contrary, in the top-down approach [(Gross and Sohl, 1990)](#b19) the most aggregated series is forecasted first, and then is disaggregated to provide lower level predictions [(Fliedner, 2001](#b18)[, Athanasopoulos et al., 2009](#b1), and the references therein). A combination of these two approaches, known as middle-out [(Athanasopoulos et al., 2009)](#b1), selects an intermediate level of (dis)aggregation, and moves downward in a top-down fashion, and onwards according to bottom-up.

However, in the last decade there have been several contributions exploiting a regression based optimal combination approach [(Hyndman et al., 2011)](#b23), which has proven convincing from a mathematical-statistical point of view, flexible enough to be adapted to both cross-sectional and temporal frameworks [(Wickramasuriya et al., 2019, and](#b59)[Athanasopoulos et al., 2017, respectively)](#), and very effective in improving the base forecasts from many different application fields [(economics, demography, energy, tourism, etc.)](#).

In this paper we consider an optimal combination approach, which takes the base (incoherent and however obtained) forecasts of all nodes in the hierarchy, and reconcile them. We show that all the summation constraints induced by the cross-temporal hierarchy underlying the time series, may be used to reconciliate the base forecasts through a simple projection in a well chosen linear space. At this end, we extend the optimal (in least squares sense) solutions separately proposed for each coherency dimension, developing the optimal point forecasting procedure which -while exploiting both cross-sectional and temporal hierarchies -simultaneously fulfills both contemporaneous and temporal constraints. We refer to this as optimal combination cross-temporal forecast reconciliation. In addition, grounding on the existing literature on this topic [(Wickramasuriya et al., 2019](#b59)[, Athanasopoulos et al., 2017](#b3)[, and Nystrup et al., 2020)](#b44), we discuss some simple approximations of the covariance matrix to be used in the statistical point forecast reconciliation, with focus on those making use of the in-sample residuals (when available) of the models used to get the base forecasts. The strictly, and very important related issue of probabilistic forecast reconciliation [(Panagiotelis et al., 2020b](#b46)[, Athanasopoulos et al., 2019](#)[, Hong et al., 2019](#b22)[, Jeon et al., 2019](#b29)[, Roach, 2019](#b48)[, Ben Taieb et al., 2020](#b4)[, Yang, 2020)](#b62) is not considered in this paper, and will be dealt with in the near future.

The paper is organized as follows. We start by presenting the general framework of point forecast reconciliation according to a projection approach [(Byron, 1978](#b7)[, van Erven and Cugliari, 2015](#b17)[, Panagiotelis et al., 2020a)](#), avoiding reference to cross-sectional or time indices (section 2). Hierarchical and grouped systems of multivariate time series are introduced in section 3. The temporal hierarchies which characterize a single time series are discussed in section 4. The cross-sectional and temporal coherency dimensions are dealt with simultaneously in section 5, and the optimal (in least squares sense) solution to the crosstemporal forecast reconciliation problem is then developed in section 6. The heuristics proposed by [Kourentzes and Athanasopoulos (2019)](#b34) is described in section 7, where some variants of that procedure are discussed. In particular, a very simple (and possibly more effective) iterative cross-temporal reconciliation procedure is proposed. The feasibility of all the proposed procedures, along with the evaluation of their performance as compared to the most performing 'single dimension' (either cross-sectional or temporal) forecast reconciliation procedures, is studied in section 8 through a forecasting experiment on the 95 quarterly time series of the Australian GDP from Income and Expenditure sides considered by [Athanasopoulos et al. (2019)](#b2) and [Bisaglia et al. (2020)](#b6). Section 9 presents conclusions and lists some topics in this field worth to be considered for future research. Finally, the Appendix contains complementary materials, on both methodological and practical issues, not considered into the paper for length reasons. In addition, it contains supplementary tables and graphs related to the empirical application. 

## Symbols and notation used in the paper

## Symbols

$k p = m, k 1 = 1 k * p-1 j=1 k j M k m k , k ∈ K b t ∈ R n b$vector containing the bottom time series (bts) at time t a t ∈ R n a vector containing the upper time series (uts) at time t y t ∈ R n vector containing the time series y t = a t b t at time t Y, Y, Y ∈ R n×h(k * +m) Matrices of target, base and cross-temporally reconciled forecasts Y [k] , k ∈ K (n × hM k ) matrix containing the target forecasts of the level k temporally aggregated series. Component of matrix , Y

$Y = Y [m] Y [k p-1 ] . . . Y [k 2 ] Y [1] Y [k] , k ∈ K (n × hM k ) matrix$$[k p-1 ] , . . . , Y [k 2 ] , Y [1] Y [k]$, k ∈ K (n × hM k ) matrix containing the cross-temporally reconciled forecasts of the level k temporally aggregated series. Component of matrix

$Y = Y [m]$, Y

$[k p-1 ] , . . . , Y [k 2 ]$, Y

[1]

A [k] , B [k] , k ∈ K (n a × hM k ) and (n b × hM k ) components of matrix

$Y [k] = A [k] B [k] B * ∈ R n b ×hk * B [m] B [k p-1 ] • • • B [k 2 ] y, ŷ, ỹ ∈ R nh(k * +m) y = vec Y , ŷ = vec Y , ỹ = vec Y y ∈ R nh(k * +m)$Alternative vectorization of matrix Y, used in the cross-temporal structural representation:

$y =    vec A vec B * vec B [1]    C ∈ R n a ×n b Cross-sectional (contemporaneous) aggregation matrix S ∈ R n×n b$Cross-sectional (contemporaneous) summing matrix U ∈ R n a ×n Zero constraints cross-sectional kernel matrix:

$U Y = 0 [n a ×(k * +m)] K h ∈ R hk * ×hm Temporal aggregation matrix R h ∈ R h(k * +m)×hm$Temporal summing matrix

$Z h ∈ R hk * ×h(k * +m)$Zero constraints temporal kernel matrix:

$Z h Y = 0 [hk * ×n] H ∈ R hn * a ×nh(k * +m)$Zero constraints full row-rank cross-temporal kernel matrix:

$H y = 0 Č ∈ R n * a ×n b m$Cross-temporal aggregation matrix (structural representation) for h = 1 Š ∈ R n(k * +m)×n b m

Cross-temporal summing matrix (structural representation) for h = 1 Ȟ ∈ R hn * a ×nh(k * +m)

Zero constraints full row-rank cross-temporal kernel matrix valid for y: Ȟ y = 0 2. Optimal point forecast reconciliation: projection approach Forecast reconciliation is a post-forecasting process aimed to improve the quality of the base forecasts for a system of hierarchical/grouped, and more generally linearly constrained, time series [(Hyndman et al., 2011](#b23)[, Panagiotelis et al., 2020a)](#) by exploiting the constraints that the series in the system must fulfill, whereas in general the base forecasts don't.

Let y be a (s × 1) vector of target point forecasts which are wished to satisfy the system of linearly independent constraints

$H y = 0 (r×1) ,(1)$where H is a (r × s) matrix, with rank(H ) = r < s, and 0 (r×1) is a (r × 1) null vector.

Let ŷ be a (s × 1) vector of unbiased point forecasts, not fulfilling the linear constraints (1) (i.e., H ŷ = 0). Drawing upon [Stone et al. (1942)](#b57), [Byron (1978)](#b7), [Weale (1988)](#b58), [Solomou and Weale (1993)](#b54), and [Dagum and Cholette (2006)](#b8), among others, we consider a regression-based reconciliation method assuming that ŷ is related to y by

$ŷ = y + ε, (2$$)$where ε is a (s × 1) vector of zero mean disturbances, with known p.d. covariance matrix W. The reconciled forecasts ỹ are found by minimizing the generalized least squares (GLS) objective function (ŷ -y) W -[foot_0](#foot_0) (ŷ -y) constrained by (1):

$ỹ = arg min y (y -ŷ) W -1 (y -ŷ) , s.t. H y = 0.$The solution is given by (see Appendix A.1):

$ỹ = ŷ -WH H WH -1 H ŷ = Mŷ,(3)$where M = I s -WH (H WH) -1 H is a (s × s) projection matrix 1 . Denoting with d ŷ = 0 -H ŷ the (r × 1) vector containing the base forecasts' 'coherency' errors, we can re-state expression (3) as

$ỹ = ŷ + WH H WH -1 d ŷ,$which makes it clear that the reconciliation formula (3) simply 'adjusts' the original forecasts vector ŷ with a linear combination -according to the smoothing matrix WH (H WH)

-1

-of the coherency errors in the base forecasts. In addition, if the error term of model ( [2](#formula_12)) is gaussian, the reconciliation error ε = ỹy is a zero-mean gaussian vector with covariance matrix

$E (ỹ -y) (ỹ -y) = W -WH H WH -1 H = MW.$Hyndman et al. (2011, see also [Wickramasuriya et al., 2019)](#b59) propose an alternative formulation as for the reconciled estimates, equivalent to expression (3) and obtained by GLS estimation of the model

$ŷ = Sβ + ε,(4)$where S is a 'structural summation matrix' describing the aggregation relationships operating on y, and β is a subset of y containing the target forecasts of the bottom level series, such that y = Sβ (see section 3). Since the hypotheses on ε remain unchanged, it can be shown (see Appendix A.1) that β = S W -1 S -1 S W -1 ŷ is the best linear unbiased estimate of β, and that the whole reconciled forecasts vector is given by ỹ = S β = SGŷ,

where G = S W -1 S -1 S W -1 .

As witnessed by the huge literature on adjusting preliminary data (as the base forecasts can be considered) in order to fulfill some externally imposed constraints, the distinctive feature of the generalized least-squares reconciliation approach is that it can take into account the 'quality', however measured, of the preliminary estimates, through an appropriate choice of the covariance matrix W. However, for a long time these procedures have depended on the assumption that this matrix (or any other indicators of the estimates' accuracy) of the figures to be reconciled was known. In many practical situation W is assumed to be diagonal, and the data are adjusted in the light of their relative variances so as to satisfy the linear restrictions. But another -perhaps more delicate -challenge raises when either any reliability measure is available or it can be hardly deduced by the data. The solutions proposed in literature for this case are basically of two types, both of which are consistent with the least-squares approach shown so far:

1. mathematical/mechanical solutions: the base forecasts are balanced by minimizing a penalty criterion which 'induces' a covariance matrix (which is simply a statistical artifact); 2. data-based solutions: the variability of the base forecasts to be reconciled is estimated through the models and the data used to produce the forecasts.

As for point forecast reconciliation, in the following we will consider both approaches, with an explicit preference towards approximations of W based on the in-sample residuals (when available), which appear both more convincing from a statistical point of view, and generally well-performing in practical applications. However, this topic deserves further attention [(Jeon et al., 2019, p. 368](#), see also [Kourentzes, 2017](#b32)[Kourentzes, , 2018))](#b33), and will be considered for future research.

## Hierarchical and Grouped Time Series

Extending the definition of hierarchical time series given by [Panagiotelis et al. (2020a)](#), a linearly constrained time series y t is a n-dimensional time series such that all observed values y 1 . . . y T and all future values y T +1 , y T +2 . . . lie in the coherent linear subspace S , that is: y t ∈ S , ∀t. In many situations, the time series are linked through summation constraints, which induce a hierarchy. Figure [1](#fig_2) gives an example of a hierarchical system with eight variables and three levels: the top-variable at level 1, two variables (A and B) at level 2, and five variables at level 3 (AA, AB, BA, BB, BB, BC). The temporal observations of these variables form a hierarchical time series, consisting of 5 bottom time series (bts) and 3 aggregated upper time series (uts).

Assuming that the relationship mapping the lower-level series in the hierarchy of Figure 1 into the higher ones always be a simple summation[foot_1](#foot_1) , the bottom-level series can be thought as building blocks that cannot be obtained as sum of other series in the hierarchy, while all the series at upper levels can be expressed by appropriately summing part or all of them. For all time periods t = 1, . . . , T , the link between the top level series y t and the bottom level series is given by: y t = y AA,t + y AB,t + y BA,t + y BB,t + y BC,t .

(5)

At the same time, the nodes at the intermediate level of the hierarchy satisfy the aggregation constraints: y A,t = y AA,t + y AB,t y B,t = y BA,t + y BB,t + y BC,t .

In summary, there are as many summation constraints as many nodes with leaves (3, i.e. Total, A, B). Consider now the matrices C, S, and U , of dimension (3 × 5), (8 × 5), and (3 × 8), respectively:

$C =   1 1 1 1 1 1 1 0 0 0 0 0 1 1 1   , S =            $1 1 1 1 1 1 1 0 0 0 0 0 1 1 1 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1

$            = C I 5 , U = [I 3 -C] ,$where matrix U encodes each summation relationship in a row, with 1 at the associated node, and -1 at its leaves. Expressions ( [5](#)) and ( [6](#formula_19)) can be written in a more compact way if we define the vectors of bottom level (b t ) and upper level (a t ) time series at time t as, respectively,

$b t =       y AA,t y AB,t y BA,t y BA,t y BA,t       , a t =   y t y A,t y B,t   .$Denoting by y t the (8 × 1) vector y t = [a t b t ] , the relationships linking bottom and upper time series can be equivalently expressed as:

$a t = Cb t , y t = Sb t , U y t = 0 (3×1) , t = 1, . . . , T.(7)$Thus, for any time index t, y t is in the kernel of U , also known as null-space of the linear transformation induced by matrix U , which is given by the set of vectors v ∈ R 7 , such that U v = 0 (3×1) [(Harville, 2008, p. 591)](#). We call structural representation of series y t the formulation y t = Sb t , t = 1, . . . , T, and zero constraints kernel representation of series y t the equivalent expression U y t = 0, t = . . . , T.

A linearly constrained time series formed by two or more hierarchical time series sharing the same top level series, and the same bottom level series, is called grouped time series [(Hyndman et al., 2011, Hyndman and](#b23)[Athanasopoulos, 2018)](#b24). Provided matrix C is appropriately designed, the definitions of matrices S and U , depending solely on matrix C, remain unchanged.

It should be noted that we can face linearly constrained time series for which the structural representaton y t = Sb t does not give a straightforward view of the links between bottom and upper level time series. Figure [2](#fig_3) shows two very simple hierarchies, where the variables of each hierarchy contribute (from different sides) to the same top level variable X, and the bottom level series of the hierarchy on the left side (A1,A2,B) are independent from those on the right side (C,D). The aggregation relationships between the upper variables X and A, and the bottom ones A1, A2, B, C, and D are given by:

## A1

$X = A1 + A2 + B X = C + D A = A1 + A2 . (8$$)$Expression (8) cannot be represented as a mapping from the bottom variables into (themselves, and) the upper variables. Nevertheless, it is possible to set up the constraints valid for all the component series in y = [X A A1 A2 B C D] through the matrix

$Ǔ =   1 0 -1 -1 -1 0 0 1 0 0 0 0 -1 -1 0 1 -1 -1 0 0 0   ,$such that Ǔ y = 0 (3×1) . After simple operations on expression (8), it is found:

$X = C + D A = -B + C + D A1 = -A2 -B + C + D ,(9)$so we can write U y = 0 (3×1) , with

$U =   1 0 0 0 0 -1 -1 0 1 0 0 1 -1 -1 0 0 1 1 1 -1 -1   = [I 3 -C] .$While there is no practical problem in working with such constraints, it is clear that they do not conform to the visual pattern of the linearly constrained time series in Figure [2](#fig_3), where A1 appears as a 'bottom variable', whereas in (9) it is expressed as linear combination of series A2, B, C, and D.

In addition, notice that the left side hierarchy of Figure [2](#fig_3) is 'unbalanced', in the sense that unlike node A, node B has no children, and thus is located at the bottom level of the hierarchy, though it could be considered at the same level as node A. Situations like that, often met in practice when dealing with hierarchical/grouped time series, require an appropriate formulation of the cross-sectional aggregation matrix C, in order to avoid nodes' duplication (see Appendix A.2).

## Alternative approximations of the covariance matrix for cross-sectional point forecast reconciliation

Suppose we have the (n × 1) vector ŷh of unbiased base forecasts for the n variables of the linearly constrained series y t for the forecast horizon h. If the base forecasts have been independently computed, generally they do not fulfill the cross-sectional aggregation constraints, i.e. U ŷh = 0 (n×1) . By adapting the general point forecast reconciliation formula (3), the vector of reconciled forecasts is given by:

$ỹh = ŷh -W cs U U W cs U -1 U ŷh ,(10)$where W cs is a (n × n) p.d. matrix, assumed known, and suffix 'cs' stands for 'crosssectional'. Alternative choices for W cs proposed in literature are the following:

• identity (cs-ols): W cs = I n [(Hyndman et al. 2011](#b23)),

• structural (cs-struc): [et al., 2017)](#),

$W cs = diag (S1 n b ) (Athanasopoulos$• series variance (cs-wls): W cs = W cs-var = I n W 1 [(Hyndman et al., 2016)](#b27),

• MinT-shr (cs-shr):

$W cs = W cs-shr = λ W cs-var + (1 -λ) W 1 (Wickramasuriya et al., 2019),$• MinT-sam (cs-sam): W cs = W 1 [(Wickramasuriya et al., 2019)](#b59),

where the symbol denotes the Hadamard product, λ is an estimated shrinkage coefficient [(Ledoit and](#b38)[Wolf, 2004, Shäfer and](#)[Strimmer, 2005)](#b50), W 1 is the sample covariance matrix of the one-step ahead in-sample forecast errors 3 :

$W 1 = 1 T T t=1 êt ê t ,(11)$3 Expression (11) assumes that T -1 T t=1 êt,i = 0, i = 1, . . . , n. When this does not hold, W1 is the sample Mean Square Error (MSE) matrix.

and êt = y t -ŷt , t = 1, . . . , T , are (n × 1) vectors of in-sample forecast errors.

The first three matrices are diagonal, and in the first case the projection is orthogonal, whereas the latter two ones (cs-shr and cs-sam) have been proposed within the minimumtrace point forecast reconciliation approach by [Wickramasuriya et al. (2019)](#b59). It should be noted that the quality of the estimate W 1 crucially depends on the dimension of T . In particular, when T < n, matrix W 1 is singular, which prevents the matrix inversion in expression [(10)](#). The shrunk version W cs-shr is a feasible alternative, well performing in many practical situations [(Wickramasuriya et al., 2019)](#b59).

## Matrix representation of the cross-sectional constraints

Let us denote with

$b t = [b 1t . . . b jt . . . b n b t ] , t = 1, . . . , T,(12)$the T vectors, each of dimension (n b × 1), containing the high-frequency bottom-time series (hf-bts), that is the bottom series of the hierarchy/group observed at the highest available temporal frequency. As we shall see in section 5, in cross-temporal hierarchies of time series the hf-bts should be considered as the 'very' bottom series of the system, since they cannot be formed as either contemporaneous or temporal sum of other variables. Likewise, let us denote with

$a t = [a 1t . . . a it . . . a nat ] , t = 1, . . . , T,(13)$the T vectors, each of dimension (n a × 1), containing the high-frequency upper-time series (hf-uts), which are the cross-sectionally aggregated series of the hierarchy/group, observed at the highest temporal frequency. At each time t = 1, . . . , T , the cross-sectional (contemporaneous) aggregation constraints that map the hf-bts into the hf-uts can be written as:

$a t = Cb t , t = 1, . . . , T,(14)$where C is a (n a × n b ) contemporaneous aggregation matrix. The structural representation of the linearly constrained time series y t is in turn given by [(Hyndman et al., 2011)](#b23):

$a t b t = C I n b b t ⇒ y t = Sb t , t = 1, . . . , T, where S = C I n b is a (n × n b ) contemporaneous summing matrix, with n = n a + n b .$The constraints valid for y t can be expressed in kernel form through the

$(n a × n) zero constraints matrix U = [I na -C] ,$that is:

$U y t = 0 (na×1) , t = 1, . . . , T.$Now, denote B the (n b × T ) matrix containing the T observations of the n b -variate hf-bts of the system:

$B =         b 11 . . . b 1t . . . b 1T . . . . . . . . . . . . . . . b i1 . . . b it . . . b iT . . . . . . . . . . . . . . . b n b 1 . . . b n b t . . . b n b T         = b 1 . . . b t . . . b T =         b * 1 . . . b * i . . . b * n b        $, where b t has been defined by (12), and

$b * i = [b i1 . . . b it . . . b iT ] , i = 1, . . . , n b ,$is the (T × 1) vector containing all the observations of the i-th univariate hf-bts, where the asterisk in b * i is used to distinguish this vector, which combines b it across all times for one series, from b t , which combines b it across all series for one time.

We consider the (n a × T ) matrix A for the hf-uts as well:

$A =        $a 11 . . . a 1t . . . a 1T . . . . . . . . . . . . . . . a j1 . . . a jt . . . a jT . . . . . . . . . . . . . . . a na1 . . . a nat . . . a naT

$        = a 1 . . . a t . . . a T =         a * 1 . . . a * j . . . a * na        $, where a t was defined by ( [13](#formula_34)), and

$a * j = [a j1 . . . a jt . . . a jT ] , j = 1, . . . , n a ,$is the (T ×1) vector containing all the observations of the j-th univariate component hf-uts.

The cross-sectional (contemporaneous) aggregation relationships (14) linking bottom and upper time series of y t can thus be expressed in compact form, by simultaneously encompassing all T time periods, for both types of data organization. In fact, extending expression ( [14](#formula_35)) to the whole observation period, it is

$A = CB,(15)$which is equivalent to

$U Y = 0 (na×T ) ,(16)$where

$Y = A B$is the (n × T ) matrix containing the observations of all n series. It is worth noting that the cross-sectional constraints ( [15](#formula_44)) and ( [16](#formula_45)) hold at any time observation index of any temporal frequency. This has to be considered when dealing with cross-temporal hierarchies (see section 5). Now, let us consider two vectorized forms of matrices B and A, namely: 

$b = vec (B) , a = vec (A) , b * = vec B , a * = vec A .$$* = b * 1 . . . b * j . . . b * n b , a * = a * 1 . . . a * j . . . a * na .$Switching between the two data representations is very simple, since vector b (a) can be obtained by simple transformation of vector b * (a * ) through an appropriate permutation matrix, and vice-versa (see Appendix [A.3.1)](#).

Depending on the preferred data organization type, the cross-sectional constraints (15) can be equivalently expressed in vectorized form as [(Harville, 2008, pp. 345](#)):

$a = vec (A) = (I T ⊗ C) vec (B) = (I T ⊗ C) b, a * = vec A = (C ⊗ I T ) vec (B ) = (C ⊗ I T ) b * ,(17)$where the symbol ⊗ denotes the Kronecker product. Expressions ( [17](#formula_49)) can be also formulated using matrix U , as in ( [16](#formula_45)), i.e.

$I T ⊗ U a b = 0 (T na×1) , U ⊗ I T a * b * = 0 (T na×1) .(18)$In order to avoid mistakes, one should note that, while

$y * = vec Y = vec A vec (B ) = a * b * ,(19)$it is in turn:

$y = vec (Y) = vec (A) vec (B) = a b .$Therefore, in the following when a matrix vectorization is needed, we will generally prefer using vectorized version of matrices Y , A , and B , as in ( [19](#formula_51)). In addition, to ease the notation, from now on the asterisk will be omitted, which means that, unlike we previously did, we denote with y, a, and b the following vectors:

$y = vec Y , a = vec A , b = vec B .$
## Temporal hierarchies

Following [Athanasopoulos et al. (2017)](#b3), we consider a time series {x t } T t=1 observed at the highest available sampling frequency per seasonal cycle, say m (e.g., month per year, m = 12, quarter per year, m = 4, hour per day, m = 24). Given a factor k of m,[foot_2](#foot_2) we can construct a temporally aggregated version of the time series x t , through the nonoverlapping sums of its k successive values, which has seasonal period equal to M k = m/k. To avoid ragged-edge data, we assume that the total number of observations of x t involved in the non-overlapping aggregation is a multiple of m, i.e. T = N • m, where N is the length of the most temporally aggregated version of the series, i.e. the series observed at the lowest available frequency.

We denote with K = {k m , k p-1 , . . . , k 2 , k 1 } the set of the p factors of m, in descending order, where k p = m and k 1 = 1. The temporally aggregated series of order k can be written as

$x [k] l = lk t=(l-1)k+1 x t , l = 1, . . . , T k , k ∈ K . (20$$)$Expression (20) accounts also for the trivial temporal aggregation transforming x t in itself (i.e., x t ≡ x

[1] l , l = t).

x

[1] 4(τ -1)+1

x

[1] 4(τ -1)+2

x

[1] 4(τ -1)+3

x

[1] 4τ

x

[2] 2(τ -1)+1

x

[2] 2τ

x

[4] τ

Figure [3](#): Temporal hierarchy for quarterly series using the common index τ for all levels of aggregation.

Since the observation index l in (20) varies with each aggregation level k, in order to express a common index for all levels, we define τ as the observation index of the most aggregated series, such that l = τ at that level, i.e.

x [m]  τ , τ = 1, . . . , N.

As for the other temporally aggregated series defined in expression (20), we stack the observations for each aggregation level below m in the (M k × 1) column vectors

$x [k] τ = x [k] M k (τ -1)+1 x [k] M k (τ -1)+2 . . . x [k] M k τ , τ = 1, . . . , N, k ∈ {k p-1 , . . . , k 2 , 1} . (21) We may collect x [m] τ$and the p -1 vectors defined by expression (21) in a single column vector, by keeping distinct the temporally aggregated data from the high-frequency one:

$x τ = x [m] τ x [k p-1 ] τ . . . x [k 2 ] τ x [1] τ = t xτ x [1] τ , τ = 1, . . . , N, where t xτ = x [m] τ x [k p-1 ] τ . . . x [k 2 ] τ is a (k * × 1) vector, with k * = p-1 j=1 k j , containing$all the temporally aggregated series at the observation index τ , x

[1] τ is the (m × 1) vector of observations of the time series at the highest available frequency within the complete τ -th cycle, and thus each

$x τ has dimension [(k * + m) × 1].$The relationships linking the original high-frequency series x t and its temporal aggregates can be graphically represented as a hierarchical/grouped series. For example, for quarterly data k ∈ {4, 2, 1}, then every four quarterly observations are aggregated up to annual and semi-annual counterparts. According to the notation so far, for a single year the quarterly hierarchical structure can be defined as in Figure [3](#), where x [4] , x [2] and x [1]  denote annual, semi-annual, and quarterly values, respectively.

The relationships linking the nodes in the hierarchy can be expressed as we did in (7) for the cross-sectional (contemporaneous) hierarchy case:

$t xτ = K 1 x [1] τ , x τ = R 1 x [1] τ , Z 1 x τ = 0 (k * ×1) , τ = 1, . . . , N,(22)$where K 1 is the (k * × m) temporal aggregation matrix converting the high-frequency observations into lower-frequency (temporally aggregated) ones,

$R 1 = K 1 I m is the [(k * + m) × m] temporal summing matrix, and Z 1 = [I k * -K 1 ]$is the zero constraints kernel matrix valid for x τ . For example, with quarterly data it is m = 4, k * = 3, and

$K 1 =   1 1 1 1 1 1 0 0 0 0 1 1   , R 1 =           1 1 1 1 1 1 0 0 0 0 1 1 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1           , Z 1 = [I 3 -K 1 ] .$The temporal aggregation relationships can be extended to the whole time span covered by series x t . Denoting by x = (x 1 . . . x τ . . . x N ) the [N (k * + m) × 1] vector containing all the data of series X at any observed temporal frequency, the complete set of temporal aggregation constraints valid for this vector is given by

$Z N x = 0 (N k * ×1) ,(23)$where

$Z N = [I N k * -K N ],$and

$K N = I N ⊗ 1 4 I 2N ⊗ 1 2 .$It is not always possible to represent the temporal aggregates of one series in a single tree[foot_3](#foot_3) such as Fig. [3](#). In Appendix A.4 the representations valid for monthly and hourly hierarchies are shown.

## Alternative approximations of the covariance matrix for point forecast reconciliation through temporal hierarchies

Suppose we have the [(k * + m) × 1] vector xh of unbiased base forecasts for the p temporal aggregates of a single time series X within a complete time cycle, i.e. at the forecast horizon h = 1 for the lowest (most aggregated) time frequency. If the base forecasts have been independently computed, generally they do not fulfill the temporal aggregation constraints, i.e. Z 1 xh = 0 (k * ×1) . By adapting the general point forecast reconciliation formula (3), and not considering suffix h to simplify the notation, the vector of temporally reconciled forecasts is given by:

$x = x -ΩZ 1 Z 1 ΩZ 1 -1 Z 1 x, (24$$)$where Ω is a [(k * + m) × (k * + m)] p.d. matrix, assumed known. In order to consider possible residual-based estimates of matrix Ω, denote

$ê[k] τ = x [k] τ -x[k] τ , τ = 1, . . . , N, k ∈ K ,(25)$the (M k × 1) vectors of the in-sample residuals at time index τ for the models used to generate the base forecasts of the temporally aggregated series of order k. These vectors can be organized in matrix form as

$E [k] x =            ê[k] 1 . . . ê[k] τ . . . ê[k] N            , k ∈ K ,(26)$where each matrix E

[k]

x has dimension (N × M k ), and then grouped in the [N × (k * + m)] matrix of in-sample residuals

$E x = E [m] x E [k p-1 ] x . . . E [k 2 ] x E [1]$x .

Each column of this matrix contains the in-sample residuals pertaining to a specific node of the temporal hierarchy, thus the sample cross-covariance matrix of the k * + m nodes of the temporal hierarchy is given by 6 :

$Ω = 1 N E x E x . (27$$)$This matrix is well defined if N > (k * + m), otherwise there might be singularity issues which would prevent its use in expression (24) in place of matrix Ω. [Athanasopoulos et al. (2017)](#b3) and [Hyndman and Kourentzes (2018)](#b26) consider the following alternative choices for Ω (the suffix 't' stands for 'temporal', to keep the 't'-procedures distinct from the 'cs'-ones shown in section 3.1):

• identity (t-ols):

$Ω = I k * +m , • structural (t-struc): Ω = Ω t-struc = diag (R 1 1 m ) • hierarchy variance scaling (t-wlsh): Ω = Ω t-wlsh = I k * +m Ω • series variance scaling (t-wlsv): Ω = Ω t-wlsv • MinT-shr (t-shr): Ω = Ω t-shr = λΩ t-wlsh + (1 -λ)Ω • MinT-sam (t-sam): Ω = Ω$The series variance scaling matrix Ω t-wlsv is a diagonal matrix "which contains estimates of the in-sample one-step-ahead error variances across each level" (Athanasopoulos et al.,   6 Expression (27) 

$assumes that N -1 N τ =1$êτ,l = 0, l = 1, . . . , k * + m. When this does not hold, Ω is the sample Mean Square Error (MSE) matrix. [2017, p. 64)](#), that requires a reduced number (p instead of k * + m) of variances to be estimated as compared to the hierarchy variance scaling matrix Ω t-wlsh , with increased sample size available for the estimation.

"As the purpose of temporal aggregation is to exploit important information about time series at different frequencies", [Nystrup et al. (2020)](#b44) propose other formulations in order to include potential information in the autocorrelation structure. The matrices considered in this paper[foot_4](#foot_4) are:

• auto-covariance scaling (t-acov):

$Ω = Ω t-acov • structural Markov (t-strar1): Ω = Ω t-strar1 • series Markov (t-sar1): Ω = Ω t-sar1 • hierarchy Markov (t-har1): Ω = Ω t-har1$The auto-covariance scaling makes use of the estimates of the full autocovariance matrices within each aggregation level, while ignoring correlations between aggregation levels:

$Ω t-acov =           Ω [m] 0 • • • 0 0 0 Ω [k p-1 ] • • • 0 0 . . . . . . . . . . . . . . . 0 0 • • • Ω [k 2 ] 0 0 0 • • • 0 Ω [1]           , where the (M k × M k ) matrices Ω [k]$are given by[foot_5](#foot_5) :

$Ω [k] = 1 N N τ =1 ê[k] τ (ê [k] τ ) = 1 N E [k] E [k] , k ∈ K ,(28)$where vector ê[k] τ and matrix E

[k]

x are given by ( [25](#formula_67)) and (26), respectively. A necessary condition in order to matrix Ω t-acov be invertible, is N > m, which is less demanding than what is needed for the non-singularity of matrix Ω .

Because it is sometimes difficult to estimate the covariance matrix within each aggregation level without assuming that it has some special form, [Nystrup et al. (2020)](#b44) propose "an estimator that blends autocorrelation and variance information, but only requires estimation of the first order autocorrelation coefficient at each aggregation level". They consider the Toeplitz matrix for the estimated first-order autocorrelation coefficients of the in-sample residuals for the p -1 levels k = k 1 , . . . , k p-1 , of the series' temporal hierarchy. Denoting these autocorrelation coefficents with ρ [k] , it is:

$Γ [m] = 1, Γ [k] =          1 ρ [k] • • • ρ M k -1 [k] ρ [k] 1 • • • ρ M k -2 [k] . . . . . . . . . . . . ρ M k -1 [k] ρ M k -2 [k] • • • 1          , k = k 1 , . . . , k p-1 ,$where each matrix Γ [k] , k ∈ K , has dimension (M k × M k ). The p matrices are used to build the [(k * + m) × (k * + m)] matrix:

$Γ =      1 0 • • • 0 0 Γ [k p-1 ] • • • 0 . . . . . . . . . . . . 0 0 • • • Γ [1]     $, which can be used in three alternative estimates of matrix Ω:

$Ω t-strar1 = Ω 1 2 t-struc ΓΩ 1 2 t-struc Ω t-sar1 = Ω 1 2 t-wlsv ΓΩ 1 2 t-wlsv Ω t-har1 = Ω 1 2 t-wlsh ΓΩ 1 2$t-wlsh 5. The cross-temporal forecast reconciliation framework

## Cross-temporal aggregation constraints

The cross sectional aggregation relationships (18), linking n series at a single time period, and the temporal aggregation relationships ( [22](#formula_59)), valid for an individual variable, can be simultaneously considered, by extending (i) the cross-sectional constraints to all observation frequencies, and (ii) the temporal aggregation relationships to all variables.

Considering contemporaneous and temporal dimensions in the same framework requires to extend and adapt the notations used so far. At this end, define the p matrices Y [k] , each of dimension (n × N M k ), as

$Y [k] = A [k] B [k] , k ∈ K ,$where

$B [k] =          b [k] 1 . . . b [k] i . . . b [k] n b          , A [k] =          a [k] 1 . . . a [k] j . . . a [k] na          , k ∈ K ,$are the matrices containing the k-order temporal aggregates of the bts (B [k] ) and uts (A [k] ), of dimension (n b × N M k ) and (n a × N M k ), respectively. In order to be consistent with the notation so far, Y [1] , B [1] , and A [1] denote the matrices containing data at the highest available sampling frequency, while Y, B, and A are used now to denote the matrices containing the data at any considered temporal frequency, that is:

$Y = A B = A [m] A [k p-1 ] • • • A [k 2 ] A [1] B [m] B [k p-1 ] • • • B [k 2 ] B [1] ,$where Y, A, and B have n, n a and n b rows, respectively, and the same number of columns,

$[N (k * + m)].$
## Cross-sectional aggregation constraints

The cross-sectional aggregation relationships operating along all the time observation indices can be worked out by extending the latter equation in expression (18):

$U Y [k] = 0 (na×N M k ) , k ∈ K ,$which can be expressed in compact form as

$U Y = 0 [na×N (k * +m)] .(29)$If we define y as the (nN (k * + m) × 1) vector containing all the observations of all series at any temporal aggregation level, organized 'by-variable-first-then-by-descendingaggregation-order', that is y = vec(Y ), the cross-sectional (contemporaneous) constraints ( [29](#formula_85)) can be equivalently expressed as:

$U ⊗ I N (k * +m) y = 0 [naN (k * +m)×1] .(30)$
## Temporal aggregation constraints

The temporal aggregation relationships ( [22](#formula_59)), valid for a single series, can be extended to each component of the n-variate time series y t as follows:

$   A [m] B [m] . . . . . . A [k 2 ] B [k 2 ]    = K N A [1] B [1] ,(31)$which can be equivalently written as

$[I N k * -K N ] Y = 0 (N k * ×n)$, that is:

$Z N Y = 0 (N k * ×n) .(32)$The temporal aggregation constraints (32) can thus be re-stated as:

$I n ⊗ Z N y = 0 (nN k * ×1) ,(33)$which, for n = 1, is equivalent to expression (23).

In summary, by considering expressions (30) and (33) together, the cross-temporal constraints working on the complete set of observations can be expressed as:

$H y = 0 (n * ×1) ,(34)$where n * = n a N (k * + m) + nN k * , and

$H = U ⊗ I N (k * +m) I n ⊗ Z N is a [n * × nN (k * + m)] cross-temporal zero-constraints kernel matrix.$Due to the simultaneous consideration of temporal and cross-sectional relationships linking the various time series of the system, some rows of H are redundant, and can be eliminated if one wishes a full row-rank zero-constraints kernel matrix. This issue is not new, since it has been encountered in the past when contemporaneous and temporal aggregation constraints are simultaneously considered for the reconciliation of a system of time series [(Di Fonzo, 1990, Di Fonzo and](#b12)[Marini, 2011)](#b14). In detail, matrix H consists in:

• N n a k * rows defining the cross-sectional (contemporaneous) aggregation constraints operating on the lf-uts;

• N n a m rows defining the cross-sectional (contemporaneous) aggregation constraints operating on the hf-bts;

• N n a (k * + m) rows defining the temporal aggregation constraints operating on both hf-and lf-uts;

• N n b (k * + m) rows defining the temporal aggregation constraints operating on both hf-and lf-bts.

Since the first set of N n a k * constraints is linearly dependent from the other rows of matrix H , a full row-rank cross-temporal zero constraints kernel matrix H can be obtained by: [(Magnus and Neudecker, 2019, p. 54](#); see Appendix A.3.1) P such that P [vec (Y)] = vec (Y );

$1. considering the [(N n(k * + m) × (N n(k * + m)] commutation matrix$2. defining a matrix U * as:

$U * = 0 (N nam×N nk * ) I N m ⊗ U P ; 3. considering the [N (n a m + nk * ) × N n(k * + m)] matrix: H = U * I n ⊗ Z N ,(35)$which has full row-rank equal to N (n a m + nk * ) = n * -N n a k * , and allows to re-state the complete cross-temporal constraints (34) as:

$H y = 0. (36$$)$
## Cross-temporal structural representation

The cross-temporal structural representation can be seen as a generalization from a single time index t to a single cycle index τ (i.e., the low-frequency time index) of the crosssectional structural representation (see section 3), extended to cover n(k * + m) nodes instead of n.

Denote with Y τ the [(n × (k * + m)] data matrix available at cycle τ :

$Y τ = A τ B τ =   A [m] τ A [k p-1 ] τ . . . A [k 2 ] τ A [1] τ B [m] τ B [k p-1 ] τ . . . B [k 2 ] τ B [1] τ   , τ = 1, . . . N,$and let Š be the (n * × n b m) cross-temporal summation matrix

$Š = Č I n b m ,$where Č denotes a (n * a × n b m) cross-temporal aggregation matrix mapping the hf-bts into the uts and lf-bts ones (n * a = n a (k * + m) + n b k * ). Denote with

$a * τ = vec A τ vec B * τ , τ = 1, . . . , N,$the (n * a × 1) vector of 'cross-temporal upper series', containing the uts and lf-bts data at the low-frequency time index τ , where

$B * τ = B [m] τ B [k p-1 ] τ . . . B [k 2 ] τ , τ = 1, . . . , N , and with b [1] τ = vec B [1] τ , τ = 1, . . . , N,$the (n b m × 1) vector of 'cross-temporal bottom series', containing the hf-bts data. The structural representation of a cross-temporal system of n time series takes the form

$yτ = Šb [1] τ , τ = 1, . . . , N,(37)$where yτ is a [n(k * + m) × 1] vector where we place all the uts and the lf-bts at the top, and all the hf-bts at the bottom:

$yτ = a * τ b [1] τ , τ = 1, . . . , N.(38)$
## Cross-temporal point forecast reconciliation: introduction

Let us assume to have unbiased base forecasts for all the individual time series of the multivariate hierarchical/grouped time series, and for all levels of the temporal hierarchies built from the highest available sampling frequency. In addition, assume that the forecast horizon for the most temporally aggregated time series be h = 1,[foot_6](#foot_6) and that the forecast horizons for the other temporally aggregated series cover the entire time cycle. This means that (i) the forecast horizon for the highest frequency time series is equal to m, and (ii) in general, the forecast horizon for a temporally aggregated time series of order k spans from 1 to M k . The base forecasts for each bottom time series of the system form the vectors b

$[k] i , i = 1, . . . , n b , k ∈ K , where b [1] i = b[1] il m l=1$is the (m × 1) vector containing the base forecasts for the i-th high-frequency bottom time series (hf-bts), which are the 'very' bottom time series in the cross-temporal framework, while the remaining b

[k] i 's (for k = 1) contain the M k forecasts for the lower-frequency ones (lf-bts).

The base forecasts for the upper time series can be defined likeways as

$a [k] j , j = 1, . . . , n a , k ∈ K ,$where a

$[1] j = a [1] jl m l=1$is the (m × 1) vector containing the base forecasts for the highfrequency j-th upper time series (hf-uts), and the a

[k] j 's (for k = 1) are (M k × 1) vectors of low-frequency upper time series (lf-uts) forecasts.

Let us collect these base forecasts in the (n b × M k ) and (n a × M k ), respectively, matrices

$B [k] =           b [k] 1 . . . b [k] i . . . b [k] n b           , A [k] =          a [k] 1 . . . a [k] j . . . a [k] na          , k ∈ K . (39$$)$The matrix containing the base bts forecasts is given by:

$B = B [m] B [k p-1 ] . . . B [k 2 ] B [1] ,$where

$B has dimension [n b × (k * + m)].$The base uts forecasts can be similarly arranged in the [n a × (k * + m)] matrix

$A = A [m] A [k p-1 ] . . . A [k 2 ] A [1]$.

From expression (39) we can define the p matrices Y

[k]

, each of dimension (n × M k ), with n = n a + n b , containing the base forecasts for the temporal aggregation level k of both uts and bts:

$Y [k] = A [k] B [k]$, k ∈ K .

Finally, denoting with Y the [n × (k * + m)] matrix containing the base forecasts of all series and for all temporal aggregation levels, it is:

$Y = Y [m] Y [k p-1 ] . . . Y [k 2 ] Y [1] = A B .$In general, the base forecasts fulfill neither cross-sectional (contemporaneous) nor temporal aggregation constraints. That is, respectively:

$U Y = 0 [na×(k * +m)] , Z 1 Y = 0 (k * ×n) .$The cross-temporal point forecast reconciliation problem can thus be stated as follows: we are looking for a reconciled point forecast matrix, say Y, which is 'as-close-as-possible' (according to a pre-specified metric) to the base forecast matrix Y, and simultaneously in line with the cross-sectional and temporal aggregation constraints, that is:

$U Y = 0 na×(k * +m) , Z 1 Y = 0 (k * ×n) .(40)$As we have previously shown, the relationships (40) can be expressed in vectorized form as H ỹ = 0, where ỹ = vec Y and, since h = 1, the full row-rank matrix H in ( [35](#formula_94)) becomes

$H = U * I n ⊗ Z 1 . (41$$)$
## Bottom-up cross-temporal forecast reconciliation

Cross temporal reconciled forecasts for all series at any temporal aggregation level can be easily computed by appropriate summation of the hf-bts base forecasts b

[1]

i , i = 1, . . . , n b , according to a bottom-up procedure like what is currently done in both the cross-sectional and temporal frameworks.

Denoting by Ÿ the [n × (k * + m)] matrix containing the bottom-up cross temporal reconciled forecasts, it is:

$Ÿ = Ä B = Ä[m] Ä[k p-1 ] . . . Ä[k 2 ] Ä[1] B[m] B[k p-1 ] . . . B[k 2 ] B[1] .$Since the hf-bts reconciled forecasts are by definition equal to the hf-bts base forecasts, i.e.

$B[1] = B [1]$, the bottom-up forecast reconciliation procedure consists of the following steps:

1. compute the hf-uts reconciled forecasts using the cross-sectional aggregation relationship (15):

$Ä[1] = C B [1] ;$2. compute the lf-bts reconciled forecasts according to the temporal aggregation relationship (31):

$     B[m] . . . B[k 2 ]      = K 1 B [1] ⇒ B[m] B[k p-1 ] . . . B[k 2 ] = B [1] K 1 ;$3. compute the lf-uts reconciled forecasts by cross-sectional aggregation of the lf-bts reconciled forecasts obtained in the previous step:

$Ä[k] = C B[k] , k ∈ K ⇒ Ä[m] Ä[k p-1 ] . . . Ä[k 2 ] = C B [1] K 1 .$In summary, the matrix containing the bottom-up reconciled forecasts, solely depending on the hf-bts base forecasts, is given by:

$Ÿ = C B [1] K 1 C B [1] B [1] K 1 B [1] .(42)$An equivalent, succint alternative to expression (42) consists in exploiting the crosstemporal structural representation (37):

$ÿ = Š b [1] ,(43)$where b

$[1] = vec B [1]$, keeping in mind that the elements in y and in y are differently organized, and in general it is ÿ = ÿ, with ÿ = vec Ÿ . This last issue can be easily dealt with by considering the (n * × n * ) permutation matrix such that y = Qy (see Appendix A.3.2): given the orthogonality of matrix Q, expression (43) can be re-stated as

$ÿ = Q Š b [1]$. However, the formulation of matrix Š, which requires to manage linear relationships across cross-sectional and temporal dimensions, may be tedious and prone to errors, mostly for large collections of time series. In such cases, it might be preferible using formulation (42), where B

[1]

, C and K 1 are involved in simple matrix products. Appendix A.5 describes all these features with reference to a 'toy example' of a very simple two-level hierarchy with two quarterly bottom time series.

## Cross-temporal optimal forecast combination

## Let us consider the multivariate regression model

$Y = Y + E,(44)$where the involved matrices have each dimension [n × (k * + m)] and contain, respectively, the base ( Y) and the target forecasts (Y), and the coherency errors (E) for the n component variables of the linearly constrained time series of interest. For each variable, k * + m base forecasts are available, pertaining to all aggregation levels of the temporal hierarchy for a complete cycle of high-frequency observation, m. Consider now two vectorized versions of model ( [44](#formula_126)), by transforming the matrices either in original form:

$vec Y = vec (Y) + vec (E) ⇔ Y = Y + ε,(45)$or in transposed form:

$vec Y = vec Y + vec E ⇔ ŷ = y + η. (46$$)$The target forecasts must fulfill the cross-sectional (contemporaneous) constraints

$U Y = 0 [na×(k * +m)]$and the temporal aggregation constraints

$Z 1 Y = 0 (k * ×n) ,$that is, in vectorized form:

$I k * +m ⊗ U Y = 0 [na(k * +m)×1] ⇔ U ⊗ I k * +m y = 0 [na(k * +m)×1] (47) Z 1 ⊗ I n Y = 0 (k * n×1) ⇔ I n ⊗ Z 1 y = 0 (k * n×1) (48) Denote with P the [n(k * + m) × n(k * + m)] commutation matrix such that Pvec (Y) = vec Y ⇔ PY = y Pvec Y = vec Y ⇔ P Y = ŷ Pvec (E) = vec E ⇔ Pε = η$As a consequence, using the full row-rank matrix H defined by expression (41), the constraints ( [47](#)) and ( [48](#)) can be re-stated as:

$H y = 0 ⇔ H PY = 0.$Let W = E [εε ] be the covariance matrix of vector ε, and Ω = E [ηη ] the covariance matrix of vector η. Clearly, W and Ω are different parameterizations of the same statistical object, i.e. the covariance matrix of the random disturbances in the multivariate regression model ( [44](#formula_126)), for which the following relationships hold:

$Ω = PWP , W = P ΩP.$In order to apply the general point forecast reconciliation formula (3) to a cross-temporal forecast reconciliation problem, we may consider either the expression

$ỹ = ŷ -ΩH H ΩH -1 H ŷ,$where ŷ = vec Y is the row vectorization of the base forecasts matrix Y, or equivalently re-state the expression above as:

$Y = Y -WP H H PWP H -1 H P Y ,$by considering the column vectorization as in (45).

6.1 Simple alternative approximations of the covariance matrix for cross-temporal point forecast reconciliation

Consider the column vectorized form of the multivariate regression (45), whose random disturbances can be written as:

$ε =                   ε [m] 1 ε [k p-1 ] 1 . . . ε [k p-1 ] m k p-1 . . . ε [1] 1 . . . ε [1] m                   , where each (n × 1) vector ε [k] l , k ∈ K , l = 1, .$. . , M k , contains contemporaneous random disturbances, i.e. at the same observation index of any temporal aggregation order.

A simple, though rather irrealistic, generalization to the cross-temporal framework of the cross-sectional approach (see section 3.1) consists in assuming that only the disturbances at the same time index of the same temporal aggregation level are correlated, whereas no temporal dependence (either within the same series at different times, or between the n series) is admitted:

$E ε [k i ] r ε [k j ] s = W [k] l if k i = k j = k, r = s = l 0 otherwise , k ∈ K , l = 1, . . . , M k .$In this case, the covariance matrix W has the following block-diagonal structure:

$W =                   W [m] 1 0 • • • 0 • • • 0 • • • 0 0 W [k p-1 ] 1 • • • 0 • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 0 • • • W [k p-1 ] m k p-1 • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • W [1] 1 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • 0 • • • W [1] m                   . (49$$)$Furthermore, if it is assumed that within each temporal aggregation level the random disturbances follow a multivariate white noise, which means that the contemporaneous covariance matrices are constant in time (i.e., W

$[k] l = W [k] , k ∈ K , l = 1, . . . , M k )$, the previous expression simplifies as follows:

$W =        W [m] 0 • • • 0 0 I m k p-1 ⊗ W [k p-1 ] • • • 0 . . . . . . . . . . . . 0 0 • • • I m ⊗ W [1]        . (50$$)$From a practical point of view, each (n×n) matrix W [k] , k ∈ K , may be approximated like in the cross-sectional forecast reconciliation case, possibly using the in-sample residuals (see section 3.1). Expressions ( [49](#formula_139)) and ( [50](#formula_142)) can thus be seen as two simple extensions to the cross-temporal case of the approach developed in the cross-sectional framework, where no temporal dependence is accounted for both within and between the n series.

We may similarly propose a simplified pattern of the disturbances covariance matrix of the multivariate regression model ( [44](#formula_126)), by considering the row vectorization form (46). In this case, the random disturbances vector η can be written as

$η = η 1 . . . η i . . . η n ,$where each [(k * + m) × 1] vector η i , i = 1, . . . , n, contains the random disturbances at different observation indices of the various temporal aggregation levels for the same series i. If we assume that the n series are uncorrelated at any observation index for any temporal aggregation level (i.e. neither contemporaneous nor temporal correlation is admitted between the series, which is rather irrealistic), denoting with

$Ω ii = E(η i η i ), i = 1, . . . , n, the [(k * + m) × (k * + m)$] covariance matrix of the coherency errors of the temporal hierarchies of series i, the complete matrix Ω can be written as follows:

$Ω =      Ω 11 0 • • • 0 0 Ω 22 • • • 0 . . . . . . . . . . . . 0 0 • • • Ω nn      ,(51)$where each matrix Ω ii , i = 1, . . . , n, may be approximated as in the temporal forecast reconciliation case, possibly using the in-sample residuals (see section 4.1). Thus expression (51) can be seen as a very simple (maybe too simple!) extension to the cross-temporal case of the approach developed in the temporal hierarchies framework, where no correlation is admitted between the random errors of the n series.

Clearly, the two covariance patterns ( [50](#formula_142)) and (51) (i) are placed at opposite ends of possible ways of dealing with cross-temporal variables, and (ii) should be considered as first practical devices to make the optimal combination forecast approach feasible for the cross-temporal framework as well. This subject is undoubtedly of far greater importance between the open issues still remaining in this field, and we plan to go deep on this subject in the near future.

Residual-based estimates of the covariance matrix W (and of its re-parameterized counterpart Ω) make use of the in-sample residuals of the models used to forecast the n time series considered at any temporal aggregation level. Denote by

$E [k] l , k ∈ K , l = 1, . . . , M k ,$the (n × N ) matrix containing the in-sample residuals for a single node of the crosstemporal hierarchy (i.e., the i-th row contains the residuals for the N sub-periods l of the model used to forecast the temporal aggregate of order k of series i). For each temporal

$aggregation level k ∈ K , the M k matrices E [k] l can be grouped into the (n × N M k ) matrix E [k] = E [k] 1 . . . E [k] l . . . E [k] M k , k ∈ K .$The (n(k * + m) × N ) matrix containing all the residuals at any time observation index and any temporal aggregation level, can in turn be written as:

$E =                    E [m] 1 E [k p-1 ] 1 . . . E [k p-1 ] m k p-1 . . . E [1] 1 . . . E [1] m                    = ê1 . . . êτ . . . êN ,$where each [n(k * + m) × 1] vector êτ , τ = 1, . . . , N , is given by:

$êτ =   ê [m] 1,τ . . . (ê [1] 1,τ ) k * +m • • • ê[m] n,τ . . . (ê [1] n,τ ) k * +m    .$The sample residual covariance matrix[foot_7](#foot_7) can be calculated according to both parameterization as:

$Ω sam = 1 N N τ =1 êτ (ê τ ) = 1 N E E , W sam = P Ω sam P.$However, in many practical situations matrix E has a number of rows -which is equal to the number of nodes in the cross-temporal hierarchy -much larger than the number of columns, which is equal to N = T m . Thus matrices Ω sam and W sam might not have good properties (in particular, they are not p.d. if N ≤ n(k * + m)), and simplified approximations must be looked for. Two feasible alternatives are given by either the diagonalization or the shrinkage of matrix W sam , that is, respectively:

$W wlsh = I n(k * +m) W sam , W shr = λ W wlsh + (1 -λ) W sam ,$where W wlsh is a diagonal matrix containing the estimates of the 'hierarchy variances' for each node of the cross-temporal hierarchy, W shr is the matrix obtained by shrinkage of W sam with target W wlsh , and λ is an estimate of the coefficient of shrinkage intensity λ, 0 ≤ λ ≤ 1. Both W sam and W shr refer to all the n(k * + m) hierarchy nodes simultaneously taken, but unlike the former matrix, the latter should not suffer for possible singularity problems.

The

$(n × n) matrices W [k] l , k ∈ K , l = 1, .$. . , M k , forming the blocks on the diagonal of matrix (49), can be estimated both in full and shrunk version using the in-sample residuals

$E [k] l : W [k] l,sam = 1 N E [k] l ( E [k] l ) , k ∈ K , l = 1, . . . , M k ,(52)$$W [k] l,shr = λk,l I n W [k] l,sam + (1 -λk,l ) W [k] l,sam , k ∈ K , l = 1, . . . , M k .$Similarly, full and shrunk estimates of matrices W [k] , k ∈ K , forming the blocks on the diagonal of matrix (50), may be computed as:

$W [k] sam = 1 N M k E [k] ( E [k] ) , k ∈ K ,(53)$$W [k] shr = λk I n W [k] sam + (1 -λk ) W [k] sam , k ∈ K . (54$$)$While expression (52) always requires N > n in order to have good properties, formula

$(53) makes it clear that -except W [m]$sam , which is calculated with the same N residuals for each series as

$W [k]$1,sam -the estimates are based on more data, and the necessary condition to have a p.d. matrix is N M k > n. However, in order to have all the p matrices W

$[k]$sam well defined, the more restrictive condition N > n should be met. Matrices ( [52](#formula_154)) -( [54](#formula_157)) can be used to approximate W as follows:

$W BD hsam =                    W [m] 1,sam 0 • • • 0 • • • 0 • • • 0 0 W [k p-1 ] 1,sam • • • 0 • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 0 • • • W [k p-1 ] m k p-1 ,sam • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • W [1] 1,sam • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • 0 • • • W [1] m,sam                    . W BD hshr =                    W [m] 1,shr 0 • • • 0 • • • 0 • • • 0 0 W [k p-1 ] 1,shr • • • 0 • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 0 • • • W [k p-1 ] m k p-1 ,shr • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • W [1] 1,shr • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • 0 • • • W [1] m,shr                    . W BD sam =        W [m] sam 0 . . . 0 0 I m k p-1 ⊗ W [k p-1 ] sam . . . 0 . . . . . . . . . . . . 0 0 . . . I m ⊗ W [1] sam        W BD shr =        W [m] shr 0 . . . 0 0 I m k p-1 ⊗ W [k p-1 ] shr . . . 0 . . . . . . . . . . . . 0 0 . . . I m ⊗ W [1] shr       $Most of the alternative choices for W (or Ω) shown so far are simple extensions to the cross-temporal framework of the approximations for W (or Ω) considered either in crosssectional or in temporal forecast reconciliation. For the time being, we are considering the following approximations ('oct' stands for 'optimal cross-temporal'):

• identity (oct-ols):

$W = Ω = I n(k * +m) • structural (oct-struc): W = W struc = P diag Q Š1 n b m P = diag P Q Š1 n b m$(see section 5.3, and appendix A.3.2)

• hierarchy variance scaling (oct-wlsh): W = W wlsh

• series variance scaling (oct-wlsv): W = W wlsv = P Ω wlsv P, where Ω wlsv is a straightforward extension of Ω t-wlsv (see section 4.1)

• block-diagonal shrunk cross-covariance scaling (oct-bdshr):

$W = W BD shr • block-diagonal cross-covariance scaling (oct-bdsam): W = W BD sam$• auto-covariance scaling (acov): W = W acov = P Ω acov P, where Ω acov is a straightforward extension of Ω t-acov (see section 4.1)

• MinT-shr (oct-shr):

$W = W shr • MinT-sam (oct-sam): W = W sam$7. An heuristic cross-temporal reconciliation procedure [Kourentzes and Athanasopoulos (2019)](#b34), henceforth KA, have proposed a cross-temporal reconciliation procedure that can be viewed as an ensemble forecasting procedure which exploits the simple averaging of different forecasts. The procedure consists in the following steps (it is assumed h = 1):

Step 1 For each individual variable, compute the temporally reconciled forecasts and collect them in the

$[n × (k * + m)] matrix Y: Y → Y.$This result can be obtained by applying the point forecast reconciliation formula (24) to each column of matrix Y , which can be written as:

$Y =   ta 1 • • • tan a tb 1 • • • tbn b â[1] 1 • • • â[1] na b[1] 1 • • • b[1] n b   .$The n a vectors of temporally reconciled forecasts of the uts can be obtained as:

$  ťa j ǎ[1] j   = M a j   ta j â[1] j   , M a j = I k * +m -Ω a j Z 1 Z 1 Ω a j Z 1 -1 Z 1 , j = 1, . . . , n a .$Likeways, the n b vectors of temporally reconciled forecasts of the bts are given by:

$  ťb i b[1] i   = M b i   tb i b[1] i   , M b i = I k * +m -Ω b i Z 1 Z 1 Ω b i Z 1 -1 Z 1 , i = 1, . . . , n b ,$where the n a +n b matrices M a j and

$M b i have dimension [(k * + m) × (k * + m)],$and Ω a j , j = 1, . . . , n a , and

$Ω b i , i = 1, . . . , n b , are known p.d. [(k * + m) × (k * + m)] matrices.$The mapping performing the transformation of the base forecasts into the temporally reconciled ones can be expressed in compact form as:

$vec Y =           M a 1 • • • 0 0 • • • 0 . . . . . . . . . . . . . . . . . . 0 • • • M an a 0 • • • 0 0 • • • 0 M b 1 • • • 0 . . . . . . . . . . . . . . . . . . 0 • • • 0 0 • • • M bn b           vec Y ,$and then matrix Y can be re-stated as:

$Y =   ťa 1 • • • ťan a ťb 1 • • • ťbn b ǎ[1] 1 • • • ǎ[1] na b[1] 1 • • • b[1] n b   =        ( A [m] ) ( B [m] ) . . . . . . ( A [k 2 ] ) ( B [k 2 ] ) ( A [1] ) ( B [1] )       $.

These reconciled forecasts are in line with the temporal aggregation constraints, i.e. Z 1 Y = 0 (k * ×n) , but in general they are not in line with the cross-sectional (contemporaneous) constraints, that is:

$U Y = 0 [na×(k * +m)] .$Step 2 Transform Y by computing time-by-time cross-sectional reconciled forecasts for all the temporal aggregation levels, and collect them in the

$[n × (k * + m)] matrix ( Y: Y → ( Y .$Matrix Y can be written as

$Y = Y [m] Y [k p-1 ] . . . Y [k 2 ] Y [1] ,$where

$Y [k] , k ∈ K , has dimension (n × M k ).$Thus, the cross-sectionally reconciled forecasts can be computed by transforming each Y [k]

as:

(

$Y [k] = M [k] Y [k] , k ∈ K ,$where M [k] denotes the (n × n) projection matrix used to reconcile forecasts of k-level temporally aggregated time series:

$M [k] = I n -W [k] U U W [k] U -1 U , k ∈ K ,$and

$W [k] is a (n × n) known p.d. matrix. Since it is U M [k] = 0 (na×n) , k ∈ K , the recon- ciled forecasts are cross-sectionally coherent, i.e. U ( Y = 0 [na×(k * +m)]$, but not temporally:

$Z 1 ( Y = 0 (k * ×n) .$Step 3 Transform again the step 1 forecasts Y, by computing time-by-time cross-sectional reconciled forecasts for all the temporal aggregation levels using the (n × n) matrix M, given by the average of the matrices M [k] obtained at step 2:

$Y → Y KA .$Matrix M can be expressed as:

$M = 1 p k∈K M [k] ,$and the final cross-temporal reconciled forecasts are given by:

$Y KA = M Y. (55$$) Since U M = 1 p k∈K U M [k] = 0 (na×n)$, and Z 1 Y = 0 (k * ×n) , the reconciled forecasts ( [55](#formula_184))

fulfill both cross-sectional and temporal aggregation constraints:

$U Y KA = U M ( Y = 0 [na×(k * +m)] , Z 1 Y KA = Z 1 ( Y M = 0 (k * ×n) .$
## Some remarks

To perform step 1, KA consider two alternatives as for the

$[(k * + m) × (k * + m)]$matrices Ω a j and Ω b i needed for computing the transformation matrices M a j and M b i , respectively. The former is t-struc, while the latter is t-wlsv (see section 4.1). As for step 2, KA use either cs-wls or cs-shr (see section 3.1).

## Remark 1

These two steps can be seen as the successive applications of two distinct multivariate reconciliation procedures, each characterized by different covariance matrix and constraints. For, in the first step it is solved a quadratic linear problem, where only temporal aggregation constraints are considered:

$y = arg min y (y -ŷ) Ω -1 (y -ŷ) , s.t. I n ⊗ Z 1 y = 0,$where Ω is the block-diagonal matrix in (51). The solution is given by:

$y = ŷ -Ω (I n ⊗ Z 1 ) I n ⊗ Z 1 Ω (I n ⊗ Z 1 ) -1 I n ⊗ Z 1 ŷ = Mŷ, where M = I -Ω (I n ⊗ Z 1 ) I n ⊗ Z 1 Ω (I n ⊗ Z 1 ) -1 I n ⊗ Z 1 is the [n(k * + m) × n(k * + m)] projection matrix M =      M 1 0 • • • 0 0 M 2 • • • 0 . . . . . . . . . . . . 0 0 • • • M n      , with M i = I k * +m -Ω ii Z 1 Z 1 Ω ii Z 1 -1 Z 1 , i = 1, . . . , n.$The second step consists in another quadratic minimization problem, where only crosssectional (contemporaneous) constraints are considered:

$( Y = arg min Y Y -Y W -1 Y -Y , s.t. I k * +m ⊗ U Y = 0,$where W is the block-diagonal matrix in (50), and whose solution is given by: (

$Y = Y -W (I k * +m ⊗ U) I k * +m ⊗ U W (I k * +m ⊗ U) -1 I k * +m ⊗ U Y = M Y$(56) where

$M = I -W (I k * +m ⊗ U) I k * +m ⊗ U W (I k * +m ⊗ U) -1 I k * +m ⊗ U is the [n(k * + m) × n(k * + m)] projection matrix M =                M [m] 0 • • • 0 • • • 0 • • • 0 0 M [k p-1 ] • • • 0 • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 0 • • • M [k p-1 ] • • • 0 • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • M [1] • • • 0 . . . . . . . . . . . . . . . . . . . . . . . . 0 • • • • • • 0 • • • 0 • • • M [1]                =        M [m] 0 • • • 0 0 I m k p-1 ⊗ M [k p-1 ] • • • 0 . . . . . . . . . . . . 0 0 • • • I m ⊗ M [1]        with M [k] = I n -W [k] U U W [k] U -1 U , k ∈ K .$It is worth noting that the reconciled forecasts (56) can be expressed according to the alternative vectorization, as: y = P Y .

## Remark 2

The cross-sectional reconciliation performed at step 2 of the KA procedure involves the transformations of k * + m vector of forecasts. More precisely, each transformation matrix

$M [k] , k ∈ K , is applied to M k different (n × 1) vectors.$Thus, a sensible alternative to the KA proposal might be considering the weighted average of the transformation matrices:

$M * = 1 k * + m k∈K M k M [k] .$
## Remark 3

In general the final result of the reconciliation procedure would change if the user invert the order of application of the two reconciliation steps. In Appendix A.6 the 'cross-sectionalfirst-then-temporal' reconciliation procedure is shown, along with the relevant M matrix, which in this case is obtained through an average of the projection matrices used for the reconciliation of the n series according to temporal hierarchies. Since the differences between the reconciled point forecasts according to these two approaches could be not negligible (see section 7.2), in our view this is a weakness of the procedure, and calls for a decision rule about the final reconciled forecasts to retain. A practical way of doing could be choosing the reconciled forecasts which are the 'closest' (according to a given metric) to the base forecasts between the two alternatives.

## Remark 4

The calculation of the average matrix M in the final step of the procedure, needed to recover the cross-temporal coherency across the point forecasts, requires the availability of the projection matrices used in the second step. This poses no problem when closed form reconciliation formulae can be used. Unfortunately, this is not the case when the user is interested in considering more general linear constraints (e.g., non-negativity of the final reconciled estimates), that should be treated with appropriate numerical procedures [(Kourentzes and](#)[Athanasopoulos, 2020a, Wickramasuriya et al., 2020)](#)[11](#foot_8) .

In the next subsection we extend the heuristic KA procedure in such a way that these issues can be overcome in a simple and effective manner.

## An iterative heuristic cross-temporal reconciliation procedure

Taking inspiration from the heuristic KA reconciliation procedure, we consider an iterative procedure which produces cross-temporally reconciled forecasts by alternating forecast reconciliation along one single dimension (either cross-sectional or temporal) at each iteration step.

Each iteration consists in the first two steps of the heuristic KA procedure, so the forecasts are reconciled by alternating cross-sectional (contemporaneous) reconciliation, and reconciliation through temporal hierarchies in a cyclic fashion.

Starting from the base forecasts Y, denote with d cs and d te , respectively, the crosssectional and temporal gross discrepancies, given by:

$d cs = U Y 1 d te = Z 1 Y 1 where X 1 = i,j |x i,j |.$Since the base forecasts are not in line with either type of constraints, in general both d cs and d te are greater than zero.

The iterative procedure can be described as follows:

1. Start the iterations by calculating the temporally reconciled forecasts Y

(1)

, such that

$Z 1 Y (1)$= 0, and d

(1)

$cs = U Y (1) 1 ≥ 0.$
## The point forecasts in matrix Y

(1)

are then cross-sectionally reconciled, obtaining

$Y (2)$, which is such that U Y

(2) = 0, and d

(1)

$te = Z 1 Y (2) 1 ≥ 0.$3. The updates in steps 1. and 2. are performed at each iteration j, j = 1, 2, . . ., until a convergence criterion is met, that is d

$(j)$te < δ, where δ is a positive tolerance value (e.g., δ = 10 -6 ), and matrix Y (2j) contains the final cross-temporal reconciled forecasts.

The above procedure can be seen as an extension of the well known iterative proportional fitting procedure [(Deming and](#b11)[Stephan, 1940, Johnston and](#)[Pattie, 1993)](#b30), also known as RAS method [(Miller and Blair, 2009)](#b43), to adjust the internal cell values of a two-dimensional matrix iteratively until they sum to some predetermined row and column totals. In that case the adjustment follows a proportional adjustment scheme, whereas in the cross-temporal reconciliation framework each adjustment step is made according to the penalty function associated to the single-dimension reconciliation procedure adopted.

Indeed, the choice of the dimension along with the first reconciliation step in each iteration is performed is up to the user, and there is no particular reason why one should perform the temporal reconciliation first, and the cross-sectional reconciliation then. Figure [4](#fig_19) shows the percentage discrepancies in the Australian GDP at current prices one-step-ahead forecasts for any temporal aggregation level (quarterly, semi-annual, annual, see section 8), when the cross-temporal reconciliation is performed according to either the KA approach, or to the analogous procedure where the cross-sectional constraints are considered first, and then the temporal dimension is accounted for. Percentage differences in the reconciled forecasts for this single, very important variable, are visually evident, though bounded within (-0.3% -+0.4%). quarter 1 9 9 5 1 9 9 9 2 0 0 3 2 0 0 7 2 0 1 1 2 0 1 5 2 0 1 7 -0.2% 0.0% 0.2% 0.4% semester 1 9 9 5 1 9 9 9 2 0 0 3 2 0 0 7 2 0 1 1 2 0 1 5 2 0 1 7 -0.1% 0.0% 0.1% 0.2% 0.3% year 1 9 9 5 1 9 9 9 2 0 0 3 2 0 0 7 2 0 1 1 2 0 1 5 2 0 1 7 ka tcs < ka cst ka tcs > ka cst GDP TS: ka tcs vs ka cst (wlsv-shr)

Figure [4](#fig_19): Quarterly, semi-annual and annual Australian GDP one-step-ahead reconciled forecasts according to the Kourentzes and Athanasopoulos (2019) cross-temporal reconciliation approach (t-wlsv for the temporal step, cs-shr for the cross-sectional step) by alternating the constraint dimensions to be fulfilled: percentage differences between the reconciled forecasts obtained through (i) temporal-then-cross-sectional reconciliation, and (ii) cross-sectional-then-temporal reconciliation. The differences between the two reconciled forecasts are divided by their arithmetic mean.

Figure [5](#fig_5) completes the results shown so far, by considering the forecasts of the strictly positive 79 (out of 95) variables from both Income and Expenditure sides, cross-temporally reconciled according to the KA procedure and its iterative variant. The boxplots show the distributions of the percentage discrepancies between the reconciled forecasts obtained using temporal reconciliation first, and cross-sectional reconciliation then, vis-à-vis the results obtained by inverting the order of application of the two reconciliation procedures. It clearly appears that the iterative variant of the original KA proposal produces less pro-

nounced discrepancies[foot_9](#foot_9) . -0.90% -0.60% -0.30% 0.00% 0.30% 0.60% 0.90% quarter semester year iter KA Boxplot wlsv-shr: KA vs iterative tralian GDP from Income and Expenditure sides using both the original KA cross-temporal reconciliation procedure (t-wlsv for the temporal step, and cs-shr for the cross-sectional one), and its iterative variant: boxplots of the percentage differences between the reconciled forecasts obtained through (i) temporal-then-cross-sectional reconciliation, and (ii) cross-sectionalthen-temporal reconciliation. The differences between each pair of reconciled forecasts are divided by their arithmetic mean.

It must also be said that the convergence speed of the iterative procedure does not seem to be affected by the choice of the first dimension to be fulfilled when the iteration starts. Figure [6](#fig_6) shows an example of the convergence speed of the iterative procedure either starting with the cross-sectional (bottom panel) or temporal (top panel) reconciliation procedure for the Australian GDP forecasts. In both cases, the convergence is achieved very quickly: fixing δ = 10 -6 , 15 (14) iterates are needed when starting from the temporal (cross-sectional) dimension. Furthermore, from the fourth iteration onwards the constraints are practically fulfilled in both cases. Nevertheless, since the final reconciled values depend on this choice, it would be useful having an ex-ante 'choice rule' between the two alternatives. We are currently working on this issue, however in the rest of the paper, when considering heuristic cross-temporal forecast reconciliation procedures, for ease of presentation we maintain the original choice made by KA, performing temporal forecast reconciliation first, and cross-sectional reconciliation then.

## Cross-temporal reconciliation of the Australian GDP forecasts from Income and

Expenditure sides

In a recent paper, [Athanasopoulos et al. (2019, p. 690)](#) propose "the application of state-ofthe-art forecast reconciliation methods to macroeconomic forecasting" in order to perform aligned decision making and to improve forecast accuracy. In their empirical study they consider the cross-sectional forecast reconciliation for 95 Australian Quarterly National q q q q q q q q q q q q q q q q q q 0 50000 100000 150000

$0 1.1 1.2 2.$1 2.2 3.1 3.2 4.1 4.2 5.1 5.2 6.1 6.2 7.1 7.2 8.1 8.2 iteration.step q Cross-sectional incoherence Temporal incoherence

temporal-then-cross-sectional reconciliation q q q q q q q q q q q q q q q q q q 0 50000 100000

150000 200000 0 1.1 1.2 2.1 2.2 3.1 3.2 4.1 4.2 5.1 5.2 6.1 6.2 7.1 7.2 8.1 8.2 iteration.step q Cross-sectional incoherence Temporal incoherence cross-sectional-then-temporal reconciliation Accounts time series, describing the Gross Domestic Product (GDP ) at current prices from Income and Expenditure sides, interpreted as two distinct hierarchical structures. In the former case (Income), GDP is on the top of 15 lower level aggregates (figure [7](#fig_7)), while in the latter (Expenditure), GDP is the top level aggregate of a hierarchy of 79 time series (see figures 21.5-21.7 in [Athanasopoulos et al., 2019, pp. 703-705)](#). By managing the complete set of 95 time series following the approach described in section 3, [Bisaglia et al. (2020)](#b6) have extended the results of [Athanasopoulos et al. (2019)](#b2), showing that fully reconciled forecasts of GDP , coherent with all the reconciled forecasts from both Expenditure and Income sides, can be obtained through the projection approach described in section 2. According to the notation adopted so far, the (33×95) kernel matrix accounting for the cross-sectional zero constraints is given by [(Bisaglia et al., 2020)](#b6):

$U =      1 0 (5×1) -1 (10×1) 0 (26×1) 0 (53×1) 1 0 (5×1) 0 (10×1) 0 (26×1) -1 (53×1) 0 (5×1) I 5 -C I 0 (5×26) 0 (5×53) 0 (26×1) 0 (26×5) 0 (26×10) I 26 -C E      .$In what follows, cross-temporal forecast reconciliation is applied within the same forecasting experiment designed by [Athanasopoulos et al. (2019)](#b2), extended in order to consider semi-annual and annual forecasts as well: for the available time series span (1984:Q4 -2018:Q1), quarterly base forecasts from 1 up to 4 quarters ahead have been obtained for the n = 95 separate time series through simple univariate ARIMA models selected using the auto.arima function of the R-package forecast [(Hyndman et al., 2020)](#). The forecasting experiment uses a recursive training sample with expanding window length, where the first training sample is set from 1984:Q4 to 1994:Q3 and the last ends on 2017:Q1, for 

## Performance measures for multiple comparisons

We evaluate the performance of multiple (say, J > 1) forecast reconciliation procedures through forecast accuracy indices calculated on the forecast error[foot_11](#foot_11)

$ê[k],h i,j,t = y [k] i,t+h - ŷ[k],h i,j,t , i = 1, . . . , 95, j = 0, . . . , J, t = 1, . . . , 91, k ∈ K , h = 1, . . . , h k ,$where y and ŷ are the observed and forecasted values, respectively, i denotes the series (i = 1, . . . , 32, for the uts, i = 33, . . . , 95, for the bts), j = 0 denotes the base forecasts, t is the forecast origin (t = 1 corresponds to 1994:Q3), K = {4, 2, 1}, and h 4 = 1, h 2 = 2, h 1 = 4, are the forecast horizons for annual, semi-annual, and quarterly time series, respectively. The accuracy is evaluated using the Average Relative Mean Square Error (AvgRelMSE, [Davydenko and Fildes, 2013;](#b10)[Kourentzes and](#)[Athanasopoulos, 2019, 2020b)](#), obtained by transforming the MSE index, given by the average across all 91 forecasts origins of the squared forecast errors:

$MSE [k],h i,j = 1 91 91 t=1 ê[k],h i,j,t 2 , i = 1, . . . , 95, j = 0, . . . , J, k ∈ K , h = 1, . . . , h k . (57$$)$The AvgRelMSE is the geometric mean across all 95 series of the MSE ratio[foot_12](#foot_12) of a forecast over a benchmark given by the base, incoherent ARIMA forecasts, across all evaluation samples, for a given horizon h:

$AvgRelMSE [k],h j = 95 i=1 rMSE [k],h i,j 1 95 , j = 0, . . . , J, k ∈ K , h = 1, . . . , h k ,(58)$where rMSE

$[k],h i,j is the relative MSE: rMSE [k],h i,j = MSE [k],h i,j MSE [k],h i,0 , i = 1, . . . , 95, j = 0, . . . , J, k ∈ K , h = 1, . . . , h k .$If a forecast outperforms the base forecasts, then the AvgRelMSE becomes smaller than one and vice-versa, and the percentage improvement in accuracy over the benchmark can be calculated as 1 -AvgRelMSE

[k],h j × 100. Expression (58), which refers to all 95 time series, can be re-stated for (i) groups of variables (e.g., bts and uts), (ii) multiple forecast horizons (e.g., h = 1 -4 for quarterly forecasts, k = 1; h = 1 -2 for semi-annual forecasts, k = 2), (iii) different temporal aggregation levels over the whole forecast horizon (e.g., accuracy indices for the whole temporal hierarchy of each series) [16](#foot_13) . In Appendix A.7 we show the expressions used to compute forecast accuracy indices in a rolling forecast experiment, like the one we are dealing with, for selected combinations of variables/time frequencies/forecast horizons.

In order to give a complete picture of the evaluation results, in the next subsection we show and discuss the MSE-based accuracy indices, at multiple timescales and forecast horizons, for a set of selected forecast reconciliation procedures. Appendix A.8 reports the indices based on MAE as well, and several tables and graphs of the accuracy indices (for both MSE and MAE) for all the forecast reconciliation procedures described in the previous sections, by keeping distinct one-dimension (either cross-sectional or temporal) forecast reconciliation procedures from cross-temporal heuristic and optimal combination procedures.

Furthermore, we use the non-parametric Friedman and post-hoc Nemenyi tests (see also [Koning et al., 2005, and](#b31)[Hibon et al., 2012)](#b21), as implemented in the R-package tsutils [(Kourentzes, 2019)](#), to establish if the differences in the forecasts produced by the considered procedures are significant. According to [Kourentzes and Athanasopoulos (2019, p. 402](#)) "the Friedman test first establishes whether at least one of the forecasts is significantly different from the rest. If this is the case, we use the Nemenyi test to identify groups of forecasts for which there is no evidence of statistically significant differences. The advantage of this testing approach is that it does not impose any distributional assumptions and does not require multiple pairwise testing between forecasts, which would distort the outcome of the tests".

## The considered forecast reconciliation procedures

The empirical application mainly aims to evaluate the performance of the most convincing new cross-temporal reconciliation procedures, which basically are those using residualbased approximations of the covariance matrix, as compared to the state-of-the-art point forecast reconciliation procedures. More precisely, we consider five selected procedures recently proposed in the hierarchical forecasting literature:

• cs-shr [(Wickramasuriya, et al. 2019](#b59)),

• t-wlsv [(Kourentzes et al., 2017)](#b32),

• t-acov [(Nystrup et al., 2020)](#b44),

• t-sar1 [(Nystrup et al., 2020)](#b44),

• kah-wlsv-shr [(Kourentzes and Athanasopoulos, 2019)](#b34), five (two-step and iterative) variants of the KA approach:

• tcs-acov-shr, i.e. two-step t-acov + cs-shr,

• tcs-sar1-shr, i.e. two-step t-sar1 + cs-shr,

• ite-wlsv-shr, i.e. iterative t-wlsv + cs-shr (see section 7.2),

• ite-acov-shr, i.e. iterative t-acov + cs-shr (see section 7.2),

• ite-sar1-shr, i.e. iterative t-sar1 + cs-shr (see section 7.2), and finally, three optimal combination forecast procedures:

• oct-wlsv, i.e. W = W wlsv (see section 6.1),

• oct-bdshr, i.e. W = W BD shr (see section 6.1),

• oct-acov, i.e. W = W acov (see section 6.1).

The first five procedures have proven well performing in the empirical applications where they have been used [(Athanasopoulos et al., 2017](#b3)[, 2019](#)[, Wickramasuriya et al., 2019](#b59)[, Bisaglia et al., 2020](#b6)[, Nystrup et al., 2020, among others)](#). Clearly, the one-dimension reconciliation procedures (cs-shr, t-wlsv, t-acov, and t-sar1) do not give fully coherent forecasts. Rather, as far as it is expected that they improve on the base forecasts, the best-practice one-dimension procedures should be viewed as stricter benchmarks for the cross-temporal forecast reconciliation procedures, which are requested to give accurate one-number-forecasts as well.

In summary, the forecasting experiment was designed to evaluate the capability of the cross-temporal forecast reconciliation procedures to improve the forecast accuracy as compared (i) to the base forecasts, and (ii) to the most performing one-dimension forecast reconciliation procedures. In addition, the experiment should help in assessing (iii) the performance of both KA-variants (two-step and iterative procedures) and optimal combination forecasts as compared to the original proposal by KA, and (iv) the feasibility and the accuracy of the optimal combination cross-temporal reconciliation procedures, which for the time being -even when they are computed using the in-sample residuals -are based on rather simple/unrealistic approximations of the covariance matrix (see section 6.1). As for this last point, we are interested in understading if there is any significant difference between the reconciled forecasts produced by the most performing heuristic and optimal combination forecast procedures.

## Main results

Table [1](#tab_5) presents the AvgRelMSE's obtained for the forecasting techniques (base + 13 reconciliation procedures) listed in the previuos sub-section. We provide results for all 95 component time series, and for the 32 upper-level and the 63 bottom-level time series separately. The results are shown by level of temporal aggregation and forecast horizon. At each column, the lowest error is highlighted in red boldface, while values greater than one, which mean that the reconciled forecasts are worse than the base ones, are highlighted in black boldface.

Most of the data in the table are represented in the top panel of Figure [8](#fig_8), containing the graphs of the AvgRelMSE's for the considered procedures, across all forecast horizons, by temporal aggregation level of the forecasted series. The ranks of these indices are reported in the bottom panel of the same figure, with colours in background chosen to highlight the procedures' performance, from best (green) to worst (red). In this figure the procedures have been put in the order given by the overall AvgRelMSE, which seems a good compromise to represent such a multiple comparison. Figure [9](#fig_9) shows the Multiple Comparison with the Best Nemenyi test, after that the Friedman test has shown that the forecasts given by the considered procedures are different both when all temporal aggregation levels and forecast horizons (top panel), and when only one-step-ahead quarterly forecasts (bottom panel), are considered. q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q 4 2 1 all cs shr t sar1 t wlsv t acov oct bdshr oct wlsv oct acov tcs sar1-shr kah wlsv-shr ite sar1-shr ite wlsv-shr tcs acov-shr ite acov-shr 0.7 0.8 0.9 1.0 0.85 0.90 0.95 1.00 0.94 0.96 0.98 1.00 0.90 0.95 1.00 Temporal aggregation level All levels q all bts uts AvgRelMSE 1 1 1 1 2 2 2 2 3 3 4 3 4 4 5 4 5 5 6 5 6 6 7 6 7 8 3 7 8 7 8 8 9 10 9 9 10 11 10 10 11 12 11 12 12 13 12 11 13 9 13 13 14 14 14 14 2 2 2 2 1 1 1 1 6 3 7 7 7 6 8 8 4 4 5 5 5 5 6 6 3 7 3 4 9 8 9 11 12 10 12 12 8 9 4 3 10 11 10 10 11 12 11 9 13 13 13 13 14 14 14 14 3 4 1 5 7 4 1 2 2 2 3 3 6 6 6 4 5 5 8 10 7 7 8 8 9 9 9 12 14 10 10 11 11 11 11 13 12 12 12 10 1 13 13 14 13 14 14 all 1 2 4 all 1 2 4 all 1 2 base cs shr t sar1 t wlsv t acov oct bdshr oct wlsv oct acov tcs sar1-shr kah wlsv-shr ite sar1-shr ite wlsv-shr tcs acov-shr ite acov-shr all bts uts q q q q q q q q q q q q q q ite-wlsv-shr 5.

19 ite-acov-shr 5.39 ite-sar1-shr 5.44 tcs-acov-shr 5.98 kah-wlsv-shr 6.01 tcs-sar1-shr 6.04 oct-acov 6.38 oct-wlsv 6.78 oct-bdshr 7.54 t-wlsv 8.23 t-acov 8.25 t-sar1 8.4 cs-shr 12.27 base 13.09 6 9 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-sar1-shr 5.92

ite-acov-shr 5.93 ite-wlsv-shr 5.94 cs-shr 5.98 tcs-acov-shr 6.51 tcs-sar1-shr 6.69 kah-wlsv-shr 6.79 oct-acov 6.86 oct-wlsv 7.4 base 8.81 oct-bdshr 9.06 t-acov 9.36 t-sar1 9.84 t-wlsv 9.92 6 8 10 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) The main results found on this dataset can be summarized as follows:

• as compared to both base forecasts and one-dimension reconciliation procedures, using cross-temporal hierarchies provides a clear decrease in the AvgRelMSE for the uts (likely the most important variables for the decision maker, e.g. GDP) at any temporal aggregation level and any forecast horizon;

• this accuracy improvement is less marked, though yet visually evident, for the bottom level series, as compared to the reconciled forecasts through temporal hierarchies alone, which however are cross-sectionally incoherent;

• each iterative procedure performs better than its two-step counterpart;

• within the cross-temporal procedures, the heuristic procedures provide better results than the optimal combination ones.

Looking at the performances of each procedure, it's worth noting that cs-shr scores first as for the quarterly forecasts of the uts, and almost always improves on the base forecasts' accuracy, regardless of series' group, temporal aggregation level and forecast horizon 17 . In addition, from the bottom panel of Figure [9](#fig_9) we observe that, when considered only on quarterly basis, the one-step-ahead forecasts for all series provided by cs-shr are (temporally incoherent and) not significantly different from those provided by the best procedure (which in this case is ite-acov-shr). However, since the temporal dimension is not accounted for by this reconciliation procedure, the relative performance worsens (i.e., the cross-temporal procedures improve on the base forecasts more than cs-shr) as the temporal aggregation level increases.

Overall, ite-acov-shr always scores best for all series and all forecast horizons, and second-best for the bts series and all forecast horizons, while tcs-acov-shr scores second and first, in turn. However, ite-acov-shr shows good results for the uts forecasts as well. In this case, the best performances are given by ite-sar1-shr and ite-wlsv-shr. Figure [9](#fig_9) shows that the differences in the forecasts produced by all the considered heuristic procedures are not statistically significant at any temporal aggregation level and forecast horizon 18 . Furthermore, two optimal combination procedures (oct-acov and oct-wlsv) produce reconciled forecasts not significantly different from the best procedure according to the Nemenyi test (see Figure [9](#fig_9)), while oct-bdshr is significantly (worse and) different from the best forecast reconciliation procedure.

Finally, in Table 2 the AvgRelMSE's for selected upper time series and reconciliation procedures are shown 19 . The series we analyze (see Figure [10](#fig_11)) come from the first three levels of both the Income and Expenditure sides hierarchies: • Gross Fixed Capital Formation (Expenditure side) 17 The only exception is an AvgRelMSE greater than 1 (1.0094) for the bts quarterly forecasts at horizon 4. 18 Figure [9](#fig_9) reports only the test results across all temporal aggregation levels and forecast horizons (top), and for k = 1 and h = 1 (bottom). The graphs of the Nemenyi test for each temporal aggregation level and each forecast horizon are provided in Appendix A.8. 19 The results for all 95 series, and AvgRelMAE as well, are available in Appendix A.8.  The ability of cs-shr to improve on short-term (1 or 2-quarter ahead) base forecasts clearly emerges, with the only exception of the forecasts of the Change in Inventories series, where most indices at quarterly level are greater than 1. However, this bad performance is shared by the other reconciliation procedures as well, and is likely due to the low quality of the base forecasts as compared to the other considered series (see Figure [10](#fig_11)).

To conclude, the general improvement registered on average (last column of Table [2](#tab_9)) by the cross-temporal reconciliation procedures may be considered a positive outcome, which combines an acceptable forecasting performance at quarterly level with a good performance at semi-annual and annual-levels, with the additional feature that the complete system of forecasts is internally and temporally coherent.

## Conclusions

The hierarchical framework is currently considered as an effective way to improve the accuracy of forecasts in many different fields of application. In this paper we give some contributions and extensions to a topic which has been widely studied in the last decade, by connecting it to the widespread literature on least-squares adjustment of preliminary data [(Stone et al., 1942](#b57)[, Byron, 1978)](#b7), with focus on a projection approach which de facto encompasses and extends the modelling framework by [Hyndman et al. (2011)](#b23) (see [Wickramasuriya et al., 2019, and](#b59)[Panagiotelis et al., 2020a)](#). However, we do agree with [Jeon et al. (2019, p. 368](#)) that a "shortcoming of many of the approaches above, including WLS with structural scaling, is that the weights (...) are a function of in-sample errors and are not directly determined with reference to an objective function ultimately used to asses forecast quality". This problem, yet present for cross-temporal hierarchies, is added to the dimensionality issues which generally characterize these structures, whose number of nodes is considerably larger than the relevant single-dimension hierarchies, and calls for alternative estimation strategies, based for example on cross validation, as proposed by [Jeon et al. (2019)](#b29), or -when enough data is available -on Machine Learning techniques [(Mancuso et al., 2020](#b42)[, Spiliotis et al., 2020)](#).

Nevertheless, cross-temporal point forecast reconciliation seems to be a promising theme, which is worth considering for future research. In particular, we developed an R package offering classical and new optimal and heuristic combination forecast reconciliation procedures (FoReco -Forecast Reconciliation, Di Fonzo and Girolimetto, 2020). In addition, we plan to perform simulation experiments to better understand behaviour, potentiality, and possible shortcomings of the proposed procedures. Other topics in our research agenda are:

• looking for more realistic (and hopefully effective) approximations of the covariance matrices for cross-temporal reconciliation, (i) by building on Jeon et al. ( [2019](#)), (ii) by deepening some ideas by [Kourentzes (2017](#b32)[Kourentzes ( , 2018))](#b33), and (iii) by extending/adapting some proposals by [Nystrup et al. (2020)](#b44) to the cross-temporal framework;

• extending the cross-temporal framework to the reconciliation of probabilistic forecasts [(Panagiotelis et al., 2020b](#b46)[, Jeon et al., 2019](#b29)[, Ben Taieb et al., 2020)](#b4), and for bayesian [(Eckert et al., 2020)](#) and fast [(Ashouri et al., 2019)](#b0) forecast reconciliation procedures;

• extending the cross-temporal optimal combination approach to the case of intermittent demand forecasts [(Petropoulos and Kourentzes, 2015)](#b47), with the related nonnegativity issues [(Kourentzes and](#)[Athanasopoulos, 2020a, Wickramasuriya et al., 2020)](#), and possible consideration of 'soft' constraints [(Danilov and Magnus, 2008)](#b9).

A.1 Alternative, equivalent formulations of the solution to the optimal point forecast reconciliation problem

## Given the model

$ŷ = Sβ + ε, E (ε) = 0, E εε = W,$the GLS estimator of vector β is given by

$β = S W -1 S -1 S W -1 ŷ$and then the vector containing all reconciled forecasts is given by

$ỹ = S β = S S W -1 S -1 S W -1 ŷ = SGŷ, (A.1)$where

$G = S W -1 S -1 S W -1 .$Now we show that solution (A.1) is equivalent to the one we obtain considering the following model and its subsequent formulation in terms of constrained quadratic minimization:

$ŷ = y + ε, E (ε) = 0, E εε = W, s.t. H y = 0,$where

$H = I na -C is a matrix of dimension [n a × (n a + n b )].$In this case the following constrained minimization problem must be solved:

$min y (y -ŷ) W -1 (y -ŷ) , s.t. H y = 0$Let's consider the lagrangean function

$L = (y -ŷ) W -1 (y -ŷ) + 2λ H y = y W -1 y -2ŷ W -1 y + 2λ H y,$where λ is a (n a × 1) vector of Lagrange multipliers. Differentiating L wrt y and λ and then equating to zero (first order conditions), we get the linear system

$2W -1 y + 2Hλ = 2W -1 ŷ H y = 0 that is: W -1 H H 0 y λ = W -1 ŷ 0 .$According to the lemma of inversion of a block-partitioned matrix [(Lou and Shiou, 2002)](#b40), it is:

$W -1 H H 0 -1 = W -WH (H WH) -1 H W WH (H WH) -1 (H WH) -1 H W -(H WH) -1$, and thus

$ỹ = I n -WH H WH -1 H ŷ.$Now, let us consider matrix J, defined as

$J = 0 n b ×na I n b , which has dimension [n b × n],$and is such that when applied to a (n × 1) vector, 'extracts' its last n b elements. In other words, by denoting β = Jỹ, it is:

$ỹ = S β = J -JWH H WH -1 H ŷ = Gŷ,$from which we can conclude that

$G = S W -1 S -1 S W -1 = J -JWH H WH -1 H .$In the former case, the expression requires the inversion of a (n × n) matrix, W, and of a (n b × n b ) matrix, S W -1 S . In the latter case the matrix to be inverted, (H WH) has dimension (n a × n a ).

## A.2 Balanced and unbalanced hierarchies

A simple three-level hierarchy is shown in the right panel of figure A.1, where variable C at the second level of the hierarchy has no 'children', and thus is considered as a bottom variable too, at level three of the hierarchy.  The left panel shows the 'balanced version' of the same hierarchy, where variable C is (duplicated and) present at both levels two and three.

The aggregation relationships linking the component series can be expressed as follows:

$y T ot = y AA + y AB + y BA + y BB + y C y A = y AA + y AB y B = y BA + y BB y C = y C$, where the last equality has merely the function of making the hierarchy balanced. The corresponding contemporaneous aggregation matrix C is given by:

$C =     1 1 1 1 1 1 1 0 0 0 0 0 1 1 0 0 0 0 0 1     .$The redundant relationship (y C = y C ) makes the last row of matrix C equal to the last row of the contemporaneous summing matrix S = C I 5 . This redundancy can be easily eliminated by considering the new contemporaneous aggregation matrix C, which in the case of an unbalanced hierarchy has clearly one row less than in the balanced version:

$C =   1 1 1 1 1 1 1 0 0 0 0 0 1 1 0   .$The new contemporaneous summing matrix is thus given by S = C I 5 , which has dimension (8 × 5) instead of (9 × 5) as for matrix S. In a complex hierarchy, mostly when contemporaneous and temporal hierarchies are simultaneously considered, this fact should be carefully considered in order to save memory space and computing time.

The R package hts [(Hyndman et al., 2020)](#) manages only balanced hierarchy, and thus builds matrix S instead of S. Due to this fact, large cross-sectional hierarchies might require computational efforts larger than necessary, and could face numerical problems when more sofisticated reconciliation strategies are applied. For example, the grouped time series of the Australian Tourism Demand (Visitor Nights) analyzed by [Wickramasuriya et al. (2019)](#b59) (see also [Ashouri et al., 2019;](#b0)[Bertani et al., 2020;](#b5)[Wickramasuriya et al., 2020)](#b60), contains 30 duplicated time series, since it comes from two unbalanced hierarchies with only 525 'unique' time series (304 bts and 221 uts), as compared to the 555 time series of the balanced version. Similar, though less pronounced cases found in literature are (i) the reduced version (an unbalanced geographical hierarchy of 105 'unique' time series out of 111) of the Australian Visitor Nights dataset analyzed by [Kourentzes and Athanasopoulos (2019)](#b34), and (ii) the Australian Tourism Demand (Overnight Trips) dataset considered by [Panagiotelis et al. (2020a)](#), which consists of 104 'unique' time series out of 110 for the balanced hierarchy.

## A.3 Commutation matrix and the relationships linking vectors and matrices of bottom and upper time series

Given an (r × c) matrix X, denote with C r,c the (rc × rc) commutation matrix [(Magnus and Neudecker, 2019)](#b41) which maps vec (X) into vec (X ):

$C r,c vec (X) = vec X .$This matrix is a special type of permutation matrix, obtained by simple exchanges of rows of the identity matrix, and is therefore orthogonal, that is: As for the index l, l = 1, . . . , n a T , of the generic element of vector a * , we have: vec(A ) = a * = {a * l } , a * l = a tj , with l = t + (j -1)T.

$C -1 r,c = C r,c = C c,$
## A numerical example

Assuming that n = 2 variables and T = 3 time periods are considered, matrix X = 11 12 13 21 22 23 can be vectorized either as vec(X) = x = 11 21 12 22 13 23 or vec(X ) = x * = 11 12 13 21 22 23 .

In this case, the permutation matrix P mapping x * into x, such that x = Px * (and x * = P x), is given by:

$P =        $1 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 1

$       $.

The following R script performs the calculation of matrix P: n <-2; t <-3; I <-matrix(1:(n * t), n, t, byrow = T) I <-as.vector(I) # vectorize the required indices P <-diag(n * t); # Initialize an identity matrix P <-P[I,] # Re-arrange the rows of the identity matrix # A numerical example X <-matrix [(c(11,12,13,21,22,23)](#), byrow=T, nrow=2) # (2 x 3) matrix Xt <-t(X)

x <-as.vector(X) # x = vec(X) xstar <-as.vector(Xt) # xstar = vec(X') xnew <-P% * %xstar # vector xstar is mapped into vector xnew norm(x -xnew)

# check: the norm of the difference should be zero xstarnew <-t(P) * x; # vector x is mapped into vector xstarnew norm(xstar -xstarnew) # check: the norm of the difference should be zero 

$B = B [m] B [k p-1 ] . . . B [k 2 ] B [1] = B * B [1] ,$where the

$(n b × k * ) matrix B * = B [m] B [k p-1 ] . . . B [k 2 ]$, and matrix B [1] contain the target forecasts for, respectively, the temporally aggregated time series (lf-bts) and the highfrequency ones (hf-bts). The following relationships hold:

$C n b ,(k * +m) [vec (B)] = vec B , C n b ,k * [vec (B * )] = vec (B * ) , C n b ,m vec B [1] = vec (B [1] ) . Since vec (B) =   vec (B * ) vec B [1]$  , we can write:

$C n b ,(k * +m) vec (B) = C n b ,(k * +m) C k * ,n b 0 (n b k * ×n b m) 0 (n b m×n b k * ) C m,n b   vec [(B * ) ] vec (B [1] )   ,$that is:

$vec B = Q   vec [(B * ) ] vec (B [1] )   ,$where

$Q = C n b ,(k * +m) C k * ,n b 0 (n b k * ×n b m) 0 (n b m×n b k * ) C m,n b . (A.2)$According to expression (38), the [n(k * + m) × 1] vector y can be written as:

$y =      vec(A ) vec [(B * ) ] vec (B [1] )      .$Then, vec (Y ) can be expressed in terms of y as:

$vec Y = Qy,$where

$Q = I na(k * +m) 0 [na(k * +m)×n b m] 0 [n b m×na(k * +m)] Q . A.$
## Monthly and hourly temporal hierarchies

For monthly data, the aggregates of interest are for k ∈ {12, 6, 4, 3, 2, 1}. Hence the monthly observations are aggregated to annual, semi-annual, four-monthly, quarterly and bi-monthly observations. These can be represented in two separate hierarchies, as shown in Fig. [A](#).2, which means that the temporal hierarchies form a grouped series, sharing the 'top level' (annual) aggregate, and the same twelve 'bottom' nodes, one for each month of the original temporally disaggregated time series. However, the (16 × 12) temporal aggregation matrix K 1 for this case is easily obtained:

$M 1 M 2 M 3 M 4 M 5 M 6 M 7 M 8 M 9 M 10 M 11 M 12 Q 1 Q 2 Q 3 Q 4 S 1 S 2 A (a) Monthly -Quarterly -Semi-Annual -Annual frequencies M 1 M 2 M 3 M 4 M 5 M 6 M 7 M 8 M 9 M 10 M 11 M 12 BM 1 BM 2 BM 3 BM 4 BM 5 BM 6 F M 1 F M 2 F M 3 A (b) Monthly -Bi-Monthly -Four-Monthly -Annual frequencies$$K 1 =                             $1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1

$                            $,

$and thus R 1 = K 1 I 12 , Z 1 = [I 16 -K 1 ], x τ = R 1 x [1]$τ , and Z 1 x τ = 0, τ = 1, . . . , N , where

$x τ = x [12] τ , x [6] τ , x [4] τ , x [3] τ , x [2] τ , x [1] τ$is the (28×1) vector containing all temporal aggregates of variable X at the observation index τ (i.e., within the complete τ -th cycle).

Let's conclude with considering the case of an hourly time series with diurnal period-icity. In this case it is m = 24, k * = 36, and K N is the (36N × 24N ) matrix

$K N =           I N ⊗ 1 24 I 2N ⊗ 1 12 I 3N ⊗ 1 8 I 4N ⊗ 1 6 I 6N ⊗ 1 4 I 8N ⊗ 1 3 I 12N ⊗ 1 2          $, which converts single hour values into the sum of 2, 3, 4, 6, 8, 12, and 24 hours data, respectively, and

$Z N = [I 36N -K N ] is a full row-rank (36N × 60N ) matrix.$A.5 Cross-temporal hierarchy: a toy example

Let us consider the relationships linking all the variables implied by a cross-temporal hierarchy for the very simple case of a total quarterly series observed for one year, X, obtained as the sum of two component variables, W and Z, respectively. The contemporaneous (cross-sectional) constraint, X = W + Z, must hold at any observation index of all temporal frequencies considered in the temporal hierarchy of Figure [3](#) (annual, semi-annual and quarterly), as shown in Figure A.3, which gives a graphical view of the the way in which the two dimensions (cross-sectional and temporal) are combined within a complete time cycle (one year). All the nodes in the cross-temporal hierarchy can be expressed in terms of the quarterly bottom time series w  t , t = 1, . . . , 4, according to the structural representation:

$                                                      x [4] 1 x [2] 1 x [2] 2 x [1] 1 x [1] 2 x [1] 3 x [1] 4 w [4] 1 w [2] 1 w [2] 2 z [4] 1 z [2] 1 z [2] 2 w [1] 1 w [1] 2 w [1] 3 w [1] 4 z [1] 1 z [1] 2 z [1] 3 z [1] 4                                                       y =                        $1 1 1 1 1 1 1 1 1 1 0 0 1 1 0 0 0 0 1 1 0 0 1 1 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 1 1 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1

$I8                         Š                   w [1] 1 w [1] 2 w [1] 3 w [1] 4 z [1] 1 z [1] 2 z [1] 3 z [1] 4                   b , w [1] 1 w [1] 2 w [1] 3 w [1] 4 w [2] 1 w [2] 2 w [4] 1 W z [1] 1 z [1] 2 z [1] 3 z [1] 4 z [2] 1 z [2] 2 z [4] 1 Z x [1] 1 x [1] 2 x [1] 3 x [1] 4 x [2] 1 x [2] 2 x [4] 1 X Figure A.3: A two level cross-temporal hierarchy with quarterly data where a = x [4] 1 x [2] 1 x [2] 2 x [1] 1 x [1] 2 x [1] 3 x [1] 4 , b = w [1] 1 w [1] 2 w [1] 3 w [1] 4 z [1] 1 z [1] 2 z [1] 3 z [1] 4 , y = a b , Š = Č I 8$, and Č is the (13 × 8) matrix:

$Č =                       $1 1 1 1 1 1 1 1 1 1 0 0 1 1 0 0 0 0 1 1 0 0 1 1 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 0 1 0 0 0 1 1 1 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1 1 1 0 0 0 0 1 1 0 0 0 0 0 0 0 0 1 1

$                      $.

The zero constraints valid for the nodes of the cross-temporal hierarchy can be represented through the (13 × 21) matrix Ȟ = I 13 -Č , which has full row-rank, and is such that:

$Ȟ y = 0 (13×1) . (A.3)$According to the notation used so far, it is n a = 1, n b = 2, T = m = 4, N = 1, p = 3, and K = {4, 2, 1}. The contemporaneous aggregation matrix C, mapping bts into uts, is simply a (1 × 2) row vector of ones: C = [1 1], and thus U is the

$(1 × 3) row vector U = [1 -1 -1].$Furthermore, the (3 × 4) temporal aggregation matrix K 1 mapping a quarterly series into its semi-annual and annual counterparts, and the related (3 × 7) matrix Z 1 = [I 3 -K 1 ], are given by:

$K 1 =   1 1 1 1 1 1 0 0 0 0 1 1   , Z 1 =   1 0 0 -1 -1 -1 -1 0 1 0 -1 -1 0 0 0 0 1 0 0 -1 -1   .$The (3 × 7) matrix Y, collecting all the time series at any observation frequency, is given by:

$Y =      x [4] 1 x [2] 1 x [2] 2 x [1] 1 x [1] 2 x [1] 3 x [1] 4 w [4] 1 w [2] 1 w [2] 2 w [1] 1 w [1] 2 w [1] 3 w [1] 4 z [4] 1 z [2] 1 z [2] 2 z [1] 1 z [1] 2 z [1] 3 z [1] 4     $, and then y = vec (Y ) is the (21 × 1) vector

$y = x [4] 1 x [2] 1 x [2] 2 x [1] 1 x [1] 2 x [1] 3 x [1] 4 w [4] 1 w [2] 1 w [2] 2 w [1] 1 w [1] 2 w [1] 3 w [1] 4 z [4] 1 z [2] 1 z [2] 2 z [1] 1 z [1] 2 z [1] 3 z [1] 4$, which is differently organized as compared to y. However, it is easy to show that y = Qy, where Q is the (21 × 21) permutation matrix

$Q =              $I 10 0 (10×11) 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0

$0 (4×17) I 4              $.

Given the orthogonality of matrix Q, it is y = Q y, and then the constraints (A.3) can be re-stated as Ȟ Q y = 0 (13×1) , that is

$H y = 0 (13×1) ,$where H = Q Ȟ is a (13 × 21) full row-rank matrix.

The cross-temporal constraints can be formulated according to expression (34) as well, where H is the (16 × 21) matrix

$H = U ⊗ I 7 I 3 ⊗ Z 1 =     I 7 -I 7 -I 7 Z 1 0 0 1 0 Z 1 0 1 0 0 Z 1     .$The rank of H is 13, which means that the matrix is not full row-rank. The choice of the rows to remove is not unique 1 , and in real life applications the elimination of linear dependent relationships from the cross-temporal constraint set might be not as simple as in this toy example. In general, the computation of H as in (35) seems rather quick and effective. In this toy example, the resulting H matrix according to that procedure is simply matrix H without the first three rows, that is:

$H =     I * -I * -I * Z 1 0 0 0 Z 1 0 0 0 Z 1     ,$where I * is the (4 × 7) matrix

$I * =    $0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1     .

## A.6 An alternative heuristic cross-temporal reconciliation procedure

Let us consider a cross-temporal reconciliation procedure based on the reversal of the order in which the one-dimension forecast reconciliation procedures are applied by KA. The procedure consists in the following steps (it is assumed h = 1):

Step 1 Transform Y by computing time-by-time cross-sectional reconciled forecasts ( Y for all the temporal aggregation levels:

Y → ( Y .

The [n × (k * + m)] matrix Y can be re-written also as:

$Y = Y [m] Y [k p-1 ] . . . Y [k 2 ] Y [1] ,$where Y

[k]

, k ∈ K , has dimension (n × M k ). Cross-sectionally reconciled forecasts can be computed by transforming each Y

[k]

as:

(

$Y [k] = M [k] Y [k] , k ∈ K ,$where M [k] are p transformation matrices, each of dimension (n × n), given by:

$M [k] = I n -W [k] U U W [k] U -1 U , k ∈ K , and W [k] is a (n × n) p.d. known matrix. Since it is U M [k] = 0 (na×n) , k ∈ K , the recon- ciled forecasts are cross-sectionally coherent, i.e. U ( Y = 0 [na×(k * +m)]$, but not temporally:

$Z 1 ( Y = 0 (k * ×n) .$Step 2 For each individual variable, compute the temporally reconciled forecasts Y:

$( Y → Y.$This result can be obtained by applying the point forecast reconciliation formula according to temporally hierarchies (24) to each column of matrix ( Y . In fact, using the notation of section 4, it is

$( Y =   ta 1 • • • tan a tb 1 • • • tbn b ȃ[1] 1 • • • ȃ[1] na b[1] 1 • • • b[1] n b   .$The n a vectors of temporally reconciled forecasts of the uts can be obtained as:

$  ťa j ǎ[1] j   = M a j   ta j ȃ[1] j   , M a j = I k * +m -Ω a j Z 1 Z 1 Ω a j Z 1 -1 Z 1 , j = 1, . . . , n a .$Likeways, the n b vectors of temporally reconciled forecasts of the bts are given by:

$  ťb i b[1] i   = M b i   tb i b[1] i   , M b i = I k * +m -Ω b i Z 1 Z 1 Ω b i Z 1 -1 Z 1 , i = 1, . . . , n b ,$where the n a +n b matrices M a j and

$M b i have dimension [(k * + m) × (k * + m)],$and each Ω a j , j = 1, . . . , n a , and

$Ω b i , i = 1, . . . , n b , respectively, is a known p.d. [(k * + m) × (k * + m)] matrix.$The mapping performing the transformation of the base forecasts into the temporally reconciled ones can be expressed in compact form as:

$vec Y =           M a 1 • • • 0 0 • • • 0 . . . . . . . . . . . . . . . . . . 0 • • • M an a 0 • • • 0 0 • • • 0 M b 1 • • • 0 . . . . . . . . . . . . . . . . . . 0 • • • 0 0 • • • M bn b           vec ( Y .$The temporally reconciled forecasts can be then collected in the matrix Y :

$Y =   ťa 1 • • • ťan a ťb 1 • • • ťbn b ǎ[1] 1 • • • ǎ[1] na b[1] 1 • • • b[1] n b   =        ( A [m] ) ( B [m] ) . . . . . . ( A [k 2 ] ) ( B [k 2 ] ) ( A [1] ) ( B [1] )       $, which is in line with the temporal aggregation constraints, i.e. Z 1 Y = 0 (k * ×n) , but in general it is not in line with the cross-sectional (contemporaneous) constraints: U Y = 0 na×(k * +m) .

Step 3 Transform again the step 1 forecasts ( Y, by computing temporally reconciled forecasts for all n variables using the

$[(k * + m) × (k * + m)] matrix M$cst , where 'cst' stands for 'crosssectional-then-temporal', given by the average of the matrices M i obtained at step 2:

$( Y ⇒ Y cst .$Matrix M cst can be expressed as:

$M cst = 1 n n i=1 M i .$The final cross-temporal reconciled forecasts are given by:

$Y cst = M cst ( Y = ( Y(M cst ) . (A.4) Since U ( Y = 0 [na×(k * +m)] ,$and

$Z 1 M cst = n -1 n i=1 Z 1 M i = 0 [k * ×(k * +m)]$, the reconciled forecasts (A.4) fulfill both cross-sectional and temporal aggregation constraints:

$U Y cst = U ( Y(M cst ) = 0 [na×(k * +m)] , Z 1 Y cst = Z 1 M cst ( Y = 0 (k * ×n) .$A.7 Average relative accuracy indices for selected groups of variables/time frequencies/forecast horizons, in a rolling forecast experiment

Let

$ê[k],h i,j,t = y [k] i,t+h - ŷ[k],h i,j,t , i = 1, . . . , n, j = 0, . . . , J, t = 1, . . . , q, k ∈ K , h = 1, . . . , h k ,$be the forecast error, where y and ŷ are the actual and the forecasted values, respectively, suffix i denotes the variable of interest, j is the forecasting technique, where j = 0 is the benchmark forecasting procedure, t is the forecast origin, K is the set of the time frequencies at which the series is observed, and h is the forecast horizon, whose lead time depends on the time frequency k.

## Denote by A

[k],h i,j the forecasting accuracy of the technique j, computed across q forecast origins, for the h-step-ahead forecasts of the variable i at the temporal aggregation level k. For example, A

$[k],h i,j = M SE [k],h$i,j , as defined in expression ( [57](#formula_204)), otherwise we might have A

$[k],h i,j = M AE [k],h i,j or A [k],h i,j = RM SE [k],h i,j , where M AE [k],h i,j = 1 q q t=1 ê[k],h i,j RM SE [k],h i,j = 1 q q t=1 ê[k],h i,j2$In any case, we consider the relative version of the accuracy index A

[k],h i,j , given by:

$r [k],h i,j = A [k],h i,j A [k],h i,0 , i = 1, . . . , n, j = 0, . . . , J, k ∈ K , h = 1, . . . , h k ,$and use it to compute the Average relative accuracy index of the forecasting procedure j, for given k and h, through the geometric mean:

$AvgRelA [k],h j = n i=1 r [k],h i,j 1 n$, j = 0, . . . , J.

We may consider the following average relative accuracy indices for selected groups of variables/time frequencies and forecast horizons:

Average relative accuracy indices for a single variable at a given time frequency, for multiple forecast horizons

$AvgRelA [k],q 1 :q 2 i,j =   q 2 h=q 1 r [k],h i,j   1 q 2 -q 1 +1 , i = 1, . . . , n, j = 0, . . . , J, k ∈ K , 1 ≤ q 1 ≤ q 2 ≤ h k .$Average relative accuracy indices for a group of variables (either all, or selected groups, e.g. a: uts, b: bts) at a given time frequency, either for a single forecast horizon or across them

$AvgRelA [k],h j = n i=1 r [k],h i,j 1 n , j = 0, . . . , J, k ∈ K , h = 1, . . . , h k AvgRelA [k],h a,j = na i=1 r [k],h i,j 1 na , j = 0, . . . , J, k ∈ K AvgRelA [k],h b,j = n i=na+1 r [k],h i,j 1 n b , j = 0, . . . , J, k ∈ K AvgRelA [k] j = n i=1 h k h=1 r [k],h i,j 1 nh k , j = 0, . . . , J, k ∈ K AvgRelA [k] a,j = na i=1 h k h=1 r [k],h i,j 1 nah k , j = 0, . . . , J, k ∈ K AvgRelA [k] b,j = n i=na+1 h k h=1 r [k],h i,j 1 n b h k , j = 0, . . . , J, k ∈ K$Average relative accuracy indices for a single variable or for a group of variables (all, a: uts, b: bts), across all time frequencies and forecast horizons

$AvgRelA i,j = k∈K h k h=1 r [k],h i,j 1 k * +m , i = 1, . . . , n j = 0, . . . , J AvgRelA j = n i=1 k∈K h k h=1 r [k],h i,j 1 n(k * +m) , j = 0, . . . , J AvgRelA a,j = na i=1 k∈K h k h=1 r [k],h i,j 1 na(k * +m) , j = 0, . . . , J AvgRelA b,j = n i=na+1 k∈K h k h=1 r [k],h i,j 1 n b (k * +m)$, j = 0, . . . , J A.8 Forecast reconciliation experiment: supplementary tables and graphs A.8.1 Selected forecast reconciliation procedures: performance results using AvgRel-MAE

Table A.1: AvgRelMAE at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All Procedure 1 2 3 4 1-4 1 2 1-2 1 all 95 series base 1 1 1 1 1 1 1 1 1 1 cs-shr 0.9769 0.9842 0.9863 0.9893 0.9842 0.9733 0.9871 0.9802 0.9840 0.9830 t-wlsv 0.9997 0.9988 0.9967 0.9953 0.9976 0.9212 0.9617 0.9412 0.8714 0.9624 t-acov 0.9893 0.9951 1.002 0.9971 0.9959 0.9106 0.9632 0.9365 0.8697 0.9598 t-sar1 0.9997 0.999 0.9964 0.9953 0.9976 0.9213 0.9615 0.9412 0.8712 0.9624 kah-wlsv-shr 0.9796 0.9829 0.9797 0.9790 0.9803 0.9046 0.9459 0.9250 0.8572 0.9459 tcs-acov-shr 0.9698 0.9764 0.9852 0.9805 0.9780 0.8936 0.9476 0.9202 0.8555 0.9429 tcs-sar1-shr 0.9797 0.9830 0.9796 0.9790 0.9803 0.9048 0.9459 0.9251 0.8572 0.9459 ite-wlsv-shr 0.9750 0.9815 0.9783 0.9784 0.9783 0.9035 0.9459 0.9245 0.8562 0.9444 ite-acov-shr 0.9672 0.9770 0.9849 0.9812 0.9776 0.8936 0.9481 0.9205 0.8547 0.9426 ite-sar1-shr 0.9751 0.9819 0.9781 0.9784 0.9784 0.9038 0.9459 0.9246 0.8563 0.9445 oct-wlsv 0.9813 0.9858 0.9829 0.9830 0.9832 0.9078 0.9506 0.9289 0.8620 0.9494 oct-bdshr 0.9858 0.9880 0.9809 0.9833 0.9845 0.9112 0.9499 0.9304 0.8620 0.9505 oct-acov 0.9762 0.9831 0.9904 0.9879 0.9844 0.8965 0.9541 0.9248 0.8600 0.9485 32 upper series base 1 1 1 1 1 1 1 1 1 1 cs-shr 0.9484 0.9628 0.9595 0.9652 0.959 0.9521 0.9679 0.9600 0.9691 0.9607 t-wlsv 0.9947 1.0034 0.9994 1.0006 0.9995 0.9273 0.9628 0.9448 0.8689 0.9641 t-acov 0.9965 1.0061 1.0019 1.0011 1.0014 0.9270 0.9627 0.9447 0.8688 0.9651 t-sar1 0.9947 1.0034 0.9993 1.0005 0.9995 0.9275 0.9626 0.9449 0.8686 0.9640 kah-wlsv-shr 0.9538 0.9713 0.9646 0.9685 0.9645 0.8912 0.9265 0.9087 0.8319 0.9284 tcs-acov-shr 0.9595 0.9679 0.9655 0.9700 0.9657 0.8895 0.9269 0.9080 0.8314 0.9288 tcs-sar1-shr 0.9539 0.9711 0.9643 0.9684 0.9644 0.8913 0.9263 0.9086 0.8318 0.9283 ite-wlsv-shr 0.9466 0.9700 0.9614 0.9665 0.9611 0.8897 0.9247 0.9071 0.8299 0.9257 ite-acov-shr 0.9528 0.9674 0.9627 0.9684 0.9628 0.8879 0.9257 0.9066 0.8297 0.9265 ite-sar1-shr 0.9469 0.9704 0.9611 0.9665 0.9612 0.8901 0.9246 0.9072 0.8300 0.9258 oct-wlsv 0.9589 0.9773 0.9712 0.9752 0.9706 0.8969 0.9339 0.9152 0.8404 0.9350 oct-bdshr 0.9552 0.9790 0.9632 0.9719 0.9673 0.8983 0.9288 0.9134 0.8364 0.9320 oct-acov 0.9631 0.9756 0.9729 0.9764 0.9720 0.8933 0.9356 0.9142 0.8383 0.9351 63 bottom series base 1 1 1 1 1 1 1 1 1 1 cs-shr 0.9917 0.9953 1.0002 1.0018 0.9972 0.9842 0.997 0.9906 0.9917 0.9945 t-wlsv 1.0022 0.9965 0.9953 0.9926 0.9967 0.9181 0.9611 0.9393 0.8727 0.9615 t-acov 0.9856 0.9896 1.0021 0.9951 0.9931 0.9023 0.9635 0.9324 0.8702 0.9571 t-sar1 1.0023 0.9968 0.9950 0.9926 0.9967 0.9183 0.9609 0.9393 0.8726 0.9615 kah-wlsv-shr 0.9930 0.9888 0.9875 0.9844 0.9884 0.9115 0.9559 0.9334 0.8703 0.9549 tcs-acov-shr 0.9751 0.9807 0.9953 0.9859 0.9842 0.8957 0.9582 0.9265 0.8680 0.9502 tcs-sar1-shr 0.9930 0.9891 0.9875 0.9844 0.9885 0.9117 0.9559 0.9335 0.8704 0.9550 ite-wlsv-shr 0.9898 0.9874 0.9869 0.9844 0.9871 0.9106 0.9568 0.9334 0.8699 0.9541 ite-acov-shr 0.9746 0.9819 0.9963 0.9878 0.9851 0.8965 0.9597 0.9276 0.8677 0.9509 ite-sar1-shr 0.9897 0.9879 0.9869 0.9844 0.9872 0.9109 0.9569 0.9336 0.8700 0.9542 oct-wlsv 0.9929 0.9901 0.9888 0.9870 0.9897 0.9133 0.9591 0.9360 0.8732 0.9568 oct-bdshr 1.0018 0.9925 0.9900 0.9892 0.9933 0.9178 0.9609 0.9391 0.8753 0.9600 oct-acov 0.9830 0.9869 0.9994 0.9937 0.9907 0.8981 0.9636 0.9303 0.8712 0.9554

q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q 4 2 1 all cs shr t wlsv t sar1 t acov oct bdshr oct wlsv oct acov tcs sar1-shr kah wlsv-shr ite sar1-shr ite wlsv-shr tcs acov-shr ite acov-shr 0.85 0.90 0.95 1.00 0.925 0.950 0.975 1.000 0.96 0.97 0.98 0.99 1.00 0.94 0.96 0.98 1.00 Temporal aggregation level All levels q all bts uts AvgRelMAE 1 1 2 1 2 2 1 2 3 3 3 3 4 4 4 4 5 6 6 5 6 5 7 6 7 9 5 7 8 7 8 9 9 10 9 8 10 11 10 10 11 12 12 11 12 13 11 12 13 8 13 13 14 14 14 14 2 2 2 1 1 1 1 2 3 3 5 3 4 4 8 4 5 5 6 6 6 6 7 7 7 8 3 8 8 7 9 11 10 10 10 12 9 9 4 5 11 12 11 9 12 11 12 10 13 13 13 13 14 14 14 14 3 4 1 6 7 4 1 2 2 2 3 3 5 6 6 4 5 5 9 10 8 8 9 9 7 8 7 13 14 10 11 11 11 12 10 12 12 11 12 10 1 13 13 14 13 14 14 all 1 2 4 all 1 2 4 all 1 4 base cs shr t wlsv t sar1 t acov oct bdshr oct wlsv oct acov tcs sar1-shr kah wlsv-shr ite sar1-shr ite wlsv-shr tcs acov-shr ite acov-shr all bts uts q q q q q q q q q q q q q q ite-sar1-shr 5.14

ite-wlsv-shr 5.14 ite-acov-shr 5.55 tcs-sar1-shr 5.68 tcs-acov-shr 5.71 kah-wlsv-shr 5.72 oct-acov 6.96 oct-wlsv 6.97 oct-bdshr 7.39 t-acov 8.45 t-sar1 8.56 t-wlsv 8.57 cs-shr 12.11 base 13.07 6 9 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 5.52

ite-sar1-shr 5.54 cs-shr 5.93 ite-acov-shr 6.31 kah-wlsv-shr 6.61 tcs-sar1-shr 6.61 tcs-acov-shr 7.33 oct-wlsv 7.41 oct-acov 7.49 oct-bdshr 8.43 base 8.92 t-acov 9.34 t-sar1 9.78 t-wlsv 9.8 6 8 10 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 6.25

ite-acov-shr 6.35 tcs-acov-shr 6.38 ite-sar1-shr 6.49 oct-acov 6.71 tcs-sar1-shr 6.72 kah-wlsv-shr 6.81 cs-shr 7.25 oct-wlsv 7.34 oct-bdshr 8.4 base 8.87 t-acov 8.99 t-wlsv 9.15 t-sar1 9.29 5 6 7 8 9 10

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 6.09

ite-sar1-shr 6.27 kah-wlsv-shr 6.45 tcs-sar1-shr 6.47 oct-bdshr 6.72 oct-wlsv 6.81 ite-acov-shr 6.95 tcs-acov-shr 7.27 oct-acov 7.89 t-wlsv 8.56 cs-shr 8.58 t-sar1 8.73 base 9.08 t-acov 9.12 5 6 7 8 9 10 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q tcs-sar1-shr 5.94

kah-wlsv-shr 6.03 ite-wlsv-shr 6.28 ite-sar1-shr 6.41 oct-wlsv 6.51 tcs-acov-shr 7.11 oct-bdshr 7.39 ite-acov-shr 7.68 oct-acov 8.15 t-wlsv 8.19 t-sar1 8.29 cs-shr 8.68 t-acov 8.79 base 9.55 5 6 7 8 9 10

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 5.62 ite-sar1-shr 5.88 ite-acov-shr 6.17 q q q q q q q q q q q q q q ite-acov-shr 5.03

ite-wlsv-shr 5.29 ite-sar1-shr 5.39 tcs-acov-shr 5.49 oct-acov 5.68 kah-wlsv-shr 6.17 tcs-sar1-shr 6.31 oct-wlsv 6.98 t-acov 7.92 oct-bdshr 8.08 t-wlsv 8.65 t-sar1 8.78 cs-shr 11.91 base 13.32 6 9 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q kah-wlsv-shr 5.97 tcs-sar1-shr 6.08 ite-wlsv-shr 6.18 tcs-acov-shr 6.39 ite-sar1-shr 6.42

ite-acov-shr 6.62 oct-wlsv 6.66 oct-bdshr 6.89 oct-acov 7.63 t-wlsv 7.87 t-sar1 7.98 t-acov 8.34 cs-shr 10.57 base 11.39 6 8 10 12 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-acov-shr 5.24

ite-wlsv-shr 5.48 tcs-acov-shr 5.58 ite-sar1-shr 5.78 oct-acov 6.19 kah-wlsv-shr 6.25 tcs-sar1-shr 6.41 oct-wlsv 6.87 t-acov 7.83 oct-bdshr 7.96 t-wlsv 8.25 t-sar1 8.35 cs-shr 11.72 base 13.08 6 9 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-acov-shr 5.72

ite-wlsv-shr 5.79 ite-sar1-shr 6 tcs-acov-shr 6.15 tcs-sar1-shr 6.15 kah-wlsv-shr 6.21 oct-acov 6.52 oct-wlsv 6.78 oct-bdshr 7.21 t-wlsv 7.84 t-acov 7.89 t-sar1 7.98 cs-shr 11.98 base 12.79 6 8 10 12 14

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different)

Figure A.9: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MSE mean rank for one-to-two-stepahead (top) six-months forecasts and one-step-ahead twelve-months forecasts (bottom). q q q q q q q q q q q q q q tcs-acov-shr 5.75

ite-wlsv-shr 6.18 ite-acov-shr 6.43 cs-shr 6.44 kah-wlsv-shr 6.46 tcs-sar1-shr 6.47 ite-sar1-shr 6.47 oct-wlsv 7.55 oct-acov 7.61 oct-bdshr 8.44 base 8.75 t-acov 9.35 t-wlsv 9.52 t-sar1 9.58 5 6 7 8 9 10

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-sar1-shr 5.81

ite-wlsv-shr 5.93 tcs-sar1-shr 6.23 kah-wlsv-shr 6.37 oct-bdshr 6.72 ite-acov-shr 6.76 tcs-acov-shr 7.2 oct-wlsv 7.37 cs-shr 7.99 oct-acov 8.28 t-sar1 8.81 t-wlsv 8.94 base 9.08 t-acov 9.52 5 6 7 8 9 10 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-sar1-shr 5.69

ite-wlsv-shr 5.74 tcs-sar1-shr 5.97 kah-wlsv-shr 6.02 tcs-acov-shr 6.79 ite-acov-shr 6.93 oct-wlsv 7.38 oct-bdshr 7.41 cs-shr 8.09 oct-acov 8.45 t-wlsv 8.79 t-sar1 8.92 base 9.24 t-acov 9.58 6 8 10

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 5.49

ite-sar1-shr 5.55 tcs-sar1-shr 6.2 ite-acov-shr 6.24 kah-wlsv-shr 6.28 tcs-acov-shr 6.47 cs-shr 7.41 oct-wlsv 7.49 oct-acov 7.89 oct-bdshr 8.07 base 9.36 t-sar1 9.41 t-wlsv 9.48 t-acov 9.63 6 8 10 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-acov-shr 5.29

ite-wlsv-shr 5.31 tcs-acov-shr 5.41 ite-sar1-shr 5.59 kah-wlsv-shr 5.88 tcs-sar1-shr 5.92 oct-acov 6.14 oct-wlsv 7.08 oct-bdshr 7.82 t-acov 8.04 t-wlsv 8.63 t-sar1 8.68 cs-shr 11.92 base 13.28 6 9 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q kah-wlsv-shr 5.75 tcs-sar1-shr 5.81 ite-wlsv-shr 5.99 tcs-acov-shr 6.02 ite-sar1-shr 6.12 ite-acov-shr 6.

2 oct-bdshr 6.88 oct-wlsv 7.32 oct-acov 7.84 t-sar1 8.22 t-acov 8.24 t-wlsv 8.34 cs-shr 10.67 base 11.6 6 8 10 12

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different)

Figure A.12: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MAE mean rank for one-step-ahead (top) and two-step-ahead (bottom) six-months forecasts. q q q q q q q q q q q q q q tcs-acov-shr 5.27

ite-acov-shr 5.28 ite-sar1-shr 5.47 ite-wlsv-shr 5.47 kah-wlsv-shr 5.76 tcs-sar1-shr 5.77 oct-acov 6.6 oct-wlsv 7.19 oct-bdshr 7.57 t-acov 8.02 t-wlsv 8.71 t-sar1 8.82 cs-shr 12.04 base 13.02 4 6 8 10 12 14

## Mean ranks

Critical distance = 2.04 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q ite-wlsv-shr 5.42

ite-acov-shr 5.53 ite-sar1-shr 5.68 tcs-sar1-shr 5.8 kah-wlsv-shr 5.82 tcs-acov-shr 5.82 oct-acov 6.64 oct-wlsv 7.23 oct-bdshr 7.36 t-acov 8.2 t-sar1 8.22 t-wlsv 8.46 cs-shr 12.16 base 12.65 4 6 8 10 12 14 Mean ranks Critical distance = 2.04 Friedman: 0 (Ha: Different) Table A.2: AvgRelMSE at any temporal aggregation level and any forecast horizon for all 95 time series and selected reconciliation procedures. Quarterly Semi-annual Annual All Series 1 2 3 4 1-4 1 2 1-2 1 Table A.3: AvgRelMAE at any temporal aggregation level and any forecast horizon for all 95 time series and selected reconciliation procedures. Quarterly Semi-annual Annual All Series 1 2 3 4 1-4 1 2 1-2 1 Table A.5: Variables, series IDs and their descriptions for Household Final Consumption -Expenditure Approach Variable Series ID Description GneDfdHfc A2302254W Household Final Consumption Expenditure GneDfdFceHfcFud A2302237V Food GneDfdFceHfcAbt A3605816F Alcoholic beverages and tobacco GneDfdFceHfcAbtCig A2302238W Cigarettes and tobacco GneDfdFceHfcAbtAlc A2302239X Alcoholic beverages GneDfdFceHfcCnf A2302240J Clothing and footwear GneDfdFceHfcHwe A3605680F Housing, water, electricity, gas and other fuels GneDfdFceHfcHweRnt A3605681J Actual and imputed rent for housing GneDfdFceHfcHweWsc A3605682K Water and sewerage charges GneDfdFceHfcHweEgf A2302242L Electricity, gas and other fuel GneDfdFceHfcFhe A2302243R Furnishings and household equipment GneDfdFceHfcFheFnt A3605683L Furniture, floor coverings and household goods GneDfdFceHfcFheApp A3605684R Household appliances GneDfdFceHfcFheTls A3605685T Household tools GneDfdFceHfcHlt A2302244T Health GneDfdFceHfcHltMed A3605686V Medicines, medical aids and therapeutic appliances GneDfdFceHfcHltHsv A3605687W Total health services GneDfdFceHfcTpt A3605688X Transport GneDfdFceHfcTptPvh A2302245V Purchase of vehicles GneDfdFceHfcTptOvh A2302246W Operation of vehicles GneDfdFceHfcTptTsv A2302247X Transport services GneDfdFceHfcCom A2302248A Communications GneDfdFceHfcRnc A2302249C Recreation and culture GneDfdFceHfcEdc A2302250L Education services GneDfdFceHfcHcr A2302251R Hotels, cafes and restaurants GneDfdFceHfcHcrCsv A3605694V Catering services GneDfdFceHfcHcrAsv A3605695W Accommodation services GneDfdFceHfcMis A3605696X Miscellaneous goods and services GneDfdFceHfcMisOgd A3605697A Other goods GneDfdFceHfcMisIfs A2302252T Insurance and other financial services GneDfdFceHfcMisOsv A3606485T Other services Source: Athanasopoulos et al. (2019).

Table A.8: AvgRelMSE at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All Procedure 1 2 3 4 1-4 1 2 1-2 1 all 95 series base 1 1 1 1 1 1 1 1 1 1 cs-ols 1.2189 1.1663 1.1631 1.1510 1.1745 1.1427 1.1428 1.1427 1.2238 1.1722 cs-struc 1.1911 1.1363 1.1248 1.1049 1.1388 1.1058 1.0733 1.0894 1.1046 1.1196 cs-wls 0.9619 0.9698 0.9730 0.9778 0.9706 0.9613 0.9741 0.9677 0.9724 0.9700 cs-shr 0.9583 0.9701 0.9757 0.9824 0.9716 0.9526 0.9781 0.9652 0.9657 0.9689 t-bu 1 1 1 1 1 0.8476 0.9475 0.8961 0.7885 0.9368 t-ols 1.3297 1.1369 1.0590 1.0225 1.1311 1.0380 0.9840 1.0106 0.8603 1.0533 t-struc 1.1581 1.0538 1.0105 0.9926 1.0519 0.9263 0.9450 0.9356 0.8042 0.9790 t-wlsh 0.9893 0.9994 1.0004 0.9891 0.9945 0.8364 0.9369 0.8853 0.7747 0.9283 t-wlsv 1.0017 0.9994 0.9875 0.9853 0.9934 0.8444 0.9316 0.8869 0.7729 0.9279 t-shr 1.0005 1.0067 1.0183 1.0065 1.0080 0.8378 0.9507 0.8924 0.7805 0.9386 t-acov 0.9780 0.9912 0.9986 0.9888 0.9891 0.8253 0.9353 0.8786 0.7694 0.9225 t-strar1 1.1578 1.0545 1.0112 0.9929 1.0522 0.9267 0.9454 0.9360 0.8045 0.9793 t-sar1 1.0018 0.9994 0.9875 0.9854 0.9935 0.8445 0.9317 0.8870 0.7729 0.9279 t-har1 0.9886 0.9995 1.0005 0.9894 0.9945 0.8366 0.9372 0.8855 0.7749 0.9284 32 upper series base 1 1 1 1 1 1 1 1 1 1 cs-ols 0.9713 0.9767 0.9798 0.9852 0.9782 0.9508 0.9854 0.9679 1.0166 0.9807 cs-struc 0.9720 0.9696 0.9655 0.9610 0.9670 0.9480 0.9486 0.9483 0.9602 0.9607 cs-wls 0.9271 0.9324 0.9349 0.9323 0.9317 0.9256 0.9310 0.9283 0.9255 0.9298 cs-shr 0.9157 0.9270 0.9300 0.9315 0.9260 0.9174 0.9387 0.9280 0.9232 0.9262 t-bu 1 1 1 1 1 0.8487 0.9486 0.8973 0.7714 0.9342 t-ols 1.2332 1.1338 1.0538 1.0386 1.1122 1.0203 0.9950 1.0076 0.8555 1.0415 t-struc 1.0944 1.0565 1.0106 1.0057 1.0412 0.9180 0.9555 0.9366 0.7986 0.9726 t-wlsh 1.0054 1.0128 0.9886 0.9938 1.0001 0.8558 0.9383 0.8961 0.7687 0.9334 t-wlsv 1.0064 1.0091 0.9909 0.9920 0.9996 0.8556 0.9386 0.8961 0.7684 0.9331 t-shr 1.0147 1.0165 1.0008 0.9982 1.0075 0.8577 0.9433 0.8995 0.7711 0.9388 t-acov 1.0018 1.0146 0.9922 0.9934 1.0004 0.8537 0.9382 0.895 0.7683 0.9332 t-strar1 1.0950 1.0556 1.0100 1.0059 1.0410 0.9177 0.9553 0.9363 0.7981 0.9723 t-sar1 1.0066 1.0093 0.9908 0.9921 0.9997 0.8560 0.9386 0.8963 0.7684 0.9333 t-har1 1.0056 1.0130 0.9884 0.9939 1.0002 0.8562 0.9383 0.8963 0.7688 0.9336 63 bottom series base 1 1 1 1 1 1 1 1 1 1 cs-ols 1.3679 1.2763 1.2690 1.2456 1.2889 1.2545 1.2321 1.2433 1.3448 1.2834 cs-struc 1.3207 1.2316 1.2155 1.1861 1.2375 1.1957 1.1427 1.1689 1.1861 1.2101 cs-wls 0.9801 0.9894 0.9929 1.0017 0.9910 0.9800 0.9968 0.9884 0.9971 0.9911 cs-shr 0.9806 0.9928 0.9998 1.0094 0.9956 0.9709 0.9987 0.9847 0.9880 0.9914 t-bu 1 1 1 1 1 0.8470 0.9469 0.8956 0.7973 0.9381 t-ols 1.3816 1.1384 1.0617 1.0145 1.1408 1.0471 0.9784 1.0122 0.8627 1.0594 t-struc 1.1919 1.0525 1.0105 0.9860 1.0573 0.9306 0.9397 0.9351 0.8071 0.9822 t-wlsh 0.9812 0.9926 1.0065 0.9867 0.9917 0.8267 0.9363 0.8798 0.7778 0.9257 t-wlsv 0.9992 0.9945 0.9858 0.9819 0.9903 0.8387 0.9281 0.8823 0.7752 0.9252 t-shr 0.9933 1.0018 1.0272 1.0107 1.0082 0.8278 0.9544 0.8889 0.7853 0.9384 t-acov 0.9661 0.9796 1.0019 0.9864 0.9834 0.8112 0.9338 0.8704 0.7699 0.9171 t-strar1 1.1910 1.0540 1.0118 0.9863 1.0579 0.9313 0.9404 0.9358 0.8078 0.9829 t-sar1 0.9994 0.9944 0.9858 0.9820 0.9904 0.8388 0.9282 0.8824 0.7752 0.9253 t-har1 0.9801 0.9927 1.0068 0.9871 0.9916 0.8268 0.9367 0.8801 0.7780 0.9257 Table A.9: AvgRelMAE at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All Procedure 1 2 3 4 1-4 1 2 1-2 1 all 95 series base 1 1 1 1 1 1 1 1 1 1 cs-ols 1.1168 1.0846 1.0806 1.0716 1.0883 1.0722 1.0621 1.0672 1.1032 1.0843 cs-struc 1.0997 1.0679 1.0600 1.0497 1.0692 1.0473 1.0306 1.0389 1.0536 1.0582 cs-wls 0.9793 0.9846 0.9866 0.9893 0.9850 0.9788 0.9857 0.9823 0.9907 0.9850 cs-shr 0.9769 0.9842 0.9863 0.9893 0.9842 0.9733 0.9871 0.9802 0.9840 0.9830 t-bu 1 1 1 1 1 0.9219 0.9665 0.9439 0.8763 0.9653 t-ols 1.1554 1.0714 1.0422 1.0240 1.0721 1.0243 0.9987 1.0114 0.9294 1.0331 t-struc 1.0772 1.0288 1.0146 1.0060 1.0313 0.9671 0.9755 0.9713 0.8964 0.9937 t-wlsh 0.9919 0.9992 1.0025 0.9969 0.9976 0.9170 0.9642 0.9403 0.8726 0.9623 t-wlsv 0.9997 0.9988 0.9967 0.9953 0.9976 0.9212 0.9617 0.9412 0.8714 0.9624 t-shr 0.9973 1.0007 1.0059 1.0032 1.0017 0.9166 0.9675 0.9417 0.8707 0.9647 t-acov 0.9893 0.9951 1.0020 0.9971 0.9959 0.9106 0.9632 0.9365 0.8697 0.9598 t-strar1 1.0773 1.0291 1.0148 1.0062 1.0315 0.9672 0.9757 0.9714 0.8965 0.9938 t-sar1 0.9997 0.9990 0.9964 0.9953 0.9976 0.9213 0.9615 0.9412 0.8712 0.9624 t-har1 0.9915 0.9993 1.0024 0.9969 0.9975 0.9171 0.9642 0.9404 0.8725 0.9623 32 upper series base 1 1 1 1 1 1 1 1 1 1 cs-ols 0.9820 0.9878 0.9875 0.9852 0.9856 0.9704 0.9857 0.9780 1.0073 0.9865 cs-struc 0.9821 0.9876 0.9840 0.9849 0.9846 0.9664 0.9738 0.9701 0.9927 0.9816 cs-wls 0.9562 0.9673 0.9664 0.9692 0.9648 0.9565 0.9656 0.9610 0.9775 0.9655 cs-shr 0.9484 0.9628 0.9595 0.9652 0.9590 0.9521 0.9679 0.9600 0.9691 0.9607 t-bu 1 1 1 1 1 0.9246 0.9628 0.9435 0.8665 0.9636 t-ols 1.0976 1.0686 1.0406 1.0339 1.0599 1.0120 1.0011 1.0065 0.9280 1.0247 t-struc 1.0350 1.0291 1.0157 1.0148 1.0236 0.9613 0.9784 0.9698 0.8941 0.9887 t-wlsh 0.9953 1.0063 0.9996 1.0017 1.0007 0.9278 0.9629 0.9452 0.8694 0.9650 t-wlsv 0.9947 1.0034 0.9994 1.0006 0.9995 0.9273 0.9628 0.9448 0.8689 0.9641 t-shr 1.0044 1.0068 0.9992 1.0025 1.0032 0.9310 0.9617 0.9462 0.8656 0.9660 t-acov 0.9965 1.0061 1.0019 1.0011 1.0014 0.9270 0.9627 0.9447 0.8688 0.9651 t-strar1 1.0355 1.0282 1.0151 1.0148 1.0234 0.9612 0.9781 0.9696 0.8936 0.9884 t-sar1 0.9947 1.0034 0.9993 1.0005 0.9995 0.9275 0.9626 0.9449 0.8686 0.9640 t-har1 0.9954 1.0063 0.9995 1.0015 1.0007 0.9281 0.9628 0.9453 0.8691 0.9649 63 bottom series base 1 1 1 1 1 1 1 1 1 1 cs-ols 1.1922 1.1373 1.1313 1.1183 1.1444 1.1280 1.1032 1.1155 1.1553 1.1376 cs-struc 1.1647 1.1111 1.1009 1.0842 1.1148 1.0909 1.0607 1.0757 1.0860 1.0994 cs-wls 0.9913 0.9936 0.9971 0.9996 0.9954 0.9903 0.9961 0.9932 0.9975 0.9951 cs-shr 0.9917 0.9953 1.0002 1.0018 0.9972 0.9842 0.9970 0.9906 0.9917 0.9945 t-bu 1 1 1 1 1 0.9205 0.9684 0.9441 0.8813 0.9661 t-ols 1.1859 1.0728 1.0430 1.0190 1.0783 1.0306 0.9974 1.0139 0.9301 1.0373 t-struc 1.0993 1.0287 1.0140 1.0016 1.0352 0.9700 0.9741 0.9721 0.8976 0.9963 t-wlsh 0.9902 0.9956 1.0040 0.9944 0.9960 0.9116 0.9649 0.9378 0.8743 0.9610 t-wlsv 1.0022 0.9965 0.9953 0.9926 0.9967 0.9181 0.9611 0.9393 0.8727 0.9615 t-shr 0.9936 0.9975 1.0093 1.0035 1.0010 0.9094 0.9705 0.9395 0.8733 0.9640 t-acov 0.9856 0.9896 1.0021 0.9951 0.9931 0.9023 0.9635 0.9324 0.8702 0.9571 t-strar1 1.0991 1.0295 1.0147 1.0018 1.0356 0.9703 0.9744 0.9724 0.8980 0.9966 t-sar1 1.0023 0.9968 0.9950 0.9926 0.9967 0.9183 0.9609 0.9393 0.8726 0.9615 t-har1

0.9896 0.9957 1.0039 0.9946 0.9959 0.9116 0.9649 0.9379 0.8743 0.9609 q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q Cross-sectional Temporal 

## Temporal aggregation level

All levels q all bts uts AvgRelMSE

1 3 1 1 2 4 4 3 3 5 5 2 4 7 2 4 5 6 3 5 6 8.5 7 7 7 10 6 6 8 2 10 11 9 1 11 12 10 11 8 8 11 12 9 9 12 8.5 12 13 13 13 13 10 14 14 14 14 15 15 15 15 1 1 1 1 2 2 4 3 3 3 5 2 4 6 2 4 5 5 3 5 6 8.5 7 7 7 10 6 6 11 7 10 11 10 4 11 12 8 11 8 8 9 12 9 9 12 8.5 12 13 13 13 13 10 14 14 14 14 15 15 15 15 4 11 1 3 5 2 5 6 3 6 9 4 7 10 5 8 7.5 7 9 12 6 1 1 11 2 2 12 12 14 11 9 11 13 10 8 14 7.5 14 14 15 15 15 10 10 3 12 13 13 4 13 15 all 1 2 4 all 1 2 4 all 1 4 cs ols cs struc t ols base t strar1 t struc cs wls cs shr t shr t bu t har1 t wlsh t sar1 t wlsv t acov all bts uts Figure A.14: Top panel: Average Relative MSE across all series and forecast horizons, by frequency of observation. Bottom panel: Rankings by frequency of observation and forecast horizon.

q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q Cross-sectional

Temporal 4 2 1 all ols struc wls shr ols strar1 struc bu shr wlsv sar1 wlsh har1 acov 0.9 1.0 1.1 0.96 1.00 1.04 1.08 1.12 0.95 1.00 1.05 1.10 1.15 0.95 1.00 1.05 1.10 Temporal aggregation level All levels q all bts uts AvgRelMAE 1 3 1 1 2 4 3 5 3 6 2 6 4 5 5 3 5 7 4 4 6 10 6 2 7 8.5 7 7 8 1 10 11 9 2 11 12 10 11 8 8 11 12 9 9 12 8.5 12 13 13 14 13 10 14 13 14 14 15 15 15 15 1 1 1 1 2 3 3 6 3 4 2 5 4 6 4 2 5 5 5 3 6 10 6 4 7 8.5 7 7 8 7 10 11 9 2 11 12 10 11 8 8 11 12 9 9 12 8.5 12 13 13 13 13 10 14 14 14 14 15 15 15 15 7 11 4 5 9 6 6 10 7 3 5 3 4 6 5 9 12 1 2 7.5 2 1 1 11 8 2 12 13 14 11 9 12 13 10 8 14 7.5 14 14 15 15 15 10 10 3 12 13 11 4 13 15 all 1 2 4 all 1 2 4 all 1 4 cs ols cs struc t ols base t strar1 t struc cs wls cs shr t bu t shr t wlsv t sar1 t wlsh t har1 t acov all bts uts Figure A.15: Top panel: Average Relative MAE across all series and forecast horizons, by frequency of observation. Bottom panel: Rankings by frequency of observation and forecast horizon.

q q q q q q q q q q q q q q q t-wlsv 4.85

t-sar1 5.07 t-wlsh 5.22 t-acov 5.32 t-har1 5.46 t-bu 6.84 t-shr 6.89 cs-shr 8.43 t-struc 8.54 t-strar1 8.55 cs-wls 8.57 cs-struc 10.87 cs-ols 11.43 t-ols 11.77 base 12.18 4 6 8 10 12

## Mean ranks

Critical distance = 2.2 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q q cs-shr 4.

89 cs-wls 4.89 t-har1 6.95 t-wlsh 6.95 t-acov 7.13 t-sar1 7.24 t-wlsv 7.37 t-bu 7.52 base 7.52 cs-struc 7.79 cs-ols 8.27 t-shr 8.34 t-strar1 10.92 t-struc 10.99 t-ols 13.23 6 9 12

## Mean ranks

Critical distance = 2.2 Friedman: 0 (Ha: Different)

Figure A.16: Nemenyi test results at 5% significance level for all 95 series. The crosssectional and temporal reconciliation procedures are sorted vertically according to the MSE mean rank (i) across all time frequencies and forecast horizons (top), and (ii) for one-stepahead quarterly forecasts (bottom). q q q q q q q q q q q q q q q t-sar1 5.17

t-wlsv 5.19 t-har1 5.31 t-wlsh 5.43 t-acov 5.51 t-shr 6.09 t-bu 6.48 cs-shr 7.92 cs-wls 8.24 t-struc 9.06 t-strar1 9.08 cs-struc 11.09 cs-ols 11.19 base 12 t-ols 12.23 4 6 8 10 12

## Mean ranks

Critical distance = 2.2 Friedman: 0 (Ha: Different) q q q q q q q q q q q q q q q cs-shr 4.

8 cs-wls 4.82 t-har1 6.64 t-wlsh 6.73 t-sar1 7.37 t-bu 7.41 base 7.41 t-wlsv 7.41 t-acov 7.52 cs-struc 8.32 t-shr 8.52 cs-ols 8.84 t-struc 10.54 t-strar1 10.55 t-ols 13.15 6 9 12

## Mean ranks

Critical distance = 2.2 Friedman: 0 (Ha: Different)

Figure A.17: Nemenyi test results at 5% significance level for all 95 series. The crosssectional and temporal reconciliation procedures are sorted vertically according to the MAE mean rank (i) across all time frequencies and forecast horizons (top), and (ii) for one-stepahead quarterly forecasts (bottom).

A.8.3 Heuristic KA, alternatives and iterative cross-temporal reconciliation procedures q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q Heuristic KA Heuristic KA Alternatives Iterative q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q q Heuristic KA Heuristic KA Alternatives

Iterative 4 2 1 all struc-wls struc-shr wlsv-wls wlsh-wls wlsh-shr wlsv-shr bu-wls sar1-wls har1-wls shr-wls bu-shr acov-wls shr-shr har1-shr sar1-shr acov-shr struc-wls struc-shr bu-wls bu-shr shr-wls wlsh-wls har1-wls wlsv-wls sar1-wls shr-shr acov-wls har1-shr wlsh-shr sar1-shr wlsv-shr acov-shr 0.85 0.90 0.95 1.00 0.900 0.925 0.950 0.975 1.000 0.96 0.98 1.00 1.02 0.92 0.94 0.96 0.98 1.00 Temporal aggregation level All levels q all bts uts AvgRelMAE Figure A.19: Average Relative MAE across all series and forecast horizons, by frequency of observation (selected procedures). 1 1 1 1 2 2 2 2 3 3 3 7 4 6 4 8 5 4 8 3 6 5 10 4 7 7 5 9 8 8 6 10 9 9 11 5 10 10 12 6 11 12 7 11 12 11 9 12 13 13 21 15 14 14 22 16 15 15 19 13 16 16 20 14 17 17 17 21 18 19 15 18 19 18 16 20 20 20 14 17 21 25 13 19 22 21 25 26 23 22 26 25 24 26 18 22 25 27 24 24 26 28 23 23 27 23 27 27 28 24 28 28 29 29 30 29 30 31 29 30 31 30 32 32 32 32 31 31 33 33 34 33.5 34 34 36 36 35 35 33 33.5 36 36 35 35 37 37 37 37 38 38 38 38 39 39 49 40 40 40 50 39 41.5 41.5 43 43 41.5 41.5 44 44 43.5 43.5 48 45.5 43.5 43.5 47 45.5 45.5 45.5 41.5 47.5 45.5 45.5 41.5 47.5 47 47.5 45 49.5 48 47.5 46 49.5 49.5 49.5 39 41 49.5 49.5 40 42 51.5 53 51.5 52 51.5 54 51.5 51 53.5 55 53 53.5 53.5 56 54 53.5 55.5 51.5 55.5 57.5 55.5 51.5 55.5 57.5 57.5 67.5 57.5 55 57.5 67.5 57.5 56 59 57.5 63.5 61 60 57.5 63.5 62 61 59 67.5 65.5 62 60 67.5 65.5 63 61 62 63 64 62 61 64 65.5 65 59 59 65.5 66 60 60 67.5 63.5 65 67.5 67.5 63.5 66 67.5 69.5 69.5 71 77 69.5 69.5 72 78 71.5 71 70 69.5 71.5 72 69 69.5 73.5 73.5 73.5 71 73.5 73.5 73.5 72 75 75.5 75.5 75.5 76 75.5 75.5 75.5 77.5 77.5 77.5 73 77.5 77.5 77.5 74 79.5 79 79.5 79.5 79.5 80 79.5 79.5 2 3 2 2 1 1 1 1 3 2 3 3 4 4 4 4 7 5 14 7 9 8 16 8 11 15 7 13 12 16 8 14 5 6 10 5 6 7 12 6 8 10 5 9 10 11 6 12 17 13 20 15 18 14 19 16 13 9 18 10 14 12 17 11 20 19 15 20 16 17 11 18 19 20 13 19 15 18 9 17 22 25 22 21 23 21 25 25 24 22 26 26 21 24 21 22 25 27 23 23 27 28 24 24 26 23 27 31 28 26 28 34 30 30 30 28 29 29 29 27 32 32 32 30 31 31 31 29 33 33 34 33 35 35 36 35 6 3 2 14 15 13 9 25 26 21 24 21 21 19 20 3 2 5 3 4 3 6 4 7 8 8 5 8 9 9 6 15 14 16 12 13 12 15 10 18 18 18 15 17 16 17 14 19 19 20 19 20 20 22 21 24 24 25 23 26 25 27 26 22 22 23 22 27 27 26 27 23 23 24 25 28 28 28 28 10 11 7 7 11 10 12 17 6 5 4 11 16 17 14 16 12 13 11 13 2 4 1 1 9 7 10 18 1 1 2 8 43 49 45 45 45 57 48 46 44 52 46 44 46 58 47 43 62 62 63 49 61 61 61 48 64 64 64 50 63 63 62 47 73 73 73 69 74 74 74 74 75 75 75 75 76 76 76 76 33 33.5 42 37 34 33.5 41 38 31.5 31.5 40 33 31.5 31.5 39 34 39 37 37 39.5 40 38 38 39.5 37 35.5 33 35 38 35.5 34 36 35 39 30 29.5 36 40 29 29.5 67 67.5 67.5 68 68 67.5 67.5 67 65.5 65 65.5 66 65.5 66 65.5 65 29.5 30 32 41.5 29.5 29 31 41.5 41 41 35 31 42 42 36 32 52 46 53 55.5 51 45 54 55.5 49 43 55 54 50 44 56 53 54 55.5 50 58 53 55.5 49 57 48 48 44 52 47 47 43 51 55.5 53 51 60 55.5 54 52 59 57.5 51 57 63.5 57.5 50 58 63.5 71.5 71.5 71.5 72 71.5 71.5 71.5 73 69 69 69.5 70 70 70 69.5 71 59.5 59.5 59.5 61 59.5 59.5 59.5 62 77.5 77.5 77 77 77.5 77.5 78 78 79.5 79.5 79.5 79.5 79.5 79.5 79.5 79.5 all 1 2 4 all 1 2 4 all 1 2 4 ite ols-ols tcs ols-ols tcs ols-struc ite ols-struc ite shr-ols tcs shr-ols ite strar1-ols tcs strar1-ols ite struc-ols tcs struc-ols ite bu-ols tcs bu-ols ite har1-ols tcs har1-ols ite acov-ols tcs acov-ols ite wlsh-ols tcs wlsh-ols ite sar1-ols tcs sar1-ols ite wlsv-ols tcs wlsv-ols tcs shr-struc ite shr-struc ite bu-struc tcs bu-struc tcs strar1-struc ite strar1-struc tcs struc-struc ite struc-struc tcs acov-struc ite acov-struc tcs har1-struc ite har1-struc tcs wlsh-struc ite wlsh-struc ite sar1-struc tcs sar1-struc tcs wlsv-struc ite wlsv-struc ite ols-wls tcs ols-wls ite ols-shr tcs ols-shr tcs strar1-wls kah struc-wls ite strar1-wls ite struc-wls tcs strar1-shr ite strar1-shr kah struc-shr ite struc-shr ite bu-shr ite bu-wls ite shr-shr ite shr-wls tcs shr-wls tcs bu-shr tcs bu-wls tcs shr-shr kah wlsh-wls ite wlsh-wls tcs har1-wls ite har1-wls kah wlsv-wls tcs sar1-wls ite wlsv-wls ite sar1-wls tcs har1-shr kah wlsh-shr tcs sar1-shr kah wlsv-shr ite har1-shr ite wlsh-shr ite sar1-shr ite wlsv-shr ite acov-wls tcs acov-wls tcs acov-shr ite acov-shr all bts uts Figure A.20: Rankings (Average Relative MSE) by frequency of observation and forecast horizon. 1 1 2 1 2 2 1 2 3 3 9 5 4 4 11 6 5 6 5 9 6 5 6 10 7 8 12 7 8 7 13 8 9 10 7 11 10 9 8 12 11 14 3 3 12 11 4 16 13 12 10 15 14 26 14 4 15 13 17 19 16 25 15 14 17 15 22 17 18 16 23 18 19 17 20 22 20 18 18 23 21 21 21 24 22 28 16 13 23 20 24 20 24 23 19 25 25 22 25 21 26 19 26 26 27 24 28 28 28 27 27 27 29 29 30 30 30 30 32 32 31 31 29 29 32 32 31 31 33 33 34 33 34 34 36 36 35 35 33 34 6 9 11 5 11 10 9 6 12 21 22 9 13 3 3 3 8 4 4 4 10 25 27 24 18 26 24 25 25 22 21 14 19 18 16 22 15 17 17 21 14 15 13 18 23 16 18 17 21 14 14 16 24 23 25 23 20 20 19 20 17 13 15 15 22 19 20 19 16 24 23 26 26 28 28 28 28 27 26 27 27 29 29 30 30 31 30 32 32 30 31 29 29 32 32 31 31 33 33 34 34 35 34 36 36 34 35 33 33 36 36 35 35 37 38 37 38 38 37 38 37 41 41.5 45 43 42 41.5 46 44 43.5 43.5 49.5 45 43.5 43.5 49.5 46 45.5 45.5 43.5 47 45.5 45.5 43.5 48 47 47 47 49.5 48 48 48 49.5 49.5 49.5 41.5 41 49.5 49.5 41.5 42 40 40 39 40 39 39 40 39 55.5 55.5 57.5 58 55.5 55.5 57.5 57 57 57 55.5 55 58 58 55.5 56 51.5 51.5 51.5 51.5 51.5 51.5 51.5 51.5 53 53.5 53.5 53 54 53.5 53.5 54 59.5 59 61.5 63 59.5 60 61.5 64 61.5 61.5 65 67.5 61.5 61.5 66 67.5 63 63 64 65 64 64 63 66 67.5 67.5 59.5 59.5 67.5 67.5 59.5 59.5 65.5 65.5 67 69.5 65.5 65.5 68 69.5 75 73.5 75.5 77 76 73.5 75.5 78 69.5 69 69 71.5 69.5 70 70 71.5 71.5 71.5 71 73 71.5 71.5 72 74 77.5 77 77.5 75.5 77.5 78 77.5 75.5 73.5 76 73.5 62 73.5 75 73.5 61 79.5 79 79.5 79.5 79.5 80 79.5 79.5 7 6 5 5 13 13 10 5 3 6 6 6 4 7 7 8 8 8 8 9 9 9 12 11 13 10 10 12 15 15 15 14 14 14 4 7 3 2 26 27 24 21 25 19 3 5 1 1 2 2 2 3 18 18 17 19 19 20 20 20 21 22 22 22 24 24 23 27 26 26 17 17 11 23 21 25 28 28 28 25 23 27 16 16 18 1 1 4 4 11 12 9 16 58 56 59 57 55 57 60 60 60 59 59 58 63 62 63 61 61 61 64 64 64 62 63 62 73 73 73 74 74 74 33.5 35 39.5 39 33.5 36 39.5 40 31.5 33 36 31.5 34 35 39 43 41.5 41.5 40 44 41.5 41.5 35 41.5 37 36 41.5 38 43 47 33.5 44 48 33.5 75 75 75 76 76 76 29.5 29.5 32 29.5 29.5 31 37 53.5 29 38 53.5 30 67 67.5 67.5 68 67.5 67.5 65.5 65.5 66 65.5 65.5 65 47.5 39.5 53.5 47.5 39.5 53.5 45 37 50 46 38 49 53.5 51.5 55.5 53.5 51.5 55.5 49.5 45.5 45.5 47.5 49.5 45.5 45.5 47.5 51.5 49 53.5 52 51.5 50 53.5 51 41.5 32 45.5 41.5 31 45.5 71.5 71 71.5 71 71.5 72 71.5 72 69.5 69.5 69.5 69 69.5 69.5 69.5 70 55.5 57.5 43.5 55.5 57.5 43.5 77.5 77.5 78 77.5 77.5 77 79.5 80 79 79.5 79 80 all 1 2 4 all 1 2 4 all 1 2 4 ite ols-ols tcs ols-ols ite ols-struc tcs ols-struc ite shr-ols tcs shr-ols ite strar1-ols tcs strar1-ols ite struc-ols tcs struc-ols ite bu-ols tcs bu-ols ite har1-ols tcs har1-ols ite acov-ols tcs acov-ols ite wlsh-ols tcs wlsh-ols ite sar1-ols tcs sar1-ols ite wlsv-ols tcs wlsv-ols tcs strar1-struc ite strar1-struc tcs struc-struc ite struc-struc tcs shr-struc ite shr-struc ite bu-struc tcs bu-struc ite ols-wls tcs ols-wls tcs acov-struc ite acov-struc tcs har1-struc ite har1-struc tcs wlsh-struc ite wlsh-struc tcs sar1-struc ite sar1-struc tcs wlsv-struc ite wlsv-struc ite ols-shr tcs ols-shr tcs strar1-wls kah struc-wls ite strar1-wls ite struc-wls tcs strar1-shr kah struc-shr ite strar1-shr ite struc-shr ite bu-wls ite bu-shr tcs bu-wls kah wlsv-wls kah wlsh-wls tcs sar1-wls ite shr-wls tcs har1-wls ite wlsh-wls ite har1-wls ite wlsv-wls ite sar1-wls tcs shr-wls tcs bu-shr ite shr-shr ite acov-wls tcs acov-wls tcs shr-shr tcs har1-shr kah wlsh-shr tcs sar1-shr kah wlsv-shr ite har1-shr ite wlsh-shr ite sar1-shr ite wlsv-shr tcs acov-shr ite acov-shr all bts uts Figure A.21: Rankings (Average Relative MAE) by frequency of observation and forecast horizon. Table A.10: AvgRelMSE for the 63 bottom series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All bts bts bts bts Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 1.1655 1.037 0.9986 0.9774 1.0422 0.9146 0.9335 0.9240 0.8004 0.9697 kah-struc-wls 1.1776 1.044 1.0045 0.9832 1.0497 0.9241 0.9399 0.9320 0.8088 0.9775 kah-wlsh-shr 0.9665 0.9806 0.9954 0.9802 0.9806 0.8156 0.9327 0.8722 0.7738 0.9168 kah-wlsh-wls 0.9677 0.9812 0.9961 0.9819 0.9817 0.8180 0.9344 0.8743 0.7767 0.9185 kah-wlsv-shr 0.9832 0.9817 0.9760 0.9759 0.9792 0.8267 0.9250 0.8745 0.7712 0.9163 kah-wlsv-wls 0.9852 0.9826 0.9772 0.9776 0.9806 0.8292 0.9267 0.8766 0.7741 0.9182 tcs-acov-ols 1.3388 1.2584 1.2274 1.1982 1.2546 1.0590 1.1541 1.1055 0.9941 1.1705 tcs-acov-shr 0.9474 0.9659 0.9921 0.9780 0.9707 0.7988 0.9294 0.8616 0.7658 0.9069 tcs-acov-struc 1.3029 1.2033 1.1716 1.1406 1.2031 1.0117 1.0845 1.0474 0.9149 1.1120 tcs-acov-wls 0.9482 0.9664 0.9926 0.9806 0.9718 0.8009 0.9316 0.8638 0.7691 0.9088 tcs-bu-ols 1.3679 1.2763 1.2690 1.2456 1.2889 1.1056 1.2150 1.1590 1.0525 1.2147 tcs-bu-shr 0.9829 0.9880 0.9886 0.9953 0.9887 0.8347 0.9445 0.8879 0.7931 0.9291 tcs-bu-struc 1.3207 1.2316 1.2155 1.1861 1.2375 1.0595 1.1444 1.1011 0.9765 1.1571 tcs-bu-wls 0.9802 0.9852 0.9866 0.9943 0.9866 0.8331 0.9426 0.8862 0.7920 0.9272 tcs-har1-ols 1.3363 1.2496 1.2271 1.1976 1.2516 1.0619 1.1568 1.1083 0.9982 1.1704 tcs-har1-shr 0.9653 0.9809 0.9959 0.9808 0.9806 0.8157 0.9333 0.8725 0.7742 0.917 tcs-har1-struc 1.2958 1.1954 1.1721 1.1392 1.1993 1.0126 1.0866 1.049 0.9180 1.1110 tcs-har1-wls 0.9664 0.9812 0.9965 0.9824 0.9816 0.8179 0.9350 0.8745 0.7770 0.9185 tcs-ols-ols 1.7104 1.3863 1.2740 1.2026 1.3806 1.2869 1.1842 1.2345 1.0876 1.2924 tcs-ols-shr 1.3474 1.1180 1.0442 1.0021 1.1205 1.0262 0.9673 0.9963 0.8529 1.0421 tcs-ols-struc 1.6399 1.3133 1.2004 1.1375 1.3095 1.2109 1.1017 1.1550 0.9844 1.2129 tcs-ols-wls 1.3654 1.1295 1.0541 1.0111 1.1323 1.0407 0.9776 1.0086 0.8656 1.0543 tcs-sar1-ols 1.3374 1.2433 1.2162 1.1903 1.2456 1.0659 1.1529 1.1085 0.9975 1.1672 tcs-sar1-shr 0.9832 0.9818 0.9762 0.9761 0.9793 0.8268 0.9253 0.8746 0.7713 0.9164 tcs-sar1-struc 1.2916 1.1925 1.1595 1.1318 1.1924 1.0168 1.0828 1.0493 0.9171 1.1073 tcs-sar1-wls 0.9850 0.9824 0.9773 0.9777 0.9806 0.8291 0.9268 0.8766 0.7740 0.9181 tcs-shr-ols 1.4139 1.3282 1.2923 1.2264 1.3135 1.1276 1.1991 1.1628 1.0454 1.2278 tcs-shr-shr 0.9704 0.9856 1.0148 1.0045 0.9937 0.8118 0.9515 0.8789 0.7819 0.9271 tcs-shr-struc 1.3675 1.2744 1.2369 1.1710 1.2605 1.0762 1.1297 1.1027 0.9616 1.1672 tcs-shr-wls 0.9675 0.9832 1.0146 1.0045 0.9923 0.8103 0.9518 0.8782 0.7826 0.9263 tcs-strar1-ols 1.4718 1.2772 1.2113 1.1662 1.2765 1.1307 1.1334 1.1321 1.0033 1.1918 tcs-strar1-shr 1.1644 1.0386 1.0001 0.9778 1.0428 0.9152 0.9344 0.9247 0.8011 0.9704 tcs-strar1-struc 1.4217 1.2193 1.1495 1.1083 1.2191 1.0749 1.0620 1.0684 0.9202 1.1278 tcs-strar1-wls 1.1764 1.0453 1.0057 0.9836 1.0502 0.9245 0.9407 0.9326 0.8093 0.9780 tcs-struc-ols 1.4716 1.2748 1.2104 1.1649 1.2753 1.1291 1.1323 1.1307 1.0022 1.1905 tcs-struc-struc 1.4219 1.2178 1.1486 1.1073 1.2182 1.074 1.0610 1.0675 0.9196 1.1269 tcs-wlsh-ols 1.3362 1.2468 1.2255 1.1961 1.2501 1.0595 1.1553 1.1063 0.9964 1.1687 tcs-wlsh-struc 1.2960 1.1939 1.1712 1.1385 1.1985 1.0112 1.0857 1.0478 0.9173 1.1101 tcs-wlsv-ols 1.3368 1.2407 1.2151 1.1890 1.2442 1.0637 1.1515 1.1067 0.9958 1.1656 tcs-wlsv-struc 1.2917 1.1909 1.1589 1.1311 1.1916 1.0156 1.0821 1.0483 0.9165 1.1065 ite-acov-ols 1.3388 1.2584 1.2274 1.1982 1.2546 1.0590 1.1541 1.1055 0.9941 1.1705 ite-acov-shr 0.9457 0.9679 0.9945 0.9830 0.9726 0.7989 0.9323 0.8631 0.7669 0.9086 ite-acov-struc 1.3029 1.2033 1.1716 1.1406 1.2031 1.0117 1.0845 1.0474 0.9149 1.1120 ite-acov-wls 0.9482 0.9698 0.9942 0.9836 0.9738 0.8022 0.9340 0.8656 0.7703 0.9106 ite-bu-ols 1.3679 1.2763 1.2690 1.2456 1.2889 1.1056 1.2150 1.1590 1.0525 1.2147 ite-bu-shr 0.9806 0.9928 0.9998 1.0094 0.9956 0.8384 0.9639 0.8989 0.809 0.9387 ite-bu-struc 1.3207 1.2316 1.2155 1.1861 1.2375 1.0595 1.1444 1.1011 0.9765 1.1571 ite-bu-wls 0.9801 0.9894 0.9929 1.0017 0.9910 0.8366 0.9534 0.8931 0.8032 0.9335 ite-har1-ols 1.3363 1.2496 1.2271 1.1976 1.2516 1.0619 1.1568 1.1083 0.9982 1.1704 ite-har1-shr 0.9606 0.9813 0.9984 0.9843 0.9811 0.8147 0.9362 0.8733 0.7753 0.9176 ite-har1-struc 1.2958 1.1954 1.1721 1.1392 1.1993 1.0126 1.0866 1.049 0.9180 1.1110 ite-har1-wls 0.9634 0.9826 0.9980 0.9845 0.9821 0.8175 0.9372 0.8753 0.7782 0.9193 ite-ols-ols 1.7104 1.3863 1.2740 1.2026 1.3806 1.2869 1.1842 1.2345 1.0876 1.2924 ite-ols-shr 1.3601 1.1188 1.0441 0.9997 1.1226 1.0313 0.9661 0.9982 0.8531 1.0438 ite-ols-struc 1.6399 1.3133 1.2004 1.1375 1.3095 1.2109 1.1017 1.1550 0.9844 1.2129 ite-ols-wls 1.3694 1.1288 1.0536 1.0100 1.1325 1.0414 0.9773 1.0088 0.8641 1.0542 ite-sar1-ols 1.3374 1.2433 1.2162 1.1903 1.2456 1.0659 1.1529 1.1085 0.9975 1.1672 ite-sar1-shr 0.9800 0.9817 0.9779 0.9778 0.9793 0.8262 0.9278 0.8755 0.7725 0.9169 ite-sar1-struc 1.2916 1.1925 1.1595 1.1318 1.1924 1.0168 1.0828 1.0493 0.9171 1.1073 ite-sar1-wls 0.9836 0.9826 0.9783 0.9790 0.9809 0.8290 0.9290 0.8776 0.7754 0.9188 ite-shr-ols 1.4139 1.3282 1.2923 1.2264 1.3135 1.1276 1.1991 1.1628 1.0454 1.2278 ite-shr-shr 0.9786 0.9960 1.0231 1.0095 1.0017 0.8204 0.9570 0.8861 0.7869 0.9344 ite-shr-struc 1.3675 1.2744 1.2369 1.1710 1.2605 1.0762 1.1297 1.1027 0.9616 1.1672 ite-shr-wls 0.9710 0.9911 1.0195 1.0070 0.9970 0.8156 0.9556 0.8828 0.7854 0.9307 ite-strar1-ols 1.4718 1.2772 1.2113 1.1662 1.2765 1.1307 1.1334 1.1321 1.0033 1.1918 ite-strar1-shr 1.1692 1.0373 0.9997 0.9768 1.0432 0.9161 0.9345 0.9252 0.8012 0.9707 ite-strar1-struc 1.4217 1.2193 1.1495 1.1083 1.2191 1.0749 1.0620 1.0684 0.9202 1.1278 ite-strar1-wls 1.1782 1.0441 1.0049 0.9830 1.0499 0.9245 0.9409 0.9327 0.8093 0.9779 ite-struc-ols 1.4716 1.2748 1.2104 1.1649 1.2753 1.1291 1.1323 1.1307 1.0022 1.1905 ite-struc-shr 1.1699 1.0357 0.9983 0.9764 1.0425 0.9152 0.9336 0.9244 0.8004 0.9700 ite-struc-struc 1.4219 1.2178 1.1486 1.1073 1.2182 1.074 1.0610 1.0675 0.9196 1.1269 ite-struc-wls 1.1793 1.043 1.0036 0.9826 1.0495 0.9241 0.9402 0.9321 0.8088 0.9774 ite-wlsh-ols 1.3362 1.2468 1.2255 1.1961 1.2501 1.0595 1.1553 1.1063 0.9964 1.1687 ite-wlsh-shr 0.9618 0.9809 0.9979 0.9837 0.9810 0.8144 0.9355 0.8729 0.7748 0.9174 ite-wlsh-struc 1.2960 1.1939 1.1712 1.1385 1.1985 1.0112 1.0857 1.0478 0.9173 1.1101 ite-wlsh-wls 0.9649 0.9826 0.9976 0.9841 0.9822 0.8176 0.9367 0.8751 0.7780 0.9192 ite-wlsv-ols 1.3368 1.2407 1.2151 1.1890 1.2442 1.0637 1.1515 1.1067 0.9958 1.1656 ite-wlsv-shr 0.9798 0.9814 0.9776 0.9776 0.9791 0.8259 0.9275 0.8753 0.7723 0.9166 ite-wlsv-struc 1.2917 1.1909 1.1589 1.1311 1.1916 1.0156 1.0821 1.0483 0.9165 1.1065 ite-wlsv-wls 0.9837 0.9828 0.9782 0.9789 0.9809 0.8292 0.9288 0.8776 0.7754 0.9188 Table A.11: AvgRelMSE for the 32 upper series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All bts bts bts bts Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 1.0261 0.9976 0.9521 0.9483 0.9805 0.863 0.8976 0.8801 0.7471 0.9145 kah-struc-wls 1.0369 1.0072 0.9605 0.9556 0.9895 0.8729 0.9060 0.8893 0.757 0.9237 kah-wlsh-shr 0.9432 0.9481 0.9295 0.9326 0.9383 0.7995 0.8780 0.8378 0.7159 0.8740 kah-wlsh-wls 0.9469 0.9544 0.9345 0.9359 0.9429 0.8047 0.883 0.843 0.7217 0.8790 kah-wlsv-shr 0.9398 0.9467 0.9281 0.9302 0.9362 0.7996 0.8769 0.8373 0.7151 0.8726 kah-wlsv-wls 0.9457 0.9528 0.9335 0.9341 0.9415 0.8053 0.8819 0.8427 0.7209 0.8780 tcs-acov-ols 0.9727 0.9873 0.9744 0.9779 0.9781 0.8319 0.9306 0.8799 0.7600 0.9154 tcs-acov-shr 0.9411 0.9435 0.9307 0.9331 0.9371 0.7956 0.8779 0.8357 0.7146 0.8725 tcs-acov-struc 0.9820 0.9837 0.9593 0.9579 0.9706 0.8277 0.9055 0.8657 0.7411 0.9039 tcs-acov-wls 0.9447 0.9513 0.9351 0.9371 0.942 0.8012 0.8832 0.8412 0.7205 0.8778 tcs-bu-ols 0.9713 0.9767 0.9798 0.9852 0.9782 0.8325 0.9403 0.8847 0.7659 0.9179 tcs-bu-shr 0.9278 0.9299 0.9327 0.9313 0.9305 0.7864 0.8809 0.8323 0.7150 0.8680 tcs-bu-struc 0.9720 0.9696 0.9655 0.9610 0.967 0.8219 0.9132 0.8663 0.7443 0.9027 tcs-bu-wls 0.9316 0.9342 0.9362 0.9333 0.9338 0.7898 0.8837 0.8354 0.7179 0.8712 tcs-har1-ols 0.9774 0.9857 0.9723 0.9795 0.9787 0.8351 0.9316 0.8821 0.7613 0.9166 tcs-har1-shr 0.9432 0.9480 0.9294 0.9325 0.9382 0.7995 0.8779 0.8377 0.7158 0.8739 tcs-har1-struc 0.9826 0.9827 0.9576 0.9582 0.9702 0.8296 0.9058 0.8668 0.7419 0.9041 tcs-har1-wls 0.9467 0.9538 0.9341 0.9356 0.9425 0.8044 0.8826 0.8426 0.7213 0.8786 tcs-ols-ols 1.2156 1.1122 1.0452 1.0300 1.0984 1.0087 0.9962 1.0024 0.858 1.0330 tcs-ols-shr 1.1411 1.0635 0.9885 0.9758 1.0402 0.9478 0.9300 0.9388 0.7931 0.9718 tcs-ols-struc 1.1940 1.0989 1.0203 1.0044 1.0768 0.9860 0.9627 0.9743 0.827 1.0078 tcs-ols-wls 1.1567 1.0767 1.0007 0.9859 1.0528 0.9620 0.9418 0.9518 0.8071 0.9848 tcs-sar1-ols 0.9788 0.9832 0.9727 0.9763 0.9778 0.8369 0.9307 0.8825 0.7610 0.9162 tcs-sar1-shr 0.9399 0.9464 0.9280 0.9301 0.9361 0.7995 0.8767 0.8372 0.7149 0.8725 tcs-sar1-struc 0.9819 0.9802 0.9568 0.9560 0.9686 0.8307 0.9054 0.8672 0.7417 0.9034 tcs-sar1-wls 0.9454 0.9522 0.9331 0.9338 0.9411 0.8049 0.8815 0.8423 0.7204 0.8776 tcs-shr-ols 0.9825 0.9866 0.9832 0.9846 0.9842 0.8367 0.9369 0.8854 0.7650 0.9211 tcs-shr-shr 0.9375 0.9368 0.9300 0.9363 0.9352 0.7905 0.8780 0.8331 0.7128 0.8704 tcs-shr-struc 0.9825 0.9789 0.9637 0.9645 0.9724 0.8262 0.9096 0.8669 0.7415 0.9052 tcs-shr-wls 0.9375 0.9410 0.9359 0.9387 0.9383 0.7927 0.8826 0.8365 0.7165 0.8737 tcs-strar1-ols 1.0736 1.031 0.9969 0.9946 1.0235 0.9021 0.9524 0.9269 0.7954 0.9597 tcs-strar1-shr 1.0269 0.9968 0.9520 0.9486 0.9805 0.8629 0.8977 0.8801 0.7471 0.9145 tcs-strar1-struc 1.0668 1.0255 0.9776 0.9729 1.0100 0.8908 0.9245 0.9075 0.7726 0.9428 tcs-strar1-wls 1.0373 1.0057 0.9600 0.9557 0.9891 0.8723 0.9058 0.8889 0.7565 0.9233 tcs-struc-ols 1.0727 1.0323 0.9980 0.9940 1.0238 0.9024 0.9526 0.9272 0.7957 0.9600 tcs-struc-struc 1.0664 1.0268 0.9786 0.9726 1.0104 0.8912 0.9249 0.9079 0.7731 0.9432 tcs-wlsh-ols 0.9774 0.9856 0.9727 0.9793 0.9787 0.8348 0.9317 0.8819 0.7612 0.9165 tcs-wlsh-struc 0.9828 0.9829 0.958 0.9585 0.9705 0.8295 0.9062 0.8670 0.7422 0.9044 tcs-wlsv-ols 0.9789 0.9832 0.9731 0.9761 0.9778 0.8367 0.9307 0.8825 0.7610 0.9162 tcs-wlsv-struc 0.9823 0.9804 0.9572 0.9561 0.9689 0.8307 0.9057 0.8674 0.7420 0.9036 ite-acov-ols 0.9727 0.9873 0.9744 0.9779 0.9781 0.8319 0.9306 0.8799 0.7600 0.9154 ite-acov-shr 0.9283 0.9398 0.9259 0.9314 0.9313 0.7893 0.8754 0.8313 0.7111 0.8675 ite-acov-struc 0.9820 0.9837 0.9593 0.9579 0.9706 0.8277 0.9055 0.8657 0.7411 0.9039 ite-acov-wls 0.9414 0.9502 0.9337 0.9364 0.9404 0.7997 0.8825 0.8401 0.7196 0.8764 ite-bu-ols 0.9713 0.9767 0.9798 0.9852 0.9782 0.8325 0.9403 0.8847 0.7659 0.9179 ite-bu-shr 0.9157 0.9270 0.9300 0.9315 0.9260 0.7824 0.8823 0.8309 0.7142 0.8651 ite-bu-struc 0.9720 0.9696 0.9655 0.9610 0.967 0.8219 0.9132 0.8663 0.7443 0.9027 ite-bu-wls 0.9271 0.9324 0.9349 0.9323 0.9317 0.7883 0.8837 0.8346 0.7182 0.8699 ite-har1-ols 0.9774 0.9857 0.9723 0.9795 0.9787 0.8351 0.9316 0.8821 0.7613 0.9166 ite-har1-shr 0.9305 0.9452 0.9240 0.9301 0.9324 0.7939 0.8750 0.8335 0.7123 0.8689 ite-har1-struc 0.9826 0.9827 0.9576 0.9582 0.9702 0.8296 0.9058 0.8668 0.7419 0.9041 ite-har1-wls 0.9428 0.9523 0.9324 0.9346 0.9405 0.8028 0.8818 0.8414 0.7204 0.8770 ite-ols-ols 1.2156 1.1122 1.0452 1.0300 1.0984 1.0087 0.9962 1.0024 0.858 1.0330 ite-ols-shr 1.1518 1.0704 0.9897 0.9751 1.0444 0.9589 0.9320 0.9454 0.7990 0.9770 ite-ols-struc 1.1940 1.0989 1.0203 1.0044 1.0768 0.9860 0.9627 0.9743 0.8270 1.0078 ite-ols-wls 1.1593 1.0771 1.0004 0.9847 1.0531 0.9646 0.9421 0.9533 0.8083 0.9856 ite-sar1-ols 0.9788 0.9832 0.9727 0.9763 0.9778 0.8369 0.9307 0.8825 0.7610 0.9162 ite-sar1-shr 0.9256 0.9424 0.9223 0.9274 0.9294 0.7936 0.8738 0.8327 0.7114 0.8669 ite-sar1-struc 0.9819 0.9802 0.9568 0.9560 0.9686 0.8307 0.9054 0.8672 0.7417 0.9034 ite-sar1-wls 0.9409 0.9500 0.9312 0.9324 0.9386 0.803 0.8807 0.8409 0.7195 0.8757 ite-shr-ols 0.9825 0.9866 0.9832 0.9846 0.9842 0.8367 0.9369 0.8854 0.7650 0.9211 ite-shr-shr 0.9277 0.9340 0.9234 0.9340 0.9298 0.7864 0.8741 0.8291 0.709 0.8656 ite-shr-struc 0.9825 0.9789 0.9637 0.9645 0.9724 0.8262 0.9096 0.8669 0.7415 0.9052 ite-shr-wls 0.9329 0.9405 0.9333 0.9380 0.9362 0.7915 0.8813 0.8352 0.7154 0.8720 ite-strar1-ols 1.0736 1.0310 0.9969 0.9946 1.0235 0.9021 0.9524 0.9269 0.7954 0.9597 ite-strar1-shr 1.0230 0.9967 0.9489 0.9467 0.9783 0.8635 0.8966 0.8799 0.7471 0.9132 ite-strar1-struc 1.0668 1.0255 0.9776 0.9729 1.0100 0.8908 0.9245 0.9075 0.7726 0.9428 ite-strar1-wls 1.0362 1.0045 0.9588 0.9547 0.9879 0.8722 0.9056 0.8888 0.7565 0.9227 ite-struc-ols 1.0727 1.0323 0.9980 0.9940 1.0238 0.9024 0.9526 0.9272 0.7957 0.9600 ite-struc-shr 1.0220 0.9975 0.9493 0.9462 0.9782 0.8635 0.8966 0.8799 0.7471 0.9132 ite-struc-struc 1.0664 1.0268 0.9786 0.9726 1.0104 0.8912 0.9249 0.9079 0.7731 0.9432 ite-struc-wls 1.0357 1.0060 0.9594 0.9544 0.9883 0.8728 0.9059 0.8892 0.757 0.9231 ite-wlsh-ols 0.9774 0.9856 0.9727 0.9793 0.9787 0.8348 0.9317 0.8819 0.7612 0.9165 ite-wlsh-shr 0.9302 0.9448 0.9242 0.9301 0.9323 0.7934 0.8751 0.8333 0.7122 0.8688 ite-wlsh-struc 0.9828 0.9829 0.958 0.9585 0.9705 0.8295 0.9062 0.8670 0.7422 0.9044 ite-wlsh-wls 0.943 0.9528 0.9328 0.9349 0.9408 0.803 0.8821 0.8417 0.7207 0.8773 ite-wlsv-ols 0.9789 0.9832 0.9731 0.9761 0.9778 0.8367 0.9307 0.8825 0.7610 0.9162 ite-wlsv-shr 0.9253 0.9420 0.9224 0.9274 0.9292 0.7932 0.8739 0.8326 0.7114 0.8668 ite-wlsv-struc 0.9823 0.9804 0.9572 0.9561 0.9689 0.8307 0.9057 0.8674 0.7420 0.9036 ite-wlsv-wls 0.9411 0.9506 0.9316 0.9326 0.9390 0.8032 0.8811 0.8412 0.7198 0.8760 Table A.12: AvgRelMSE for all 95 series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All all all all all Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 1.1165 1.0235 0.9827 0.9675 1.021 0.8968 0.9212 0.9090 0.7820 0.9507 kah-struc-wls 1.1282 1.0314 0.9894 0.9738 1.029 0.9065 0.9284 0.9174 0.7909 0.9591 kah-wlsh-shr 0.9586 0.9696 0.9727 0.9639 0.9662 0.8101 0.9139 0.8605 0.7538 0.9021 kah-wlsh-wls 0.9607 0.9721 0.9749 0.9662 0.9684 0.8135 0.9168 0.8636 0.7578 0.9050 kah-wlsv-shr 0.9684 0.9697 0.9596 0.9603 0.9645 0.8175 0.9085 0.8618 0.7518 0.9013 kah-wlsv-wls 0.9717 0.9725 0.9623 0.9627 0.9673 0.8211 0.9113 0.8650 0.7557 0.9044 tcs-acov-ols 1.2022 1.1597 1.1356 1.1189 1.1537 0.9763 1.0734 1.0237 0.9082 1.0775 tcs-acov-shr 0.9453 0.9583 0.9710 0.9626 0.9592 0.7977 0.9117 0.8528 0.7481 0.8952 tcs-acov-struc 1.1845 1.1243 1.0953 1.0755 1.1192 0.9455 1.0205 0.9823 0.8522 1.0371 tcs-acov-wls 0.9470 0.9613 0.9729 0.9657 0.9617 0.8010 0.9150 0.8561 0.7524 0.8982 tcs-bu-ols 1.2189 1.1663 1.1631 1.1510 1.1745 1.0049 1.1145 1.0583 0.9456 1.1053 tcs-bu-shr 0.9640 0.9680 0.9694 0.9733 0.9687 0.8181 0.9226 0.8688 0.7659 0.9080 tcs-bu-struc 1.1911 1.1363 1.1248 1.1049 1.1388 0.9726 1.0607 1.0157 0.8912 1.0643 tcs-bu-wls 0.9635 0.9678 0.9693 0.9733 0.9685 0.8183 0.9223 0.8687 0.7662 0.9080 tcs-har1-ols 1.2027 1.1537 1.1345 1.1192 1.1521 0.9793 1.0755 1.0263 0.9111 1.0779 tcs-har1-shr 0.9578 0.9697 0.9730 0.9642 0.9661 0.8102 0.9143 0.8607 0.7540 0.9022 tcs-har1-struc 1.1805 1.1191 1.0949 1.0747 1.1166 0.9468 1.0220 0.9837 0.8544 1.0365 tcs-har1-wls 0.9597 0.9719 0.9750 0.9664 0.9682 0.8134 0.9170 0.8636 0.7578 0.9049 tcs-ols-ols 1.5246 1.2871 1.1918 1.1415 1.2782 1.1855 1.1172 1.1508 1.0041 1.1984 tcs-ols-shr 1.2740 1.0994 1.0251 0.9932 1.0928 0.9991 0.9545 0.9765 0.8323 1.0178 tcs-ols-struc 1.4737 1.2368 1.1364 1.0908 1.2260 1.1299 1.0528 1.0907 0.9283 1.1395 tcs-ols-wls 1.2912 1.1114 1.0358 1.0026 1.1049 1.0135 0.9654 0.9891 0.8455 1.0303 tcs-sar1-ols 1.2039 1.1488 1.1281 1.1134 1.1481 0.9825 1.0727 1.0266 0.9106 1.0757 tcs-sar1-shr 0.9684 0.9697 0.9597 0.9603 0.9645 0.8175 0.9086 0.8619 0.7518 0.9013 tcs-sar1-struc 1.1777 1.1163 1.0869 1.0692 1.1118 0.9498 1.0195 0.9841 0.8538 1.0339 tcs-sar1-wls 0.9715 0.9721 0.9622 0.9627 0.9671 0.8209 0.9113 0.8649 0.7555 0.9043 tcs-shr-ols 1.2507 1.2016 1.1786 1.1390 1.1918 1.0198 1.1035 1.0608 0.9410 1.1146 tcs-shr-shr 0.9592 0.9689 0.9854 0.9810 0.9736 0.8045 0.9261 0.8632 0.7579 0.9076 tcs-shr-struc 1.2234 1.166 1.1372 1.0969 1.1550 0.9845 1.0502 1.0168 0.8810 1.0714 tcs-shr-wls 0.9573 0.9688 0.9874 0.9818 0.9738 0.8044 0.9279 0.8640 0.7597 0.9082 tcs-strar1-ols 1.3234 1.1883 1.1344 1.1053 1.1850 1.0479 1.0689 1.0583 0.9278 1.1079 tcs-strar1-shr 1.1161 1.0243 0.9836 0.9679 1.0214 0.8972 0.9219 0.9095 0.7825 0.9512 tcs-strar1-struc 1.2906 1.1503 1.0885 1.0607 1.1442 1.009 1.0135 1.0113 0.8676 1.0617 tcs-strar1-wls 1.1276 1.0318 0.9900 0.9741 1.0292 0.9066 0.9288 0.9176 0.7911 0.9593 tcs-struc-ols 1.3229 1.1874 1.1342 1.1043 1.1843 1.0470 1.0683 1.0576 0.9272 1.1073 tcs-struc-struc 1.2906 1.1497 1.0883 1.0600 1.1438 1.0086 1.0131 1.0108 0.8674 1.0613 tcs-wlsh-ols 1.2026 1.1519 1.1338 1.1182 1.1512 0.9777 1.0746 1.0250 0.9100 1.0768 tcs-wlsh-struc 1.1807 1.1182 1.0946 1.0744 1.1163 0.9459 1.0216 0.9830 0.8541 1.0361 tcs-wlsv-ols 1.2036 1.1472 1.1275 1.1125 1.1472 0.9810 1.0719 1.0254 0.9096 1.0748 tcs-wlsv-struc 1.1779 1.1154 1.0867 1.0688 1.1114 0.9491 1.0192 0.9835 0.8535 1.0335 ite-acov-ols 1.2022 1.1597 1.1356 1.1189 1.1537 0.9763 1.0734 1.0237 0.9082 1.0775 ite-acov-shr 0.9398 0.9583 0.9709 0.9653 0.9585 0.7957 0.9127 0.8522 0.7476 0.8945 ite-acov-struc 1.1845 1.1243 1.0953 1.0755 1.1192 0.9455 1.0205 0.9823 0.8522 1.0371 ite-acov-wls 0.9459 0.9632 0.9734 0.9674 0.9624 0.8013 0.9163 0.8569 0.7528 0.8989 ite-bu-ols 1.2189 1.1663 1.1631 1.1510 1.1745 1.0049 1.1145 1.0583 0.9456 1.1053 ite-bu-shr 0.9583 0.9701 0.9757 0.9824 0.9716 0.8191 0.9356 0.8754 0.7757 0.9132 ite-bu-struc 1.1911 1.1363 1.1248 1.1049 1.1388 0.9726 1.0607 1.0157 0.8912 1.0643 ite-bu-wls 0.9619 0.9698 0.9730 0.9778 0.9706 0.8200 0.9293 0.8730 0.7735 0.9116 ite-har1-ols 1.2027 1.1537 1.1345 1.1192 1.1521 0.9793 1.0755 1.0263 0.9111 1.0779 ite-har1-shr 0.9504 0.9690 0.9727 0.9657 0.9644 0.8076 0.9151 0.8597 0.7535 0.9009 ite-har1-struc 1.1805 1.1191 1.0949 1.0747 1.1166 0.9468 1.0220 0.9837 0.8544 1.0365 ite-har1-wls 0.9565 0.9723 0.9754 0.9674 0.9679 0.8125 0.9182 0.8637 0.7582 0.9048 ite-ols-ols 1.5246 1.2871 1.1918 1.1415 1.2782 1.1855 1.1172 1.1508 1.0041 1.1984 ite-ols-shr 1.286 1.1022 1.0254 0.9913 1.0956 1.0063 0.9545 0.9801 0.8345 1.0208 ite-ols-struc 1.4737 1.2368 1.1364 1.0908 1.2260 1.1299 1.0528 1.0907 0.9283 1.1395 ite-ols-wls 1.2947 1.1111 1.0353 1.0014 1.1051 1.0149 0.9653 0.9898 0.8449 1.0306 ite-sar1-ols 1.2039 1.1488 1.1281 1.1134 1.1481 0.9825 1.0727 1.0266 0.9106 1.0757 ite-sar1-shr 0.9613 0.9683 0.9588 0.9605 0.9622 0.8151 0.9092 0.8609 0.7514 0.8997 ite-sar1-struc 1.1777 1.1163 1.0869 1.0692 1.1118 0.9498 1.0195 0.9841 0.8538 1.0339 ite-sar1-wls 0.9690 0.9715 0.9622 0.9631 0.9664 0.8202 0.9125 0.8651 0.7561 0.9041 ite-shr-ols 1.2507 1.2016 1.1786 1.1390 1.1918 1.0198 1.1035 1.0608 0.9410 1.1146 ite-shr-shr 0.9612 0.9747 0.9884 0.9834 0.9769 0.8088 0.9282 0.8664 0.7597 0.9107 ite-shr-struc 1.2234 1.1660 1.1372 1.0969 1.1550 0.9845 1.0502 1.0168 0.8810 1.0714 ite-shr-wls 0.9580 0.9738 0.9896 0.9832 0.9761 0.8074 0.9299 0.8665 0.7611 0.9105 ite-strar1-ols 1.3234 1.1883 1.1344 1.1053 1.1850 1.0479 1.0689 1.0583 0.9278 1.1079 ite-strar1-shr 1.1178 1.0235 0.9823 0.9666 1.0209 0.8980 0.9215 0.9097 0.7825 0.9510 ite-strar1-struc 1.2906 1.1503 1.0885 1.0607 1.1442 1.009 1.0135 1.0113 0.8676 1.0617 ite-strar1-wls 1.1283 1.0306 0.9891 0.9734 1.0286 0.9065 0.9289 0.9176 0.7911 0.9590 ite-struc-ols 1.3229 1.1874 1.1342 1.1043 1.1843 1.047 1.0683 1.0576 0.9272 1.1073 ite-struc-shr 1.1178 1.0227 0.9815 0.9661 1.0204 0.8975 0.9210 0.9091 0.7820 0.9505 ite-struc-struc 1.2906 1.1497 1.0883 1.0600 1.1438 1.0086 1.0131 1.0108 0.8674 1.0613 ite-struc-wls 1.1289 1.0304 0.9885 0.9730 1.0284 0.9065 0.9285 0.9174 0.7909 0.9588 ite-wlsh-ols 1.2026 1.1519 1.1338 1.1182 1.1512 0.9777 1.0746 1.0250 0.9100 1.0768 ite-wlsh-shr 0.9510 0.9686 0.9725 0.9653 0.9643 0.8073 0.9147 0.8593 0.7531 0.9007 ite-wlsh-struc 1.1807 1.1182 1.0946 1.0744 1.1163 0.9459 1.0216 0.9830 0.8541 1.0361 ite-wlsh-wls 0.9574 0.9725 0.9753 0.9672 0.9681 0.8127 0.9179 0.8637 0.7582 0.9049 ite-wlsv-ols 1.2036 1.1472 1.1275 1.1125 1.1472 0.9810 1.0719 1.0254 0.9096 1.0748 ite-wlsv-shr 0.9611 0.9680 0.9587 0.9604 0.9620 0.8148 0.9091 0.8606 0.7512 0.8995 ite-wlsv-struc 1.1779 1.1154 1.0867 1.0688 1.1114 0.9491 1.0192 0.9835 0.8535 1.0335 ite-wlsv-wls 0.9692 0.9719 0.9622 0.9631 0.9666 0.8203 0.9125 0.8652 0.7562 0.9042 Table A.13: AvgRelMAE for the 63 bottom series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All bts bts bts bts Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 1.0858 1.0187 1.0046 0.9918 1.0246 0.9603 0.9669 0.9636 0.8928 0.9872 kah-struc-wls 1.092 1.0238 1.0082 0.9957 1.0293 0.9665 0.9716 0.9690 0.8991 0.9923 kah-wlsh-shr 0.9833 0.9884 0.9960 0.9861 0.9884 0.9054 0.9598 0.9322 0.8717 0.9548 kah-wlsh-wls 0.9840 0.9895 0.9969 0.9882 0.9897 0.9072 0.9622 0.9343 0.8747 0.9565 kah-wlsv-shr 0.9930 0.9888 0.9875 0.9844 0.9884 0.9115 0.9559 0.9334 0.8703 0.9549 kah-wlsv-wls 0.9949 0.9906 0.9887 0.9863 0.9901 0.9137 0.9582 0.9357 0.8733 0.9569 tcs-acov-ols 1.1773 1.1274 1.1123 1.0935 1.1272 1.0369 1.0682 1.0525 0.9922 1.0853 tcs-acov-shr 0.9751 0.9807 0.9953 0.9859 0.9842 0.8957 0.9582 0.9265 0.8680 0.9502 tcs-acov-struc 1.1558 1.0964 1.0830 1.0631 1.0991 1.0106 1.0329 1.0217 0.9488 1.0540 tcs-acov-wls 0.9756 0.9820 0.9962 0.9886 0.9856 0.8972 0.9607 0.9284 0.8713 0.9520 tcs-bu-ols 1.1922 1.1373 1.1313 1.1183 1.1444 1.0589 1.100 1.0792 1.0212 1.1072 tcs-bu-shr 0.9934 0.9921 0.9939 0.9939 0.9933 0.9146 0.9657 0.9398 0.8814 0.9612 tcs-bu-struc 1.1647 1.1111 1.1009 1.0842 1.1148 1.0333 1.0615 1.0473 0.9774 1.0747 tcs-bu-wls 0.9918 0.9911 0.9935 0.9949 0.9928 0.9141 0.9663 0.9398 0.8816 0.9609 tcs-har1-ols 1.1751 1.1244 1.1108 1.0933 1.1255 1.0387 1.0703 1.0544 0.9942 1.0853 tcs-har1-shr 0.9827 0.9886 0.9961 0.9862 0.9884 0.9056 0.9600 0.9324 0.8718 0.9548 tcs-har1-struc 1.1501 1.0937 1.0816 1.0630 1.0966 1.0104 1.0348 1.0225 0.9500 1.0531 tcs-har1-wls 0.9833 0.9897 0.9970 0.9884 0.9896 0.9074 0.9624 0.9345 0.8749 0.9565 tcs-ols-ols 1.3301 1.1831 1.1399 1.0992 1.1850 1.1405 1.0880 1.1139 1.0419 1.1430 tcs-ols-shr 1.1678 1.0611 1.0312 1.0070 1.0650 1.0194 0.9877 1.0034 0.9239 1.0260 tcs-ols-struc 1.2967 1.1489 1.1052 1.0676 1.1514 1.1045 1.049 1.0764 0.9922 1.1057 tcs-ols-wls 1.1774 1.0673 1.0362 1.0124 1.0716 1.0273 0.9938 1.0104 0.9322 1.0330 tcs-sar1-ols 1.1759 1.1220 1.1060 1.0914 1.1234 1.0402 1.0684 1.0542 0.9939 1.0840 tcs-sar1-shr 0.9930 0.9891 0.9875 0.9844 0.9885 0.9117 0.9559 0.9335 0.8704 0.9550 tcs-sar1-struc 1.1516 1.0929 1.0761 1.0605 1.0947 1.0123 1.0330 1.0226 0.9497 1.0520 tcs-sar1-wls 0.9947 0.9908 0.9886 0.9863 0.9901 0.9138 0.9582 0.9357 0.8733 0.9569 tcs-shr-ols 1.2098 1.1593 1.1377 1.1055 1.1525 1.0714 1.0884 1.0799 1.0161 1.1111 tcs-shr-shr 0.9854 0.9883 1.0015 0.9954 0.9926 0.9015 0.9664 0.9334 0.8720 0.9574 tcs-shr-struc 1.1808 1.1267 1.1050 1.0757 1.1214 1.0403 1.0513 1.0458 0.9676 1.0763 tcs-shr-wls 0.9828 0.9867 1.0021 0.9965 0.9920 0.9007 0.9683 0.9339 0.8741 0.9576 tcs-strar1-ols 1.2352 1.1351 1.1060 1.0815 1.1380 1.0681 1.0623 1.0652 0.9987 1.0961 tcs-strar1-shr 1.0852 1.0195 1.0055 0.9920 1.0250 0.9606 0.9674 0.9640 0.8934 0.9876 tcs-strar1-struc 1.2088 1.1065 1.0768 1.0526 1.1096 1.0406 1.0279 1.0342 0.9566 1.0647 tcs-strar1-wls 1.0916 1.0245 1.0089 0.9959 1.0296 0.9668 0.9720 0.9694 0.8994 0.9927 tcs-struc-ols 1.2344 1.1341 1.1058 1.0811 1.1374 1.0672 1.0619 1.0645 0.9983 1.0955 tcs-struc-struc 1.2084 1.1061 1.0763 1.0521 1.1092 1.0398 1.0277 1.0337 0.9565 1.0643 tcs-wlsh-ols 1.1747 1.1229 1.1101 1.0928 1.1247 1.0370 1.0696 1.0532 0.9934 1.0844 tcs-wlsh-struc 1.1500 1.0931 1.0812 1.0627 1.0963 1.0097 1.0344 1.0220 0.9499 1.0527 tcs-wlsv-ols 1.1752 1.1203 1.1054 1.0909 1.1225 1.0384 1.0679 1.0530 0.9931 1.0831 tcs-wlsv-struc 1.1512 1.0921 1.0759 1.0602 1.0943 1.0118 1.0328 1.0222 0.9495 1.0517 ite-acov-ols 1.1773 1.1274 1.1123 1.0935 1.1272 1.0369 1.0682 1.0525 0.9922 1.0853 ite-acov-shr 0.9746 0.9819 0.9963 0.9878 0.9851 0.8965 0.9597 0.9276 0.8677 0.9509 ite-acov-struc 1.1558 1.0964 1.0830 1.0631 1.0991 1.0106 1.0329 1.0217 0.9488 1.0540 ite-acov-wls 0.9758 0.9839 0.9972 0.9905 0.9868 0.8980 0.9620 0.9295 0.8715 0.9530 ite-bu-ols 1.1922 1.1373 1.1313 1.1183 1.1444 1.0589 1.100 1.0792 1.0212 1.1072 ite-bu-shr 0.9917 0.9953 1.0002 1.0018 0.9972 0.9175 0.9763 0.9464 0.8922 0.9669 ite-bu-struc 1.1647 1.1111 1.1009 1.0842 1.1148 1.0333 1.0615 1.0473 0.9774 1.0747 ite-bu-wls 0.9913 0.9936 0.9971 0.9996 0.9954 0.9162 0.9721 0.9438 0.8885 0.9646 ite-har1-ols 1.1751 1.1244 1.1108 1.0933 1.1255 1.0387 1.0703 1.0544 0.9942 1.0853 ite-har1-shr 0.9794 0.9880 0.9967 0.9874 0.9878 0.9053 0.9610 0.9327 0.8715 0.9545 ite-har1-struc 1.1501 1.0937 1.0816 1.0630 1.0966 1.0104 1.0348 1.0225 0.9500 1.0531 ite-har1-wls 0.9806 0.9901 0.9978 0.9898 0.9896 0.9070 0.9633 0.9348 0.8749 0.9566 ite-ols-ols 1.3301 1.1831 1.1399 1.0992 1.1850 1.1405 1.0880 1.1139 1.0419 1.1430 ite-ols-shr 1.1712 1.0600 1.0301 1.0057 1.0649 1.0218 0.9868 1.0041 0.9234 1.0261 ite-ols-struc 1.2967 1.1489 1.1052 1.0676 1.1514 1.1045 1.049 1.0764 0.9922 1.1057 ite-ols-wls 1.1782 1.0661 1.0356 1.0120 1.0711 1.0279 0.9937 1.0107 0.9307 1.0326 ite-sar1-ols 1.1759 1.1220 1.1060 1.0914 1.1234 1.0402 1.0684 1.0542 0.9939 1.0840 ite-sar1-shr 0.9897 0.9879 0.9869 0.9844 0.9872 0.9109 0.9569 0.9336 0.8700 0.9542 ite-sar1-struc 1.1516 1.0929 1.0761 1.0605 1.0947 1.0123 1.0330 1.0226 0.9497 1.0520 ite-sar1-wls 0.9927 0.9903 0.9887 0.9870 0.9897 0.9134 0.9591 0.9360 0.8733 0.9568 ite-shr-ols 1.2098 1.1593 1.1377 1.1055 1.1525 1.0714 1.0884 1.0799 1.0161 1.1111 ite-shr-shr 0.9895 0.9931 1.0057 0.9976 0.9965 0.9075 0.9691 0.9378 0.8735 0.9611 ite-shr-struc 1.1808 1.1267 1.1050 1.0757 1.1214 1.0403 1.0513 1.0458 0.9676 1.0763 ite-shr-wls 0.9831 0.9915 1.0049 0.9980 0.9943 0.9036 0.9700 0.9362 0.8746 0.9596 ite-strar1-ols 1.2352 1.1351 1.1060 1.0815 1.1380 1.0681 1.0623 1.0652 0.9987 1.0961 ite-strar1-shr 1.0854 1.0180 1.0047 0.9915 1.0243 0.9607 0.9676 0.9641 0.8934 0.9872 ite-strar1-struc 1.2088 1.1065 1.0768 1.0526 1.1096 1.0406 1.0279 1.0342 0.9566 1.0647 ite-strar1-wls 1.0919 1.0236 1.0085 0.9957 1.0293 0.9667 0.9723 0.9695 0.8994 0.9925 ite-struc-ols 1.2344 1.1341 1.1058 1.0811 1.1374 1.0672 1.0619 1.0645 0.9983 1.0955 ite-struc-shr 1.0856 1.0172 1.0038 0.9913 1.0239 0.9603 0.9671 0.9637 0.8928 0.9868 ite-struc-struc 1.2084 1.1061 1.0763 1.0521 1.1092 1.0398 1.0277 1.0337 0.9565 1.0643 ite-struc-wls 1.0923 1.0228 1.0078 0.9955 1.029 0.9664 0.9719 0.9692 0.8991 0.9922 ite-wlsh-ols 1.1747 1.1229 1.1101 1.0928 1.1247 1.037 1.0696 1.0532 0.9934 1.0844 ite-wlsh-shr 0.9801 0.9877 0.9966 0.9872 0.9879 0.9051 0.9607 0.9325 0.8713 0.9544 ite-wlsh-struc 1.1500 1.0931 1.0812 1.0627 1.0963 1.0097 1.0344 1.0220 0.9499 1.0527 ite-wlsh-wls 0.9815 0.9899 0.9979 0.9897 0.9897 0.9069 0.9632 0.9346 0.8747 0.9566 ite-wlsv-ols 1.1752 1.1203 1.1054 1.0909 1.1225 1.0384 1.0679 1.053 0.9931 1.0831 ite-wlsv-shr 0.9898 0.9874 0.9869 0.9844 0.9871 0.9106 0.9568 0.9334 0.8699 0.9541 ite-wlsv-struc 1.1512 1.0921 1.0759 1.0602 1.0943 1.0118 1.0328 1.0222 0.9495 1.0517 ite-wlsv-wls 0.9929 0.9901 0.9888 0.9870 0.9897 0.9133 0.9591 0.9360 0.8732 0.9568 Table A.14: AvgRelMAE for the 32 upper series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All bts bts bts bts Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 0.9972 0.9988 0.9846 0.9842 0.9912 0.9266 0.9447 0.9356 0.8599 0.9554 kah-struc-wls 1.0058 1.0070 0.9925 0.9938 0.9998 0.9351 0.9555 0.9452 0.8718 0.9648 kah-wlsh-shr 0.9584 0.9711 0.9655 0.9697 0.9662 0.8909 0.9271 0.9088 0.8322 0.9294 kah-wlsh-wls 0.9644 0.9777 0.9727 0.9775 0.9731 0.8969 0.9356 0.9160 0.8418 0.9368 kah-wlsv-shr 0.9538 0.9713 0.9646 0.9685 0.9645 0.8912 0.9265 0.9087 0.8319 0.9284 kah-wlsv-wls 0.9610 0.9780 0.9724 0.9763 0.9719 0.8975 0.9347 0.9160 0.8414 0.9361 tcs-acov-ols 0.9798 0.9938 0.9886 0.9891 0.9878 0.9113 0.9531 0.9319 0.8571 0.9520 tcs-acov-shr 0.9595 0.9679 0.9655 0.9700 0.9657 0.8895 0.9269 0.9080 0.8314 0.9288 tcs-acov-struc 0.9850 0.9926 0.9848 0.9888 0.9878 0.9113 0.9482 0.9296 0.8524 0.9506 tcs-acov-wls 0.9656 0.9752 0.9729 0.9782 0.9730 0.8956 0.9356 0.9154 0.8409 0.9364 tcs-bu-ols 0.9820 0.9878 0.9875 0.9852 0.9856 0.9104 0.9522 0.9311 0.8570 0.9505 tcs-bu-shr 0.9541 0.9618 0.9611 0.9640 0.9603 0.8834 0.9226 0.9028 0.8257 0.9233 tcs-bu-struc 0.9821 0.9876 0.9840 0.9849 0.9846 0.9082 0.9465 0.9271 0.8491 0.9476 tcs-bu-wls 0.9588 0.9682 0.9677 0.9704 0.9663 0.8887 0.9297 0.9090 0.8334 0.9297 tcs-har1-ols 0.9806 0.9937 0.9884 0.9892 0.9880 0.9125 0.9537 0.9329 0.8578 0.9525 tcs-har1-shr 0.9584 0.9710 0.9652 0.9696 0.9661 0.8910 0.9270 0.9088 0.8321 0.9293 tcs-har1-struc 0.9816 0.9930 0.9844 0.9882 0.9868 0.9122 0.9482 0.9300 0.853 0.9502 tcs-har1-wls 0.9643 0.9773 0.9724 0.9773 0.9728 0.8969 0.9351 0.9158 0.8414 0.9366 tcs-ols-ols 1.0857 1.0534 1.0331 1.0249 1.0491 1.0027 0.9971 0.9999 0.9226 1.0159 tcs-ols-shr 1.0498 1.0321 1.0073 1.0025 1.0227 0.9725 0.9664 0.9695 0.8934 0.9880 tcs-ols-struc 1.0772 1.0535 1.0276 1.0205 1.0445 0.9935 0.9912 0.9923 0.9169 1.0103 tcs-ols-wls 1.0616 1.0427 1.0171 1.0137 1.0336 0.9827 0.9791 0.9809 0.9067 0.9994 tcs-sar1-ols 0.9793 0.9913 0.9877 0.9875 0.9864 0.9129 0.9529 0.9327 0.8576 0.9516 tcs-sar1-shr 0.9539 0.9711 0.9643 0.9684 0.9644 0.8913 0.9263 0.9086 0.8318 0.9283 tcs-sar1-struc 0.9790 0.9928 0.9840 0.9873 0.9858 0.9119 0.9483 0.9299 0.8529 0.9496 tcs-sar1-wls 0.9610 0.9776 0.9720 0.9760 0.9716 0.8975 0.9344 0.9157 0.8410 0.9358 tcs-shr-ols 0.9926 0.9919 0.9878 0.9907 0.9907 0.9134 0.9526 0.9328 0.8569 0.9538 tcs-shr-shr 0.9617 0.9623 0.9588 0.9699 0.9632 0.8836 0.9240 0.9036 0.8249 0.9250 tcs-shr-struc 0.9913 0.9900 0.9837 0.9911 0.9890 0.9101 0.9486 0.9291 0.8487 0.9505 tcs-shr-wls 0.9638 0.9688 0.9676 0.9775 0.9694 0.8882 0.9327 0.9102 0.8331 0.9317 tcs-strar1-ols 1.0214 1.0151 1.0039 1.0034 1.0109 0.9469 0.9693 0.958 0.8837 0.9766 tcs-strar1-shr 0.9975 0.9983 0.9843 0.9844 0.9911 0.9267 0.9446 0.9356 0.8598 0.9553 tcs-strar1-struc 1.0173 1.0161 1.0006 1.0003 1.0085 0.9431 0.9647 0.9538 0.8793 0.9733 tcs-strar1-wls 1.0060 1.0062 0.9919 0.9939 0.9995 0.9350 0.9551 0.945 0.8714 0.9645 tcs-struc-ols 1.0209 1.0163 1.0046 1.0032 1.0112 0.9473 0.9697 0.9584 0.8841 0.9769 tcs-struc-struc 1.0170 1.0171 1.0013 1.0003 1.0089 0.9433 0.9651 0.9541 0.8800 0.9737 tcs-wlsh-ols 0.9805 0.9940 0.9888 0.9893 0.9881 0.9124 0.9541 0.9330 0.8581 0.9527 tcs-wlsh-struc 0.9817 0.9934 0.9848 0.9885 0.9871 0.9121 0.9487 0.9302 0.8534 0.9505 tcs-wlsv-ols 0.9792 0.9918 0.9881 0.9875 0.9866 0.9103 0.9532 0.9329 0.8579 0.9518 tcs-wlsv-struc 0.9790 0.9930 0.9845 0.9874 0.9860 0.9118 0.9488 0.9301 0.8533 0.9499 ite-acov-ols 0.9798 0.9938 0.9886 0.9891 0.9878 0.9113 0.9531 0.9319 0.8571 0.9520 ite-acov-shr 0.9528 0.9674 0.9627 0.9684 0.9628 0.8879 0.9257 0.9066 0.8297 0.9265 ite-acov-struc 0.9850 0.9926 0.9848 0.9888 0.9878 0.9113 0.9482 0.9296 0.8524 0.9506 ite-acov-wls 0.9640 0.9750 0.9720 0.9778 0.9722 0.8950 0.9349 0.9147 0.8399 0.9357 ite-bu-ols 0.9820 0.9878 0.9875 0.9852 0.9856 0.9104 0.9522 0.9311 0.857 0.9505 ite-bu-shr 0.9484 0.9628 0.9595 0.9652 0.9590 0.8844 0.9234 0.9037 0.8259 0.9229 ite-bu-struc 0.9821 0.9876 0.9840 0.9849 0.9846 0.9082 0.9465 0.9271 0.8491 0.9476 ite-bu-wls 0.9562 0.9673 0.9664 0.9692 0.9648 0.8875 0.9283 0.9077 0.8323 0.9283 ite-har1-ols 0.9806 0.9937 0.9884 0.9892 0.9880 0.9125 0.9537 0.9329 0.8578 0.9525 ite-har1-shr 0.9517 0.9712 0.9624 0.9681 0.9633 0.8901 0.9257 0.9078 0.8305 0.9273 ite-har1-struc 0.9816 0.9930 0.9844 0.9882 0.9868 0.9122 0.9482 0.9300 0.853 0.9502 ite-har1-wls 0.9621 0.9770 0.9714 0.9768 0.9718 0.8965 0.9345 0.9153 0.8405 0.9357 ite-ols-ols 1.0857 1.0534 1.0331 1.0249 1.0491 1.0027 0.9971 0.9999 0.9226 1.0159 ite-ols-shr 1.0534 1.0362 1.0083 1.0026 1.0249 0.9781 0.9685 0.9733 0.8972 0.9909 ite-ols-struc 1.0772 1.0535 1.0276 1.0205 1.0445 0.9935 0.9912 0.9923 0.9169 1.0103 ite-ols-wls 1.0629 1.0435 1.0175 1.0135 1.0342 0.9851 0.9803 0.9827 0.9084 1.0005 ite-sar1-ols 0.9793 0.9913 0.9877 0.9875 0.9864 0.9129 0.9529 0.9327 0.8576 0.9516 ite-sar1-shr 0.9469 0.9704 0.9611 0.9665 0.9612 0.8901 0.9246 0.9072 0.8300 0.9258 ite-sar1-struc 0.9790 0.9928 0.9840 0.9873 0.9858 0.9119 0.9483 0.9299 0.8529 0.9496 ite-sar1-wls 0.9589 0.9770 0.9708 0.9750 0.9704 0.8970 0.9335 0.9151 0.8400 0.9348 ite-shr-ols 0.9926 0.9919 0.9878 0.9907 0.9907 0.9134 0.9526 0.9328 0.8569 0.9538 ite-shr-shr 0.9585 0.9624 0.9562 0.9684 0.9614 0.8838 0.9221 0.9028 0.8229 0.9235 ite-shr-struc 0.9913 0.9900 0.9837 0.9911 0.9890 0.9101 0.9486 0.9291 0.8487 0.9505 ite-shr-wls 0.9615 0.9690 0.9657 0.9772 0.9683 0.8874 0.9319 0.9094 0.8314 0.9306 ite-strar1-ols 1.0214 1.0151 1.0039 1.0034 1.0109 0.9469 0.9693 0.9580 0.8837 0.9766 ite-strar1-shr 0.9946 0.9986 0.9823 0.9829 0.9896 0.9270 0.9441 0.9355 0.8598 0.9545 ite-strar1-struc 1.0173 1.0161 1.0006 1.0003 1.0085 0.9431 0.9647 0.9538 0.8793 0.9733 ite-strar1-wls 1.0055 1.0056 0.9915 0.9932 0.9990 0.9352 0.9550 0.9451 0.8714 0.9642 ite-struc-ols 1.0209 1.0163 1.0046 1.0032 1.0112 0.9473 0.9697 0.9584 0.8841 0.9769 ite-struc-shr 0.9941 0.999 0.9829 0.9827 0.9896 0.9267 0.9442 0.9354 0.8599 0.9545 ite-struc-struc 1.0170 1.0171 1.0013 1.0003 1.0089 0.9433 0.9651 0.9541 0.8800 0.9737 ite-struc-wls 1.0054 1.0065 0.9922 0.9932 0.9993 0.9353 0.9554 0.9453 0.8718 0.9646 ite-wlsh-ols 0.9805 0.9940 0.9888 0.9893 0.9881 0.9124 0.9541 0.9330 0.8581 0.9527 ite-wlsh-shr 0.9515 0.9709 0.9627 0.9681 0.9633 0.8897 0.9258 0.9076 0.8304 0.9272 ite-wlsh-struc 0.9817 0.9934 0.9848 0.9885 0.9871 0.9121 0.9487 0.9302 0.8534 0.9505 ite-wlsh-wls 0.9621 0.9773 0.9717 0.9770 0.9720 0.8964 0.9349 0.9155 0.8409 0.9359 ite-wlsv-ols 0.9792 0.9918 0.9881 0.9875 0.9866 0.9130 0.9532 0.9329 0.8579 0.9518 ite-wlsv-shr 0.9466 0.9700 0.9614 0.9665 0.9611 0.8897 0.9247 0.9071 0.8299 0.9257 ite-wlsv-struc 0.9790 0.9930 0.9845 0.9874 0.9860 0.9118 0.9488 0.9301 0.8533 0.9499 ite-wlsv-wls 0.9589 0.9773 0.9712 0.9752 0.9706 0.8969 0.9339 0.9152 0.8404 0.9350 Table A.15: AvgRelMAE for the 95 series at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All all all all all Procedure 1 2 3 4 1-4 1 2 1-2 1 base 1 1 1 1 1 1 1 1 1 1 kah-struc-shr 1.0551 1.0120 0.9978 0.9893 1.0132 0.9488 0.9593 0.954 0.8816 0.9763 kah-struc-wls 1.0622 1.0181 1.0029 0.9951 1.0192 0.9558 0.9661 0.9610 0.8898 0.9830 kah-wlsh-shr 0.9749 0.9826 0.9856 0.9805 0.9809 0.9005 0.9487 0.9243 0.8582 0.9461 kah-wlsh-wls 0.9774 0.9855 0.9887 0.9846 0.9840 0.9038 0.9532 0.9281 0.8635 0.9498 kah-wlsv-shr 0.9796 0.9829 0.9797 0.9790 0.9803 0.9046 0.9459 0.9250 0.8572 0.9459 kah-wlsv-wls 0.9833 0.9863 0.9832 0.9829 0.9839 0.9082 0.9502 0.9290 0.8624 0.9499 tcs-acov-ols 1.1067 1.0805 1.0690 1.0571 1.0782 0.9928 1.028 1.0102 0.9444 1.0385 tcs-acov-shr 0.9698 0.9764 0.9852 0.9805 0.9780 0.8936 0.9476 0.9202 0.8555 0.9429 tcs-acov-struc 1.0952 1.0603 1.0489 1.0375 1.0603 0.9760 1.0036 0.9897 0.9152 1.0180 tcs-acov-wls 0.9723 0.9797 0.9883 0.9851 0.9813 0.8967 0.9522 0.9240 0.8609 0.9467 tcs-bu-ols 1.1168 1.0846 1.0806 1.0716 1.0883 1.0064 1.0478 1.0269 0.9626 1.0518 tcs-bu-shr 0.9800 0.9818 0.9827 0.9837 0.9821 0.9040 0.9510 0.9272 0.8622 0.9483 tcs-bu-struc 1.0997 1.0679 1.0600 1.0497 1.0692 0.9893 1.0213 1.0052 0.9322 1.0301 tcs-bu-wls 0.9805 0.9833 0.9847 0.9866 0.9838 0.9055 0.9538 0.9293 0.8650 0.9503 tcs-har1-ols 1.1056 1.0786 1.0680 1.0571 1.0772 0.9944 1.0295 1.0118 0.9460 1.0386 tcs-har1-shr 0.9745 0.9826 0.9856 0.9806 0.9808 0.9007 0.9488 0.9244 0.8583 0.9461 tcs-har1-struc 1.0903 1.0587 1.0478 1.0372 1.0583 0.9762 1.0048 0.9904 0.9162 1.0173 tcs-har1-wls 0.9768 0.9855 0.9886 0.9847 0.9839 0.9038 0.9531 0.9282 0.8634 0.9497 tcs-ols-ols 1.2422 1.1377 1.1027 1.0736 1.1373 1.0921 1.0565 1.0741 1.0001 1.0985 tcs-ols-shr 1.1267 1.0512 1.0231 1.0055 1.0506 1.0034 0.9805 0.9919 0.9135 1.0130 tcs-ols-struc 1.2181 1.1158 1.0785 1.0515 1.1142 1.0658 1.0292 1.0473 0.9662 1.0726 tcs-ols-wls 1.137 1.0590 1.0298 1.0129 1.0586 1.0121 0.9888 1.0004 0.9235 1.0215 tcs-sar1-ols 1.1056 1.0762 1.0646 1.0552 1.0752 0.9954 1.028 1.0116 0.9457 1.0375 tcs-sar1-shr 0.9797 0.9830 0.9796 0.9790 0.9803 0.9048 0.9459 0.9251 0.8572 0.9459 tcs-sar1-struc 1.0903 1.0581 1.0441 1.0353 1.0567 0.9773 1.0037 0.9904 0.9159 1.0164 tcs-sar1-wls 0.9832 0.9864 0.9830 0.9828 0.9839 0.9082 0.9501 0.9289 0.8623 0.9498 tcs-shr-ols 1.1318 1.100 1.0848 1.0654 1.0952 1.0153 1.0407 1.0279 0.9594 1.0554 tcs-shr-shr 0.9773 0.9795 0.9869 0.9867 0.9826 0.8954 0.9519 0.9232 0.8558 0.9464 tcs-shr-struc 1.1133 1.0787 1.0626 1.0464 1.0749 0.9945 1.0155 1.0049 0.9258 1.0322 tcs-shr-wls 0.9763 0.9807 0.9904 0.9901 0.9843 0.8965 0.9561 0.9258 0.8601 0.9488 tcs-strar1-ols 1.1586 1.0932 1.0705 1.0546 1.0935 1.0256 1.0300 1.0278 0.9584 1.0543 tcs-strar1-shr 1.0549 1.0123 0.9983 0.9894 1.0134 0.9491 0.9596 0.9543 0.8819 0.9766 tcs-strar1-struc 1.1406 1.0752 1.0505 1.0347 1.0745 1.0067 1.0062 1.0064 0.9299 1.0330 tcs-strar1-wls 1.0620 1.0183 1.0031 0.9952 1.0193 0.9560 0.9662 0.9611 0.8899 0.9831 tcs-struc-ols 1.1579 1.0929 1.0707 1.0542 1.0932 1.0252 1.0299 1.0275 0.9583 1.0540 tcs-struc-struc 1.1402 1.0753 1.0504 1.0343 1.0743 1.0062 1.0062 1.0062 0.9300 1.0329 tcs-wlsh-ols 1.1053 1.0777 1.0677 1.0568 1.0767 0.9932 1.0292 1.0111 0.9456 1.0381 tcs-wlsh-struc 1.0903 1.0585 1.0477 1.0371 1.0582 0.9757 1.0047 0.9901 0.9162 1.0171 tcs-wlsv-ols 1.1052 1.0752 1.0644 1.0549 1.0748 0.9943 1.0278 1.0109 0.9453 1.0369 tcs-wlsv-struc 1.0901 1.0576 1.0442 1.0351 1.0566 0.9770 1.0037 0.9902 0.9160 1.0162 ite-acov-ols 1.1067 1.0805 1.0690 1.0571 1.0782 0.9928 1.028 1.0102 0.9444 1.0385 ite-acov-shr 0.9672 0.9770 0.9849 0.9812 0.9776 0.8936 0.9481 0.9205 0.8547 0.9426 ite-acov-struc 1.0952 1.0603 1.0489 1.0375 1.0603 0.9760 1.0036 0.9897 0.9152 1.0180 ite-acov-wls 0.9718 0.9809 0.9887 0.9862 0.9819 0.8970 0.9528 0.9245 0.8607 0.9471 ite-bu-ols 1.1168 1.0846 1.0806 1.0716 1.0883 1.0064 1.0478 1.0269 0.9626 1.0518 ite-bu-shr 0.9769 0.9842 0.9863 0.9893 0.9842 0.9062 0.9581 0.9318 0.8693 0.9519 ite-bu-struc 1.0997 1.0679 1.0600 1.0497 1.0692 0.9893 1.0213 1.0052 0.9322 1.0301 ite-bu-wls 0.9793 0.9846 0.9866 0.9893 0.9850 0.9065 0.9572 0.9315 0.8692 0.9522 ite-har1-ols 1.1056 1.0786 1.0680 1.0571 1.0772 0.9944 1.0295 1.0118 0.9460 1.0386 ite-har1-shr 0.9700 0.9823 0.9850 0.9808 0.9795 0.9002 0.9489 0.9242 0.8575 0.9453 ite-har1-struc 1.0903 1.0587 1.0478 1.0372 1.0583 0.9762 1.0048 0.9904 0.9162 1.0173 ite-har1-wls 0.9743 0.9856 0.9889 0.9854 0.9835 0.9035 0.9535 0.9282 0.8631 0.9495 ite-ols-ols 1.2422 1.1377 1.1027 1.0736 1.1373 1.0921 1.0565 1.0741 1.0001 1.0985 ite-ols-shr 1.1301 1.0519 1.0227 1.0047 1.0513 1.0068 0.9806 0.9936 0.9145 1.0141 ite-ols-struc 1.2181 1.1158 1.0785 1.0515 1.1142 1.0658 1.0292 1.0473 0.9662 1.0726 ite-ols-wls 1.1380 1.0584 1.0295 1.0125 1.0585 1.0133 0.9892 1.0012 0.9231 1.0216 ite-sar1-ols 1.1056 1.0762 1.0646 1.0552 1.0752 0.9954 1.028 1.0116 0.9457 1.0375 ite-sar1-shr 0.9751 0.9819 0.9781 0.9784 0.9784 0.9038 0.9459 0.9246 0.8563 0.9445 ite-sar1-struc 1.0903 1.0581 1.0441 1.0353 1.0567 0.9773 1.0037 0.9904 0.9159 1.0164 ite-sar1-wls 0.9812 0.9858 0.9827 0.9829 0.9831 0.9078 0.9504 0.9289 0.8619 0.9493 ite-shr-ols 1.1318 1.100 1.0848 1.0654 1.0952 1.0153 1.0407 1.0279 0.9594 1.0554 ite-shr-shr 0.9790 0.9827 0.9888 0.9877 0.9845 0.8994 0.9530 0.9258 0.8561 0.9483 ite-shr-struc 1.1133 1.0787 1.0626 1.0464 1.0749 0.9945 1.0155 1.0049 0.9258 1.0322 ite-shr-wls 0.9758 0.9839 0.9915 0.9909 0.9855 0.8981 0.9570 0.9271 0.8598 0.9498 ite-strar1-ols 1.1586 1.0932 1.0705 1.0546 1.0935 1.0256 1.0300 1.0278 0.9584 1.0543 ite-strar1-shr 1.0539 1.0114 0.9971 0.9886 1.0125 0.9492 0.9596 0.9544 0.8819 0.9761 ite-strar1-struc 1.1406 1.0752 1.0505 1.0347 1.0745 1.0067 1.0062 1.0064 0.9299 1.0330 ite-strar1-wls 1.0620 1.0175 1.0027 0.9949 1.0190 0.9560 0.9665 0.9612 0.8899 0.9829 ite-struc-ols 1.1579 1.0929 1.0707 1.0542 1.0932 1.0252 1.0299 1.0275 0.9583 1.0540 ite-struc-shr 1.0539 1.0110 0.9967 0.9884 1.0122 0.9489 0.9593 0.9541 0.8816 0.9758 ite-struc-struc 1.1402 1.0753 1.0504 1.0343 1.0743 1.0062 1.0062 1.0062 0.9300 1.0329 ite-struc-wls 1.0622 1.0173 1.0025 0.9947 1.0189 0.9558 0.9663 0.9611 0.8898 0.9828 ite-wlsh-ols 1.1053 1.0777 1.0677 1.0568 1.0767 0.9932 1.0292 1.0111 0.9456 1.0381 ite-wlsh-shr 0.9703 0.9820 0.9851 0.9808 0.9795 0.8999 0.9488 0.9240 0.8573 0.9452 ite-wlsh-struc 1.0903 1.0585 1.0477 1.0371 1.0582 0.9757 1.0047 0.9901 0.9162 1.0171 ite-wlsh-wls 0.9749 0.9856 0.9890 0.9854 0.9837 0.9033 0.9536 0.9281 0.8631 0.9496 ite-wlsv-ols 1.1052 1.0752 1.0644 1.0549 1.0748 0.9943 1.0278 1.0109 0.9453 1.0369 ite-wlsv-shr 0.9750 0.9815 0.9783 0.9784 0.9783 0.9035 0.9459 0.9245 0.8562 0.9444 ite-wlsv-struc 1.0901 1.0576 1.0442 1.0351 1.0566 0.9770 1.0037 0.9902 0.9160 1.0162 ite-wlsv-wls 0.9813 0.9858 0.9829 0.9830 0.9832 0.9078 0.9506 0.9289 0.8620 0.9494 Table A.16: AvgRelMSE at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All Procedure 1 2 3 4 1-4 1 2 1-2 1 all 95 series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.5246 1.2871 1.1918 1.1415 1.2782 1.1855 1.1172 1.1508 1.0041 1.1984 oct-struc 1.2511 1.1084 1.0430 1.0154 1.1008 0.9746 0.9682 0.9714 0.8322 1.0206 oct-wlsh 0.9548 0.9718 0.9760 0.9696 0.9680 0.8112 0.9194 0.8636 0.7579 0.9048 oct-wlsv 0.9692 0.9719 0.9622 0.9631 0.9666 0.8203 0.9125 0.8652 0.7562 0.9042 oct-bdshr 0.9838 0.9798 0.9618 0.9665 0.9730 0.8297 0.9144 0.8710 0.7573 0.9095 oct-acov 0.9553 0.9648 0.9767 0.9707 0.9668 0.8013 0.9185 0.8579 0.7531 0.9016 oct-shr 0.9652 0.9610 0.9875 0.9835 0.9742 0.7971 0.9211 0.8569 0.7465 0.9041 oct-Sshr 0.9547 0.9720 0.9913 0.9884 0.9765 0.8054 0.9343 0.8674 0.7631 0.9113 32 upper series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.2156 1.1122 1.0452 1.0300 1.0984 1.0087 0.9962 1.0024 0.858 1.0330 oct-struc 1.0667 1.0341 0.9814 0.9756 1.0138 0.8898 0.9252 0.9073 0.7737 0.9449 oct-wlsh 0.9387 0.9510 0.9339 0.9360 0.9399 0.7999 0.8842 0.8410 0.7204 0.8766 oct-wlsv 0.9411 0.9506 0.9316 0.9326 0.9390 0.8032 0.8811 0.8412 0.7198 0.8760 oct-bdshr 0.9453 0.9559 0.9246 0.9340 0.9399 0.8091 0.8791 0.8433 0.7174 0.8767 oct-acov 0.9388 0.9498 0.9353 0.9371 0.9402 0.7984 0.8844 0.8403 0.7193 0.8763 oct-shr 0.9309 0.9237 0.9438 0.9532 0.9379 0.7691 0.8867 0.8258 0.7023 0.8678 oct-Sshr 0.9291 0.9381 0.9339 0.9398 0.9352 0.7892 0.8846 0.8355 0.7160 0.8717 63 bottom series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.7104 1.3863 1.2740 1.2026 1.3806 1.2869 1.1842 1.2345 1.0876 1.2924 oct-struc 1.3567 1.1481 1.0757 1.0362 1.1479 1.0208 0.9908 1.0057 0.8636 1.0613 oct-wlsh 0.9631 0.9825 0.9981 0.9871 0.9826 0.8170 0.9378 0.8753 0.7776 0.9194 oct-wlsv 0.9837 0.9828 0.9782 0.9789 0.9809 0.8292 0.9288 0.8776 0.7754 0.9188 oct-bdshr 1.004 0.9922 0.9813 0.9835 0.9902 0.8404 0.9329 0.8854 0.7784 0.9267 oct-acov 0.9639 0.9725 0.9984 0.9881 0.9806 0.8028 0.9363 0.8670 0.7709 0.9147 oct-shr 0.9830 0.9805 1.0105 0.9992 0.9932 0.8117 0.9391 0.8731 0.7700 0.9231 oct-Sshr 0.9680 0.9897 1.0218 1.0140 0.9982 0.8138 0.9606 0.8841 0.7881 0.9322 Table A.17: AvgRelMAE at any temporal aggregation level and any forecast horizon. Quarterly Semi-annual Annual All Procedure 1 2 3 4 1-4 1 2 1-2 1 all 95 series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.2422 1.1377 1.1027 1.0736 1.1373 1.0921 1.0565 1.0741 1.0001 1.0985 oct-struc 1.1219 1.0563 1.0298 1.0153 1.0551 0.9908 0.9870 0.9889 0.9123 1.0144 oct-wlsh 0.9745 0.9863 0.9895 0.9867 0.9842 0.9028 0.9545 0.9283 0.8630 0.9499 oct-wlsv 0.9813 0.9858 0.9829 0.9830 0.9832 0.9078 0.9506 0.9289 0.8620 0.9494 oct-bdshr 0.9858 0.9880 0.9809 0.9833 0.9845 0.9112 0.9499 0.9304 0.8620 0.9505 oct-acov 0.9762 0.9831 0.9904 0.9879 0.9844 0.8965 0.9541 0.9248 0.8600 0.9485 oct-shr 0.9825 0.9804 0.9944 0.9920 0.9873 0.8939 0.9509 0.9219 0.8520 0.9480 oct-Sshr 0.9739 0.9832 0.9922 0.9936 0.9857 0.8962 0.9591 0.9271 0.8607 0.9500 32 upper series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.0857 1.0534 1.0331 1.0249 1.0491 1.0027 0.9971 0.9999 0.9226 1.0159 oct-struc 1.0173 1.0227 1.0058 1.0069 1.0131 0.9467 0.9712 0.9589 0.8857 0.9784 oct-wlsh 0.9604 0.9780 0.9727 0.9773 0.9721 0.8948 0.9362 0.9152 0.8404 0.9358 oct-wlsv 0.9589 0.9773 0.9712 0.9752 0.9706 0.8969 0.9339 0.9152 0.8404 0.9350 oct-bdshr 0.9552 0.9790 0.9632 0.9719 0.9673 0.8983 0.9288 0.9134 0.8364 0.9320 oct-acov 0.9631 0.9756 0.9729 0.9764 0.9720 0.8933 0.9356 0.9142 0.8383 0.9351 oct-shr 0.9591 0.9594 0.9700 0.9820 0.9676 0.8746 0.9295 0.9016 0.8205 0.9262 oct-Sshr 0.9587 0.9675 0.9660 0.9769 0.9673 0.885 0.9327 0.9085 0.8303 0.9296 63 bottom series base 1 1 1 1 1 1 1 1 1 1 oct-ols 1.3301 1.1831 1.1399 1.0992 1.1850 1.1405 1.088 1.1139 1.0419 1.1430 oct-struc 1.1791 1.0737 1.0422 1.0196 1.0770 1.0140 0.9951 1.0045 0.9262 1.0333 oct-wlsh 0.9818 0.9906 0.9981 0.9916 0.9905 0.9069 0.9639 0.9350 0.8746 0.9571 oct-wlsv 0.9929 0.9901 0.9888 0.9870 0.9897 0.9133 0.9591 0.9360 0.8732 0.9568 oct-bdshr 1.0018 0.9925 0.9900 0.9892 0.9933 0.9178 0.9609 0.9391 0.8753 0.9600 oct-acov 0.9830 0.9869 0.9994 0.9937 0.9907 0.8981 0.9636 0.9303 0.8712 0.9554 oct-shr 0.9946 0.9913 1.0070 0.9972 0.9975 0.9038 0.9619 0.9324 0.8684 0.9593 oct-Sshr

0.9818 0.9912 1.0059 1.0021 0.9952 0.9019 0.9728 0.9367 0.8766 0.9606 q q q q q q q q q oct-wlsh 3.68 Mean ranks

Critical distance = 1.23 Friedman: 0 (Ha: Different) q q q q q q q q q oct-wlsh 3.55 

![Description n b , n a , n Number of bottom, upper, and total time series (n = n a + n b ) m Highest available sampling frequency per seasonal cycle (max. order of temporal aggregation) h ≥ 1 Forecast horizon for the lowest frequency time series T Number of high-frequency observations used in the forecasting models N Number of observations at the lowest frequency: N = T m Set of factors of m in descending order: K = {k p , k p-1 , . . . , k 2 , k 1 },]()

![containing the base forecasts of the level k temporally aggregated series. Component of matrix Y = Y [m]]()

![Figure 1: A simple two-level hierarchical structure]()

![Figure 2: Two hierarchies sharing the same top-level series X]()

![Both b and b * have the same dimension (T n b ×1), and this holds for a and a * as well, which have dimension (T n a × 1). However, in the former case (b and a) the data is organized 'by-time-first-and-then-by-variable': b = b 1 . . . b t . . . b T , a = a 1 . . . a t . . . a T , whereas in the latter (b * and a * ) the data is organized 'by-variable-first-and-then-by-time': b]()

![Figure 5: Quarterly, semi-annual and annual one-step-ahead reconciled forecasts of 79 out of 95 times series of the Aus-]()

![Figure6: Cross-sectional and temporal gross incoherence at each iteration step of the iterative cross-temporal forecast reconciliation procedure (t-wlsv + cs-shr) for the Australian GDP time series, at the first forecast origin 1994:Q3.]()

![Figure 7: Hierarchical structure of the income approach for Australian GDP. The pink cell contains the most aggregate series. The blue cell contain intermediate-level series and the yellow cells correspond to the most disaggregate bottom-level series. Source: Athanasopoulos et al., 2019, p. 702. a total of 91 forecast origins 13 . Likeways, in the same automatic fashion we have computed (i) one and two-step ahead forecasts for the time series obtained by temporal aggregation of two successive quarters, and (ii) one-step-ahead forecasts for the time series obtained by temporal aggregation of four successive quarters.]()

![Figure 8: Top panel: Average Relative MSE across all series and forecast horizons, by frequency of observation. Bottom panel: Rankings by frequency of observation and forecast horizon.]()

![Figure9: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MSE mean rank (i) across all time frequencies and forecast horizons (top), and (ii) for one-step-ahead quarterly forecasts (bottom).]()

![]()

![Figure 10: Quarterly GDP and selected time series from both Income and Expenditure sides: actual values and one-step-ahead base forecasts during the testing period (1994:Q4 -2018:Q1)]()

![Figure A.1: A simple unbalanced hierarchy (right) and its balanced version (left)]()

![r . A.3.1 Cross-sectional case: the permutation matrices linking vectors b * to b and a * to a Denoting b = vec (B), b * = vec (B ), a = vec (A), a * = vec A , the mappings of b into b * and a into a * , respectively, can be expressed as P b b = b * , P a a = a * , where P b = C n b T,n b T and P a = C naT,naT are (n b T ×n b T ) and (n a T ×n a T ), respectively, commutation matrices. Since both P b and P a are orthogonal, it is: b = P b b * , a = P a a * . The index k, k = 1, . . . , n b T , of the generic element of vector b * can be expressed in terms of the row and column indices of the corresponding element of matrix B : vec(B ) = b * = {b * k } , b * k = b ti , with k = t + (i -1)T.]()

![.3.2 Cross-temporal case: the relationship between y and vec (Y )Assuming h = 1, denote with Y = A B the [n × (k * + m)] matrixof the target forecasts at any temporal frequency. The [n b × (k * + m)] submatrix B, which contains the target forecasts of the bottom time series, can be written as:]()

![Figure A.2: The two temporal hierarchies induced by a monthly time series.]()

![Figure A.4: Top panel: Average Relative MAE across all series and forecast horizons, by frequency of observation. Bottom panel: Rankings by frequency of observation and forecast horizon.]()

![Figure A.5: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MAE mean rank (ii) across all time frequencies and forecast horizons (top), and (ii) for one-step-ahead quarterly forecasts (bottom).]()

![Figure A.6: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MSE mean rank for two-step-ahead (top) and three-step-ahead (bottom) quarterly forecasts.]()

![Figure A.7: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MSE mean rank for four-step-ahead (top) and one-to-four-step-ahead (bottom) quarterly forecasts.]()

![Figure A.8: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MSE mean rank for one-step-ahead (top) and two-step-ahead (bottom) six-months forecasts.]()

![Figure A.10: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MAE mean rank for two-step-ahead (top) and three-step-ahead (bottom) quarterly forecasts.]()

![Figure A.11: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MAE mean rank for four-step-ahead (top) and one-to-four-step-ahead (bottom) quarterly forecasts.]()

![Figure A.13: Nemenyi test results at 5% significance level for all 95 series. The reconciliation procedures are sorted vertically according to the MAE mean rank for one-to-two-stepahead (top) six-months forecasts and one-step-ahead twelve-months forecasts (bottom).]()

![Figure A.18: Average Relative MSE across all series and forecast horizons, by frequency of observation (selected procedures).]()

![Figure A.28: Nemenyi test results at 5% significance level for all 95 series. The optimal combination reconciliation procedures are sorted vertically according to the MSE mean rank (i) across all time frequencies and forecast horizons (top), and (ii) for 1-step-ahead quarterly forecasts (bottom).]()

![AvgRelMSE at any temporal aggregation level and any forecast horizon.]()

![AvgRelMSE at any temporal aggregation level and any forecast horizon for selected upper time series and reconciliation procedures.]()

A geometric interpretation of the entire hierarchical forecasting problem is given byPanagiotelis et al.  (2020a).

For space reasons, in this paper only simple summation for both contemporaneous and temporal aggregation relationships is considered. Remaining in a linear framework, the extension to general linear constraints (i.e., weighted summation), able to cover other important data features, is rather straightforward[(Shang, 2017](#b51),  2019[, Shang and Hyndman, 2017](#b53)[, Li and Hyndman, 2019](#b39), Panagiotelis et al., 2020a).

If k is not a factor of m, then the seasonality of the aggregate series is non-integer, and so forecasts of the aggregate are more difficult to compute.

For any given positive m > 1, there is a single unique temporal hierarchy only if m = q α , where α is a positive integer and q is a prime number[(Yang et al., 2017)](#b63). A corollary is that a single unique hierarchy is only possible when there are no coprime pairs in the set {kp-1, . . . , k3, k2}[(Athanasopoulos et al., 2017)](#b3).

For the time being, we do not consider all the newly proposed covariance matrices. The interested reader may refer to[Nystrup et al. (2020)](#b44).

MatrixΩ [m]reduces to a scalar variance.

The general case h ≥ 1 can be dealt with in a straightforward way.

Indeed, Ω sam and W sam are mean square error (MSE) matrices.

This issue is currently under study, in order to develop a procedure which, by exploiting some distinctive features of a hierarchical/grouped time series, be able to produce non-negative reconciled forecasts with a reduced computational effort.

Temporal reconciliation has been done using t-wlsv, while cross-sectional reconciliation was performed using cs-shr. However, this result does not seem to depend on the reconciliation procedures considered: t-struc+cs-wls, t-struc+cs-shr, and t-wlsv+cs-wls give very similar results, here not presented for space reasons, but available on request from the authors.

The R scripts, the data and the results of the paper by[Athanasopoulos et al. (2019)](#b2) are available in the github repository located at https://github.com/PuwasalaG/Hierarchical-Book-Chapter. We did not change this first, crucial step in the forecast reconciliation workflow, since the focus is on the potential of cross-temporal forecast reconciliation. However,[Athanasopoulos et al. (2019)](#b2) point out that this fast and flexible approach performs well in forecasting Australian GDP aggregates, even compared to other more complex methods.

[Sagaert et al. (2019)](#b49) warn practitioners that this could be 'a myopic choice as (the accuracy metrics) consider solely the first moment of the error distribution and ignore higher moments, which can have significant implications for decision making'. This important issue will be dealt with in the near future.

[Davydenko and Fildes (2013)](#b10) develop the Average Relative MAE (AvgRelMAE), based on the Mean Absolute Error of the forecasts, but suggest that this formulation 'If required (...) can also be extended to other measures of dispersion or loss functions', as the AvgRelMSE in (58) and the AvgRelRMSE, based on the Root Mean Square Error[(Sagaert et al., 2019, Kourentzes and](#b49) Athanasopoulos, 2020a).

On this last point,Kourentzes and Athanasopoulos (2020b, pp.  

17-18) raise an important issue by claiming that 'in contrast to common practice, we believe that there is limited benefit in an empirical evaluation setting, to report average accuracy measures across all levels of the hierarchy (...). It is very improbable that this reflects a realistic situation. Hence, it is paramount that the modeller attempts to establish a strong connection between the objectives of the forecasts and the evaluation'. In the forecasting experiment of this paper, where only three temporal aggregation levels are in order, it could be sensible not to consider as strategic the semi-annual time frequency, which is instrumentally used to improve the accuracy of quarterly and annual forecasts, but is probably of reduced practical usefulness to analysts and decision makers.

For example, in this simple example a different full row-rank H can be obtained either by removing the last three rows, or by eliminating rows 5, 10 and 15 from matrix H .

