# Emergent hypernetworks in weakly coupled oscillators

## Abstract

## 

Networks of weakly coupled oscillators had a profound impact on our understanding of complex systems. Studies on model reconstruction from data have shown prevalent contributions from hypernetworks with triplet and higher interactions among oscillators, in spite that such models were originally defined as oscillator networks with pairwise interactions. Here, we show that hypernetworks can spontaneously emerge even in the presence of pairwise albeit nonlinear coupling given certain triplet frequency resonance conditions. The results are demonstrated in experiments with electrochemical oscillators and in simulations with integrate-and-fire neurons. By developing a comprehensive theory, we uncover the mechanism for emergent hypernetworks by identifying appearing and forbidden frequency resonant conditions. Furthermore, it is shown that microscopic linear (difference) coupling among units results in coupled mean fields, which have sufficient nonlinearity to facilitate hypernetworks. Our findings shed light on the apparent abundance of hypernetworks and provide a constructive way to predict and engineer their emergence.

## Introduction

Networks of weakly coupled oscillators are prolific models for a variety of natural systems ranging from biology [[1,](#b0)[2]](#b1) and chemistry [[3,](#b2)[4]](#b3) to neuroscience [[5,](#b4)[6]](#b5) via ecology [[7]](#b6) to engineering [[8]](#b7). Such networks serve as stepping stones to understand collective dynamics [[9,](#b8)[10,](#b9)[11,](#b10)[12]](#b11) and other emergent phenomena in networks [[13,](#b12)[14]](#b13). In these models, the interactions are described in a pairwise manner and the collective dynamics of a network can be predicted by the superposition of such pairwise interactions.

Recent work, however, suggests that many networks described as pairwise interactions can be better described in terms of hypernetworks with triplet and quadruplet interactions among nodes [[15,](#b14)[16,](#b15)[17,](#b16)[18]](#b17). In fact, hypernetworks appear as suitable representations of certain dynamical processes found in physics [[19,](#b18)[20]](#b19), chemistry [[21]](#b20) and neuroscience [[22,](#b21)[23]](#b22). This has ignited research aimed at understanding the impact of higher-order interactions on the dynamical behavior of complex systems [[24,](#b23)[25,](#b24)[26,](#b25)[27]](#b26). Moreover, besides considering hypernetworks as a good description of such models, we observed that hypernetworks could be revealed in data-driven model reconstructions when the original model is a network. Therefore, a major puzzle is why hypernetworks emerge as the fitting description of actual network data.

Here, we show that hypernetworks can describe experimental data of networks of electrochemical oscillators with nonlinear coupling. We uncover a mechanism that generates higherorder interactions as a model to describe oscillator networks from data. First, we show that sparse model recovery from data reveals higher-order interactions. We then develop a theory for the emergence of such higher-order interactions when the isolated system is close to a Hopf bifurcation. We provide an algorithm to reveal emergent hypernetwork and its emergent coupling functions for any network in disciplines ranging from neuroscience to chemistry. The emergent hypernetworks provide a dimension reduction that allows the characterization of critical transitions.

## Results

## Emergent hypernetworks in electrochemical experiments

We designed an experimental system with four oscillatory chemical reactions coupled with nonlinear feedback and delay arranged in a ring network (see Fig. [1](#fig_0) (a)). The set-up consists of a multichannel potentiostat interfaced with a real-time controller and connected to a Pt counter, a Hg/Hg 2 SO 4 sat K 2 SO 4 reference, and four Ni working electrodes in 3.0 M sulfuric acid electrolyte. At a constant circuit potential (V 0 =1100 mV with respect to the reference electrode) and with an external resistance (R ind =1.0 kohm) attached to each nickel wire, the electrochemical dissolution of nickel exhibits periodic current and electrode potential oscillations with a natural frequency of 0.385 Hz.

Without coupling, we adjusted the natural frequency of each oscillator to have a ratio with respect to oscillator 1 as ω 2 /ω 1 = 2.53 (≈ 2.5), ω 3 /ω 1 =1.56 (≈ 1.5) and ω 4 /ω 1 = 2.53 (≈ 2.5) with a set of resistors and capacitors (C ind ), see Supplementary Note 1.) The natural frequencies create opportunities for triplet resonances, as there are small detunings for ω 1 -ω 2 + ω 3 and ω 1 -ω 4 + ω 3 , as well as pairwise resonances ω 2 ≈ ω 4 .

The individual electrode potentials (E k ) were recorded and rescaled and offset corrected

$Ẽk = O k [E k -o k ],(1)$where o k and O k are the time-averaged electrode potential and amplitude rescaling factor, respectively. (The rescaling factors, O k = 0.5, 1, 0.5, 1 V were applied to counter the different amplitudes of the slow oscillators.) A ring-coupling can be introduced with external feedback (see Fig. [1 (b,](#fig_14)[c](#))) according to

$V k (t) = V 0,k + K 4 =1 A k h[ Ẽk (t), Ẽ (t -τ )],(2)$where V k (t) and V 0,k are the applied and the offset circuit potential of the kth electrode, respectively, K is the coupling strength, A k is the adjacency matrix, τ is a time delay, and h[ Ẽk (t), Ẽ (t -τ )] = ( Ẽk (t) + Ẽk (t) 2 ) Ẽ (t -τ ).

This delayed nonlinear feedback modulates the impact of the coupled units with a bias towards positive values (similar to a diode operation in the (-1, 1) interval). Note that this form of feedback is fundamentally different from previously applied nonlinear schemes [[4]](#b3) in that it does not produce obvious synchronization patterns, for example, one and multi-cluster states. From the potentials Ẽk we extract the frequencies θk and apply a first-order Savitzky-Golay filter with a time window of 45 s to remove the in-cycle and short-range phase fluctuation, as shown in Figure [1](#fig_0) (e) (solid line). For each oscillator, a slow variation is seen as the oscillators slow down and speed up on a timescale of about 100 s (or 40 cycles); notably, the elements 1 and 3 exhibit similar θk oscillations, which are different from those in elements 2 and 4.

To describe the nature of the phase dynamics, we consider the slow triplet phase differences

$φ 1 = θ 1 -θ 2 + θ 3 φ 2 = θ 1 -θ 4 + θ 3 ,(4)$which correspond to the triplet frequency detunings.

The impact of triplet interactions on the dynamics can be extracted with a LASSO fit to θk = ωk (t) +

$2 j=1 C k j sin(φ j ) + D k j cos(φ j )(5)$where ωk (t) = ω0 k + ω1 k t + ω2 k t 2 is the fitted, slowly drifting (up to quadratic variation in time) natural frequency, and C k j and D k j are the amplitudes of the sin and cos phase coupling functions corresponding to the appropriate triplet phase differences. The strength of the triplet interactions j = 1, 2 (for φ j ) on oscillator k is given by the amplitudes

$H k j = (C k j ) 2 + (D k j ) 2 .$The dynamics of oscillators 1 and 3 are impacted by both triplet interactions; φ 1 impacts oscillators 1 and 3 with amplitudes 4.9 × 10 -3 and 4.4 × 10 -3 , and φ 2 with 2.3 × 10 -3 and 3.2 × 10 -3 , respectively. However, the dynamics of oscillators 2 and 4 are only impacted by triplet interactions φ 1 (with amplitude 1.33 × 10 -2 ) and φ 2 (1.7 × 10 -2 ), respectively. These triplet interactions describe phase fluctuations over the long time scale (red curves in Fig. [1 (e)](#fig_14)). Therefore, we can conclude that the phase dynamics of the oscillators coupled in a ring can be described by a hypernetwork shown in Fig. [1 (f)](#fig_14).

The fact that model recovery provides triplets as the best description is rather puzzling. Also given that the resonant behavior ω 2 ≈ ω 4 did not appear in the model recovery from data. This suggests an interplay between the resonant frequencies and the network topology. The question arises, which resonances/triplet interactions emerge from a large number of possibilities in a given network, natural frequencies, and nonlinear coupling? An outstanding question is what is the origin of these triplet interactions that were generated by pairwise physical coupling?

## A theory for emergent higher-order interactions

To answer these questions, we develop a theory that captures the important characteristics of the experiments: nonlinear coupling and triplet resonance conditions. We consider the networks

$żk = f k (z k ) + α n =1 A k h k (z k , z )(6)$where z k ∈ C is the state of the kth oscillator, h k : C × C → C is the pairwise coupling function, A k is the adjacency matrix, and α > 0 is the coupling strength. When the isolated system is close to a Hopf bifurcation, the dynamics is described by

$f k (z k ) = γ k z k + β k z k |z k | 2 [28]$. The Hopf bifurcation is a common route to oscillations in nonlinear systems and describes the appearance of oscillations in applications [[2,](#b1)[5,](#b4)[6,](#b5)[8,](#b7)[3]](#b2). Our proofs are valid for γ k = λ + iω k with small λ and ω k satisfying resonance conditions. We fix β k = -1, but this value is immaterial. We develop a normal form theory to eliminate unnecessary terms of h(z k , z ) and to expose higher-order ones that predict the dynamics. To a network of the form of Eq. (S140)

we associate non-resonance conditions that allow us to get rid of the leading interaction terms in α.

Since h(z k , z ) is a linear combination of monomials and the theory can be applied to each monomial independently, we assume first that h(z k , z ) is a single monomial of the form

$h(z k , z ) = z d 1 k zd 2 k z d 3 zd 4(7)$for non-negative numbers d 1 , . . . , d 4 . Our major theoretical result is a formulation of a nonresonance condition given by

$(d 1 -d 2 -1)ω k + (d 3 -d 4 )ω = 0.(8)$This condition shows up naturally in our approach, as a monomial Equation ( [7](#formula_8)) can only be eliminated by a transformation that divides by the left-hand side of Equation ( [8](#formula_9)). Hence, an interaction term in the coupling function h given by Equation ( [7](#formula_8)) can only be removed if the non-resonance condition is satisfied. The non-resonance condition is defined as the union over all non-resonance conditions of its monomial terms. The network non-resonance conditions are given by the union over all non-resonance conditions of h(z k , z ) for which A k = 0. Our result is the following:

In Methods, we show that given Eq. (S140) with h : C × C → C a smooth map with vanishing constant terms, under the network non-resonance conditions, there is a coordinate transformation that eliminates pairwise interaction terms and reveals the higher-order interactions. The proof consists of two main steps: i) Existence of a polynomial change of variables. Consider

$u k = z k -αP k(9)$for some polynomials P k . The goal is to design P k such that in the variables u k interaction terms linear in α vanish. We obtain higher-order interactions of order α 2 . For Eq. (S140) we use

$P k (z) = n =1 A k hk (z k , z ) ,(10)$where hk (z, w) is the function obtained from h(z, w) by transforming each monomial according to the following replacement rule:

$z d 1 zd 2 w d 3 wd 4 → z d 1 zd 2 w d 3 wd 4 (d 1 -1)γ k + d 2 γk + d 3 γ + d 4 γ(11)$Note that the imaginary part of the denominator in Equation ( [11](#formula_12)) is precisely the left-hand side of Equation [(8)](#b7). While bringing the equations to the new form, we face a major challenge to understand the combinatorial behavior of the Taylor coefficients during the transformation.

We define a bracket on the space of polynomials to track these coefficients.

ii) Dealing with transformed isolated dynamics. The second major challenge lies in the fact that another coordinate transformation is needed to eliminate terms coming from the isolated dynamics f k . Indeed, as we eliminate coupling terms linear in α, other terms linear in α appear due to the isolated dynamics. A remarkable fact is that the same non-resonance conditions also ensure that the second transformation exists.

Our theorem is applicable to a much broader class of coupling functions and network formalisms than what is described by Eq. (S140). A rich variety of new interaction rules can emerge, depending on the specifics of the set-up (see Supplementary Note 2).

Applying the replacement rule Eq. ( [11](#formula_12)) we obtain

$uk = f k (u k ) -α 2 n =1 n p=1 A k A kp 1 G p k (u k , u , u p ) -A k A p 2 G p k (u k , u , u p ) ,(12)$up to higher-order terms in α and u. In Methods, we discuss the new coupling functions 1 G k and 2 G k some their properties. The coupling is now α 2 explaining anomalous synchronization transitions that appears in networks (see Supplementary Note 3).

## Emergent hypernetworks explain experimental data

Similar to the experiments we consider a ring of four oscillators with coupling function

$h(z, w) = z w + z 2 w. (13$$)$Instead of delay, the oscillators are coupled through a conjugate variable that enables a streamlined theoretical treatment. Close to a Hopf bifurcation, the delay would have an effect of advancing the oscillations over half a period. As before, we consider ω 1 -ω 2 +ω 3 and ω 1 -ω 4 +ω 3 to be close to zero, so, capturing the triplet resonance in the experiments. We apply our theory to this case to unravel how higher-order interactions appear in the data.

The coupling function is a combination of z w and z 2 w, providing d 1 = 1 and d 4 = 1 for the first monomial and d 1 = 2 and d 4 = 1 for the latter. The resonance condition Eq. ( [8](#formula_9)) is satisfied for both. Using the replacement rule Eq. ( [11](#formula_12)), we find

$u k = z k + α z k-1 z k γk-1 + z k z k+1 γk+1 + z 2 k-1 zk γ k-1 + γk + z 2 k zk+1 γ k + γk+1(14)$Each node equation contains 16 interaction terms as in Eq. ( [12](#formula_13)). We discuss some of these terms for the first node. 2 G 23 1 appears as node 1 is connected to node 2 and 2 to 3. This interaction is resonant, see Figure [2](#) (a). 2 G 43 1 appears because node 1 is connected to 4 and node 4 to 3. This term is also resonant, see Figure [2 (b](#)). 1 G 24  1 is nonzero and nonresonant. This term appear as 1 is directed connected to 2 and 4, see Figure [2 (c](#)). Finally, the term 2 G 24  1 is a forbidden, the term would appear from an interaction of 1 to 2 and from 2 to 4, however, in the original network the later interaction is absent, see Figure [2 (d)](#). Remarkably, not all interactions are relevant when the goal is to describe slow oscillations in the phases.

Indeed, once we analyse the phases in the new equations, the coupling term coming from 2 G 23  1 will lead to oscillations with frequency close to ω 1 -ω 2 + ω 3 while the term coming from 2 G 43 1 leads to a frequency close to ω 1 -ω 4 + ω 3 . This implies that both terms are slowly varying. In contrast, the term coming from 2 G 24  1 leads to oscillations with frequency ω 1 -ω 2 + ω 4 ≈ ω 1 and is fast oscillating in comparison to the slow terms with small frequencies. In virtue of the averaging theory, such fast oscillating terms can be neglected. In fact, only resonant terms connected by local trees in the original graph will survive such as the resonant ones involving  [12](#formula_13)) of node 1. Colors correspond to signs in the phase combination with blue standing for positive and orange for negative. (a) resonant interaction term appearing as 2 G 23  1 . (b) resonant interaction term appearing as 2 G 43 1 . Finally, (c) is a nonresonant term and (d) 2 G 24  1 is a forbidden term (it does not appear). These new interaction terms can be predicted from the combinatorics of the original network and coupling function.

$ω 1 -ω 2 + ω 3 and ω 1 -ω 4 + ω 3 . This yields u1 = f 1 (u 1 ) -α 2 η 12 u 2 1 ū2 u 3 -α 2 η 14 u 2 1 ū4 u 3 u2 = f 2 (u 2 ) -α 2 ζ 231 u 2 2 ū1 ū3 u3 = f 3 (u 3 ) -α 2 η 32 u 2 3 ū2 u 1 -α 2 η 34 u 2 3 ū4 u 1 u4 = f 4 (u 4 ) -α 2 ζ 431 u 2 4 ū1 ū3(15)$where η pq = 1 γp+γq and ζ pqr = 2 γp+γq + 2 γp+γr + 1 γq + 1 γr . Writing u = re iθ we obtain equations for the phases θ. The averaging theorem gives

$θ1 = ω 1 -α 2 r 3 0 [ρ 12 (φ 1 ) + ρ 14 (φ 2 )] , θ2 = ω 2 -α 2 r 3 0 σ 231 (φ 1 ) θ3 = ω 3 -α 2 r 3 0 [ρ 32 (φ 1 ) + ρ 34 (φ 2 )] , θ4 = ω 4 -α 2 r 3 0 σ 431 (φ 2 ),(16)$where the phases φ 1 and φ 2 are given in Eq. (S144). The functions ρ and σ are provided in the

## Predicting the slow phase interactions in experiments

In Supplementary Note 3, we show that the experimental recovery of a hypernetwork is not an artifact. Rather, we prove that imposing sparsity unavoidably leads to the recovery of the normal form instead. Indeed, as the recovery allows for a small least square deviation between the data and the model, the recovery finds the hypernetwork as a simpler description of the system. So, by measuring the original variables and attempting a model recovery while imposing sparsity, model recovery learns only the higher-order interactions. We now use the emergent network prediction for the ring network with the corresponding resonance conditions as in the experiment to explain the slow phase dynamics.

From the data we extract the slow phases φ 1 and φ 2 as shown in Figure [3](#fig_3) in solid lines.

Using our theory, from Eq. ( [16](#formula_18)), we obtain that

$φi = Ω i + 2 j=1 a ij cos φ j + b ij sin φ j(17)$where a's and b's are given in terms of the functions σ and ρ in Eq. ( [16](#formula_18)) see Supplementary Note 5. We treat a's and b's as fitting parameters from the vector field in Eq. ( [17](#formula_19)) obtained from first principles, since the corresponding coupling parameter and amplitudes are unknown. The resulting solutions agree with the experimental data as seen in Figure [3](#fig_3). Our findings are not strictly limited to electrochemical oscillators. As shown in Supplementary Note 9, we detected the same hypernetworks in nonlinearly coupled integrate-and-fire neuron models.

## Emergent hypernetworks among network modules coupled through meanfields

The requirement of a nonlinear coupling, at first sight, seems to be a limitation for practical applications. However, here we analyze how hypernetworks emerge in modular networks with microscopic pairwise coupling through phase differences.

We consider four subpopulations of N interacting Kuramoto oscillators [[13]](#b12). Nodes in each subpopulation interact strongly among themselves with coupling strength µ and weakly between subgroups with coupling strength α, see Figure [4](#fig_4). As we will show at the macroscopic mean-field level, the interaction is nonlinear. According to our theory, although the mean-fields have a pairwise interaction, their model recovery will be in terms of hypernetworks. We first Time (s) We show the time series of the slow phase φ 1 and φ 2 from experimental data (solid) and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions. The vector field describing the phase interaction is obtained from first principles. The coefficients of the vector field are obtained by least-square minimization.

consider the microscopic description; each oscillator is described by

$ψkm = ω km + µ N N n=1 sin(ψ kn -ψ km ) + 4 =1 A kl α N N n=1 sin(ψ ln -ψ km )(18)$or in terms of mean-fields ψkm = ω km + Im (µz k + α A kl z l ) e -iψ km where

$z k = 1 N N m=1 e iψ km(19)$is the mean-field of the subpopulation k. The frequencies ω km are distributed according to a Lorenzian ρ(ω, Ω k , σ k ) where Ω k is the mean subpopulation frequency and σ k is the frequency dispersion. Applying the Ott-Antonsen ansatz [[15]](#b14), we obtain the macroscopic equations describing the mean-fields in the limit N → ∞ as

$żk = f k (z k ) + 4 l=1 A kl h(z k , z l )(20)$where f k is the Hopf normal form with constants γ k = (iΩ k + µ -σ k ) and β k = -µ and

$h(z k , z l ) = αz l + αz l z 2 k ,(21)$thus, in the macroscopic description the coupling is nonlinear. We interpret α as a bifurcation parameter and deal with αz l as a nonlinear term as in bifurcation theory. We consider the ensemble frequencies to satisfy the resonance conditions

$Ω 1 + Ω 3 ≈ 2Ω 2 and Ω 2 + Ω 4 ≈ 2Ω 1 .$At α = 0 each subpopulation will have an order parameter behaving as z k (t) = r k e iθ k (t) where r k = µ-σ k µ and θk = Ω k . To obtain the phase model, we bring the network to its normal form and apply the phase reduction. In Supplementary Note 10, we perform the calculations of such resonance conditions to obtain the new normal form equations. After discarding nonresonant terms the phase equations of the mean-fields read as

$θ1,3 = Ω 1,3 + F 1,3 (ϕ 1 ) θ2,4 = Ω 2,4 + F 2,4 (ϕ 2 ) (22$$)$where F i is a linear combination of sine and cosine.

Next, we fix the ensemble frequencies as Ω 1 = 2, Ω 2 = 3, Ω 3 = 4 and Ω 4 = 1 as well as the coupling strengths µ = 0.5, σ k = 0.48 yielding r k = 0.15 and α = 0.1 for all subpopulations. We numerically integrate the mean-field equations and obtain the complex fields z 1 (t), z 2 (t), z 3 (t) and z 4 (t) which enables us to extract the phase dynamics θ 1 (t), θ 2 (t), θ 3 (t) and θ 4 (t). Performing a Lasso regression we recover the vector fields of Eq. ( [22](#formula_25)) confirming the theoretical prediction of higher order interactions, see Supplementary Note 10.

As before, we introduce the slow phases

$ϕ 1 = θ 1 -2θ 2 + θ 3 , ϕ 2 = θ 2 -2θ 1 + θ 4 . (23$$)$The theory predicts the higher order interaction between the slow phases as

$φk = ε k +G k (ϕ 1 , ϕ 2 ),$as shown in Supplementary Note 10. The fitting the predicted vector field of ϕ to the data is excellent as can be observed in Figure [4 c](#fig_4)).

For these four subpopulation on a ring, the condition on the frequencies is close to the subspace

$V res = {Ω 1 + Ω 3 = 2Ω 2 , Ω 2 + Ω 4 = 2Ω 1 } , forming a co-dimension 2 resonance surface.$That is, the emergence of hypernetworks is generic in a two parameter family of frequencies.

## Discussion

We have uncovered a mechanism by which nonlinear pairwise interactions with triplet resonance conditions result in nontrivial phase dynamics on a hypernetwork. Such interactions traditionally were attributed in brain dynamics to synaptic transmission between two neurons The original network of coupled subpopulations (with four distinct colours, namely, red, yellow, blue and orange). Oscillators are interacting by an internal coupling constant µ and intersubpopulations coupling constant α. b) Higher order phase interaction of the mean-fields represented with the same colors as in a) (red, yellow, blue and orange). Applying our approach we uncover that the phase interaction between the mean-fields is described by a hypernetwork. c) The mean-field slow phase variables ϕ 1 (green) and ϕ 2 (purple) were computed from the data collected from the simulations of mean fields on the associated network. The dashed curve is the simulation of the vector field of the slow phases ϕ 1,2 reconstructed from data using the Lasso method.

mediated by chemical messengers from a third neuron (heterosynaptic plasticity) [[29]](#b28). Our findings provide an alternative mechanism. On one hand, this finding shows that phase dynamics can be mediated through 'virtual' interactions not physically present in the system. On the other hand, such a mechanism could be leveraged to design interactions between remote components not directly connected but instead having correlations in natural frequencies.

The experimental system with a generic network motif with a ring of four electrochemical oscillators presented here was an example, where a relatively simple nonlinear modulation of the coupling induced a hypernetwork driven phase dynamics. Networks with a ring topology are selected for the experiment since they are common for many network based complex systems, e.g., in lasers, biological systems, neuronal dynamics and many disciplines [[30,](#b29)[31]](#b30). Such nonlinear modulation of the coupling can be quite general in gene expressions; for example, it was used to describe the coupling among circadian cells through Michaelis-Menten mechanism where coupling from one cell modulated the maximum gene expression rate in the other [[32]](#b31).

Strikingly, we showed that the coupling resulting in mean-field coupling among network modules has sufficient nonlinearity to facilitate hypernetwork interactions. In particular, event related modulation of spectral responses of magnetoencephalogram (MEG) recordings (i.e., modulation of frequency-specific oscillations in the motor network established by a handgrip task) have shown very strong evidence for nonlinear, between-frequency coupling of remote brain regions [[33]](#b32). Our results strongly suggest that in these MEG recordings, given the appropriate resonances and nonlinearities, hypernetwork description could facilitate the long-range modulation of frequencies. In conclusion, the findings open new avenues for hypernetwork based description and engineering of complex systems with heterogeneous frequencies and nonlinear interactions.

## Methods

Our results give an algorithmic procedure for obtaining a hypernetwork that accurately describes the observed behavior of the original system. This emergent higher order system depends on details of the given network, the original coupling function and the resonance relations among the phases.

## Normal form calculations

In Supplementary Note 2, we consider ODEs of the general form

$żk = γ k z k -β k z k |z k | 2 + αH k (z 1 , . . . , z n ) , k ∈ {1, . . . , n} ,(24)$with z k ∈ C and α ∈ R. The numbers β k , γ k ∈ C are assumed non-zero, and we furthermore write

$γ k = λ + iω k .$Here λ ∈ R is seen as the bifurcation parameter for a Hopf bifurcation, and we assume the interaction functions H k : C n → C to be smooth (i.e. C ∞ ) for convenience.

Moreover, we initially assume each H k satisfies H k (0) = 0 and DH k (0) = 0, though the condition on its derivative is later dropped.

Our main result shows that the ODE ( [24](#formula_31)) can be put in a normal form that allows us to predict the phase dynamics of the oscillators. We do this by using two successive transformations:

$w k = z k -αP k (z);(25)$$u k = w k -αQ k (w),(26)$for some appropriately chosen polynomials P k and Q k . The first of these coordinate transformations is used to remove the term αH k (z) from the Equation ( [24](#formula_31)). This will generate additional terms in α 2 that may be expressed in the coefficients of H k and P k following certain combinatorial rules. We manage this combinatorial behavior by introducing a special bracket [•||•] on the space of polynomials. In addition to these new interaction terms, the transformation will also produce terms in α involving P k and β k z k |z k | 2 , which obscure an interpretation of the system as a (hyper) network. We therefore remove these additional terms using the second coordinate transformation. A crucial observation here is that the non-resonance conditions needed for the first transformation are sufficient to ensure the second. We are able to prove this using the precise bookkeeping enabled by the aforementioned bracket.

When dealing with the case where DH k (0) = 0, we instead remove only the non-linear terms in H k using the transformations ( [25](#formula_33)) and ( [26](#formula_34)). This reveals higher order terms as before.

Even though DH k (0) accounts only for nonresonant terms by assumption, this linear term will nevertheless cause an overall frequency shift that has to be accounted for. More precisely, if we denote by Ω the diagonal matrix with entries the frequencies ω 1 , . . . , ω n , then the natural frequencies in the coupled case will be given by the imaginary part of the eigenvalues of iΩ + αDH(0). Here we have set H = (H 1 , . . . , H n ). These new frequencies can be approximated by standard eigenvalue perturbation techniques.

## Properties of the coupling functions

$1 G p k and 2 G p k$Applying the transformation of the theorem to Eq. (S140) yields a new system of the form Eq. ( [12](#formula_13)). In Supplementary Note 2, we show that

$1 G p k (u k , u , u p ) = ∂ hk (u k , u ) ∂u k h(u k , u p ) + ∂ hk (u k , u ) ∂ ūk h(u k , u p ) 2 G p k (u k , u , u p ) = ∂ hk (u k , u ) ∂u h(u , u p ) + ∂ hk (u k , u ) ∂ ū h(u , u p ) .(27)$In Eq. ( [27](#formula_36)) a term of degree d in h and a term of degree d in hk combine to form a term

$of degree d + d -1 in 1 G p k .$As both h and hk have terms of degree 2 and higher, we see that 1 G p k only has terms of degree 3 and higher. The same holds true for 2 G p k , which means that a classical network description involving directed edges is no longer possible.

The third order terms are moreover easily found by replacing h and hk in Eq. ( [27](#formula_36)) by their quadratic terms. Likewise, the fourth order terms are found by replacing h by its quadratic terms and hk by its cubic terms and vice versa in Eq. [(27)](#b26). We may also argue that these higher order terms in 1 G p k and 2 G p k are non-vanishing in general. Indeed, the coefficients in front of these terms are rational functions of γ k and the coefficients of h. Such functions are either identical to the zero function (which Eq. ( [27](#formula_36)) excludes) or non-vanishing on an open dense set.

New terms emerge that have an interpretation as higher-order interactions. The two double sums in Eq. ( [12](#formula_13)) have a combinatorial interpretation. The first double sum counts all pairs of nodes ( , p) that both influenced node k in the original network. The second double sum counts all pairs ( , p) where influenced k and p influenced and p need not influence k directly in the old network, so that new node-dependency is formed.

## An explicit algorithm for predicting the emergent hypernetwork

We present an algorithm for obtaining an emergent hypernetwork from a given network system.

Its input consists of the adjacency matrix A, the function h and the phases ω 1 through ω n , and we assume the nonresonance conditions of the theorem to hold. The algorithm is as follows:

Algorithm 1 Emergent Hypernetworks Input: Adjacency matrix A, coupling function h, frequencies and amplitudes γ i 's Output: Hypernetwork and Coupling functions 1: for each k ∈ S do 2:

for each ∈ S do

$3: if A k = 0 then 4:$form the polynomials hk (u k , u ) by the replacement rule

$z d 1 zd 2 w d 3 wd 4 → z d 1 zd 2 w d 3 wd 4 (d 1 -1)γ k + d 2 γk + d 3 γ + d 4 γ 5:$for each p ∈ S do

$6: if A k A kp = 0 then 7: Compute 1 G p k 8: if A k A p = 0 then 9: Compute 2 G p k 10: procedure RESONANT TERMS IN THE COUPLING FUNCTIONS G 11: for each u d 1 k ūd 2 k u d 3 ūd 4 u d 5 p ūd 6 p monomial of 1 G p k and 2 G p k do 12: if (d 1 -d 2 -1)ω k + (d 3 -d 4 )ω + (d 5 -d 6 )ω p = 0 then 13:$discard term

14: procedure REMAINING MONOMIALS ARE THE COUPLINGS OF NODE k 6 Model recovery of a 3-path with coupling h = (z 2 + z) w and resonance ω 1 -ω 2 + ω 3 = 0 6.1 Emergent network explanation . . . . . . . . . . . . . . . . . . . . . . . . . . 7 6 nodes network examples with h(z, w) = z w 8 Model recovery and normal form representation 9 Emergent hypernetworks in an integrate-and-fire model 10 Mean field interaction 10.1 Frequency shifts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10.2 Model Recovery . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10.3 Normal Form Calculations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 

$0 C k 1 4.89 × 10 -3 5.04 × 10 -3 3.15 × 10 -3 0 D k 1 9.27 × 10 -5 1.23 × 10 -2 -3.10 × 10 -3 0 C k 2 -1.49 × 10 -3 0 3.16 × 10 -3 4.63 × 10 -3 D k 2 -1.73 × 10 -3 0 -7.37 × 10 -4 1.64 × 10 -2$behavior [Supplementary Fig. [5 (d)]](#fig_5).

Fitting of phase dynamics As described in the main text, the impact of triplet interactions on the dynamics can be extracted with a LASSO fit to the θk values according to

$θk = ωk (t) + 2 j=1 C k j sin(φ j ) + D k j cos(φ j ) (S28)$where ωk (t) = ω0 k + ω1 k t + ω2 k t 2 is the fitted, slowly drifting (up to quadratic variation in time) natural frequency, and C k j and D k j are the amplitudes of the sin and cos phase coupling functions corresponding to the appropriate triplet phase differences.

For the fit, the instantaneous frequency, θk was obtained with the numerical derivative of the phase of each oscillator from the experimental times series. The θk was filtered by a first order Savitzky-Golay filter for 45 s. Using φ j , we fitted the θk with LASSO method. In LASSO, the regularization parameter determines how many parameters in the fitted model should be set to zero. We used a regularization parameter so that the mean square error is 20% higher than the best fit (no regularization). The fitted parameters are: 

## Proof of emergent higher-order networks

We consider ODEs of the general form

$żk = γ k z k -β k z k |z k | 2 + αH k (z 1 , . . . , z n ) ,(S29)$for k ∈ {1, . . . , n}. Here, each z k takes values in C and α ∈ R denotes the coupling parameter of the interaction. We moreover have β k , γ k ∈ C non-zero, and write γ k = λ + iω k for all k ∈ {1, . . . , n}. Note that λ ∈ R may be seen as the bifurcation parameter for a Hopf bifurcation, which might in particular vanish. Each interaction function H k : C n → C is assumed smooth (i.e. C ∞ ) for convenience, and satisfies H k (0) = 0 and DH k (0) = 0.

We will show that the ODE (S29) can be put in a particular normal form that allows us to predict the dynamics of the phases of the oscillators. Our technique for doing so involves two successive coordinate transformations:

$w k = z k -αP k (z) (S30) u k = w k -αQ k (w)$for some appropriately chosen polynomials P k and Q k . The first of these transformations is used to remove the term αH k (z) from the ODE (S29). This will generate additional terms in α 2 that may be expressed in the coefficients of H k and P k following certain combinatorial rules.

In order to describe this combinatorial behavior, we first introduce a useful bracket [•||•] on the space of polynomials, see Definition 2.6. The first coordinate transformation will also produce terms in α involving P k and β k z k |z k | 2 . Again our bracket allows for a precise description of these new terms, which we then remove using the second coordinate transformation. The precise bookkeeping enabled by the bracket will be crucial in determining what non-resonance conditions are needed for the second transformation. In fact, it will turn out that the nonresonance conditions needed for the first transformation are sufficient to ensure the second.

We first present the main result, Theorem 2.4, in Subsection 2.1. There we also develop the necessary definitions, notation and machinery needed for the proof, which is then presented in the remaining subsections.

## Preliminaries and results

In order to analyse the ODE (S29), it will be useful to write

$H k (z) = H d k (z) + O(|z| d+1 ) ,$where H d k (z) is a polynomial denoting the terms up to degree d in the Taylor expansion of H k (z) around the origin. We will mostly work with the value d = 5. Note that H d k (z) is therefore a polynomial in both the variables z 1 , . . . , z n and their complex conjugates z 1 , . . . , z n , with complex coefficients. In general, whenever we talk about a polynomial we will always mean a complex polynomial in its given complex variables and their complex conjugates. It will also be useful to write H(z) = (H k (z)) for the vector valued function that captures all interaction functions H k (z) as its components, and similarly set

$H d (z) = (H d k (z)).$As is often the case with normal form calculations, we will need to assume some conditions on the ω k (or more precisely the γ k ). These will depend on the coefficients of H 5 k (z). To this end, we define:

$Definition 2.1. Let R(z) = cz s 1 1 . . . z sn n z t 1 1 . . . z tn n (S31)$be a monomial term in H d k (z), where c is a complex number and s 1 , . . . , s n , t 1 , . . . , t n are nonnegative integers. The kth non-resonance condition of R(z) is the condition

$s 1 ω 1 + • • • + s n ω n -t 1 ω 1 -• • • -t n ω n -ω k = 0 . (S32)$Note that, as ω denotes the imaginary part of γ for all ∈ {1, . . . , n}, the kth nonresonance condition guarantees in particular that:

$s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k = 0 ,(S33)$which will play a role in much of the proofs and constructions below. In fact, varying λ and allowing the particular case λ = 0, we see that equations (S32) and (S33) are equivalent in general. Next, the kth non-resonance condition of a polynomial is defined as the union of the kth non-resonance conditions of all of its monomial terms. Finally, the non-resonance condition

$of a polynomial map H d (z) = (H d k (z))$is the union over all k ∈ {1, . . . , n} of the kth nonresonance conditions of H d k (z).

Example 2.2. Suppose the interaction functions are given by the polynomials

$H k (z) = n =1 c k, z k z ,(S34)$for some (possibly weighted) connection matrix c = (c k, ) ∈ C n×n . It follows that the kth non-resonance condition of H k (z) is given by

$ω k -ω -ω k = -ω = 0 for all such that c k, = 0 . (S35)$Hence, we see that the non-resonance condition of H(z) = (H k (z)) is satisfied if we simply have ω = 0 for all nodes ∈ {1, . . . , n}.

Example 2.3. Suppose the interaction functions are given by the polynomials

$H k (z) = n =1 c k, (z k z + z 2 k z ) ,(S36)$for some connection matrix c = (c k, ). The kth non-resonance condition of H k (z) is now given by

$ω k -ω -ω k = -ω = 0 and (S37) 2ω k -ω -ω k = ω k -ω = 0$for all such that c k,l = 0. If we assume for convenience that c encodes a symmetric, connected graph, then the non-resonance condition of H(z) is satisfied if ω = 0 for all nodes ∈ {1, . . . , n} and (S38) ω p -ω q = 0 for all edges e = [p, q] between nodes p and q .

We are now ready to formulate the main theorem. It tells us that, under the relevant nonresonance conditions, we may transform the ODE (S29) into a system with leading interaction terms involving only three-way "hyper-interactions" and with coupling constant α 2 . See Proposition 2.9 for an exact description of the new leading interaction terms in Theorem 2.4.

Theorem 2.4. Let H 5 k denote the fifth order Taylor expansion of the kth interaction function H k : C n → C. Assume the non-resonance conditions for H 5 = (H 5 k ) to hold. Then the ODE (S29) is locally conjugate to

$uk = γ k u k -β k u k |u k | 2 -α 2 G k (u) (S39) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) ,$with u k ∈ C and for some complex polynomials G k with only terms of degree 3 and higher. See Proposition 2.9 for an exact description of the G k .

Note that Equation (S39) gives a precise description of uk up to sixth order in u and α.

Remark 2.5. Theorem 2.4 tells us that, under the relevant non-resonance conditions, the α-terms can be 'pushed back' to order |α||u| 6 . Technically speaking, this means we can ignore these remainder terms only when αu 6 << α 2 u 4 , i.e. when u 2 << α. However, it will be clear from the proof in subsections 2.2 and 2.4 that if the non-resonance conditions hold for terms in H k beyond H 5 k , then we may arrange for a remainder in α with higher order terms in u. That is, we then get the remainder O(|α||u| N + |α| 2 |u| 5 + |α| 3 |u| 4 ) for a corresponding value of N > 6. As the interaction functions H k are taken to be polynomials in our examples, with the non-resonance conditions holding for all terms, we in fact expect a remainder of the form O(|α||u| N + |α| 2 |u| 5 + |α| 3 |u| 4 ) for arbitrarily high value of N . Hence, we may neglect all terms that are first order in α, and obtain a new coupled system with coupling constant α 2 .

The new interaction functions G k can be obtained from H by a combinatorial construction on the Taylor coefficients. This is best described using a bracket on polynomials that we define below. We will furthermore make extensive use of this bracket throughout the proof of Theorem 2.4. Definition 2.6. Let R(z) be a complex polynomial and let S(z) = (S 1 (z), . . . , S n (z)) be an ntuple (i.e., a vector) of complex polynomials S 1 (z), . . . , S n (z). We let [R||S](z) be the complex polynomial obtained by (formally) assuming each variable z j is time-dependent (i.e., z j = z j (t)) and satisfies żj = S j (z), after which we differentiate R(z) with respect to t. That is, we set

$[R||S](z) := d dt R(z) żj = S j (w) ∀ j ∈ {1, . . . , n} . (S40$$)$The reason we choose this notation, instead of one involving the Jacobian of R, is to avoid confusion with the complex conjugate variables z j . Because each term żj is substituted by S j (w),

the expression [R||S] is in general not complex linear in S.

In the special case where S(z) = (γ 1 z 1 , . . . , γ n z n ) (with γ k as in Equation (S29)), we set

$ΓR(z) := [R||S](z) = d dt R(z) żj = γ j z j ∀ j ∈ {1, . . . , n} . (S41$$)$Example 2.7. It is not hard to see that the polynomial ΓR(z) is obtained by replacing every

$monomial cz s 1 1 . . . z sn n z t 1 1 . . . z tn n , c ∈ C in R(z) by c(s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n )z s 1 1 . . . z sn n z t 1 1 . . . z tn n . Consider for instance the monomial R(z) = R(z 1 , z 2 , z 1 , z 2 ) = z 2 1 z 2 . We have d dt R(z) = 2z 1 ż1 z 2 + z 2 1 ż2 . (S42)$Hence, we indeed find

$ΓR(z) = d dt R(z) ż1 = γ 1 z 1 ż2 = γ 2 z 2 = 2z 1 (γ 1 z 1 )z 2 + z 2 1 (γ 2 z 2 ) (S43) = (2γ 1 + γ 2 )z 2 1 z 2 = (2γ 1 + γ 2 )R(z) .$The term G k in Theorem 2.4 will be given as the bracket

[•||•] between H 5 and a polynomial obtained by slightly modifying H 5 k . Hence, intuitively, G k should be thought of as [H k ||H]. More precisely, we define: Definition 2.8. Let P be a polynomial for which its kth non-resonance conditions are met. The (kth) modified polynomial P k is obtained from P by replacing each monomial cz s 1 1 . . . z sn n z t 1 1 . . . z tn n , c ∈ C in P by cz s 1 1 . . . z sn n z t 1 1 . . . z tn n

$s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k .$In the special case where P = H d k for some d ≤ 5, we will simply write H d k := (H d k ) k to denote the corresponding modified polynomial. Proposition 2.9. In Theorem 2.4 the terms G k are given by

$G k = [ H 3 k ||H 3 ] . (S44)$It can be shown that [ H 3 k ||H 3 ] indeed only has terms of degree 3 and higher, using the assumption that each H k (and therefore each H d k ) only has terms of degree 2 and higher. See Remark 2.15 below. Note that we only care about the third and fourth order terms of G k , as the rest are absorbed in the remainder terms of Equation (S39). It will be clear from Remark 2.15 that these lowest order terms do not change if we instead define

$G k = [ H d k ||H d ] ,(S45)$for d = 4 or d = 5. For this reason we will often simply write

$G k = [ H k ||H] . (S46)$Remark 2.10. Let I k ⊂ {1, . . . , n} denote the input set of a node k ∈ {1, . . . , n}. That is, I k denotes those nodes that influence k, or more precisely those nodes for which

$∂H k (z) ∂z = 0 or ∂H k (z) ∂z = 0 .$Note that I k might not contain k itself. It follows that in general G k (u) depends on variables for nodes in the set

$I 2 k := ∈I k I ∪ I k . (S47) This is because G k = [ H 3 k ||H 3$] is formed by replacing a term z (or z ) in H 3 k by H 3 (or H 3 ), and this is done for each ∈ I k . We have also used here that H 3 k likewise only depends on the variables corresponding to nodes in I k , or possibly a strict subset thereof.

In a similar way one sees that the third order terms of G k (that is, its leading order terms) are given by 'triplet terms' ũr ũs ũt , where we have r ∈ I k and s, t ∈ I for some ∈ I k . (Here each ũp may independently denote u p or its complex conjugate u p ). See Figure [6](#fig_6)  Example 2.11. As in Example 2.2, let us make the particular choice for the interaction functions

$H k (z) = H 3 k (z) = n =1 c k, z k z . (S48$$)$Here c = (c k, ) is the connectivity matrix of the network. We will assume that c k, ∈ {0, 1}, or more generally c k, ∈ R, if the network is weighted. We find

$H k (z) = H 3 k (z) = n =1 c k, γ z k z .(S49)$A direct calculation now shows that

$G k (u) = [ H k ||H](u) = n =1 c k, γ (H k (u)u + u k H (u)) (S50) = n =1 c k, γ n p=1 c k,p u k u p u + u k n p=1 c ,p u u p = n =1 n p=1 c k, c k,p γ u k u u p + n =1 n p=1 c k, c ,p γ u k u u p .$The first of these two terms counts all trees in the network that are formed by the node k and two nodes that influence node k. The second term counts all trees formed by the nodes k, and p, where k depends on and depends on p.

We will gather some more facts about the bracket [•||•]. One important observation is given by: Lemma 2.12. The map (R, S) → [R||S] is complex linear in R and real linear in S. In other words, given polynomials R, R and complex numbers λ, µ, we have

$[λR + µR ||S] = λ[R||S] + µ[R ||S] . (S51)$Given tuples S, S and real numbers a, b we have

$[R||aS + bS ] = a[R||S] + b[R||S ] . (S52)$Proof. Complex linearity in R is clear from the definition:

$[R||S](z) := d dt R(z) żj = S j (w) ∀ j ∈ {1, . . . , n} . (S53)$Because of this, it suffices to show real linearity in S when R is given by a monomial of the form R(z) = z i 1 z i 2 . . . z im z j 1 z j 2 . . . z j l , for some (not necessarily distinct) i 1 , . . . , i m , j 1 , . . . , j l ∈ {1, . . . , n}. We get

$[R||S](z) = m s=1 R(z) z is S is (z) + l r=1 R(z) z ir S ir (z) ,(S54)$from which real linearity in S follows readily.

We will also make extensive use of the following definition:

Definition 2.13. Given a complex monomial

$Q(z) = cz s 1 1 . . . z sn n z t 1 1 . . . z tn n ,$where c ∈ C and with s 1 , . . . , s n , t 1 , . . . , t n non-negative integers, we define the degree of Q(z)

$as the number s 1 + • • • + s n + t 1 + • • • + t n .$The degree of a polynomial P (z) is then defined as the maximum of the degrees of all the monomial terms of P (z), as is common. Similarly, we define the lower degree of a polynomial P (z) as the minimum of the degrees of all of its monomial terms.

It turns out our bracket has a predictable effect on degrees:

Lemma 2.14. Let R be a polynomial and S = (S 1 , . . . , S n ) a vector of polynomials. If R has degree p > 0 and each of the polynomial components of S has degree at most p , then [R||S] has degree p + p -1 or lower. If R has lower degree q > 0 and each of the polynomial components of S has lower degree at least q , then [R||S] has lower degree q + q -1 or higher.

Proof. By linearity of the bracket (see Lemma 2.12), it suffices to show that the degree of

$[R||S] is d + d -1 if$R is a monomial of degree d and the components of S are all monomials of degree d . (By convention, we treat the zero-polynomial as a polynomial of any degree.) As in the proof of Lemma 2.12, we write

$R(z) = z i 1 z i 2 . . . z im z j 1 z j 2 . . . z j l ,$for some (not necessarily distinct) i 1 , . . . , i m , j 1 , . . . , j l ∈ {1, . . . , n}. It follows that m + l = d.

As in the previous proof we find

$[R||S](z) = m s=1 R(z) z is S is (z) + l r=1 R(z) z ir S ir (z) ,($S55) from which it follows readily that the degree of [R||S] is indeed d + d -1. This completes the proof. Remark 2.15. Lemmas 2.12 and 2.14 give us an easy way of finding the third and fourth order terms of G k = [ H k ||H] (and higher terms if necessary). It follows that the third order terms of G k are given by [ H 2 k ||H 2 ], where we use that H (and therefore each H 2 k

) has no constant and linear terms. Likewise, the fourth order terms of G k are given by the bracket between the second order terms of H k and the third order terms of H, plus the bracket between the third order terms of H k and the second order terms of H. Note also that G k need only be defined up to third and fourth order in Theorem 2.4, as higher order terms of α 2 G k (u) can be absorbed in the remainder O(|α| 2 |u| 5 ) of Equation (S39). For this reason the terms of degree 4 and higher in H k and H play no role in the construction of (the relevant terms of)

$G k = [ H k ||H].$Next, we consider G k in the situation where H k describes a coupled cell system as in the examples of the main text.

Remark 2.16. Suppose each H k is of the special form

$H k (z) = n =1 c k, h(z k , z ) ,(S56)$where z = (z 1 , . . . , z n ). Here (c k, ) is a real adjacency matrix and h : C 2 → C has vanishing constant and linear terms. It follows that we may write

$H k (z) = n =1 c k, h k, (z k , z ) , (S57$$)$where h k, (z k , z ) is obtained from h(z k , z ) by applying a monomial substitution to its terms in precisely the same way H k is obtained from H k . By linearity of the bracket [•||•] in the first slot, we get

$G k = [ H k ||H] = [ n =1 c k, h k, (u k , u )||H] = n =1 c k, [ h k, (u k , u )||H] . (S58)$Moreover, we find

$[ h k, (u k , u )||H](u) = ∂ h k, (u k , u ) ∂u k H k + ∂ h k, (u k , u ) ∂u k H k + ∂ h k, (u k , u ) ∂u H + ∂ h k, (u k , u ) ∂u H (S59) = ∂ h k, (u k , u ) ∂u k n p=1 c k,p h(u k , u p ) + ∂ h k, (u k , u ) ∂u k n p=1 c k,p h(u k , u p ) + ∂ h k, (u k , u ) ∂u n p=1 c ,p h(u , u p ) + ∂ h k, (u k , u ) ∂u n p=1 c ,p h(u , u p ) = n p=1 c k,p ∂ h k, (u k , u ) ∂u k h(u k , u p ) + ∂ h k, (u k , u ) ∂u k h(u k , u p ) + n p=1 c ,p ∂ h k, (u k , u ) ∂u h(u , u p ) + ∂ h k, (u k , u ) ∂u h(u , u p ) = n p=1 c k,p 1 G p k (u k , u , u p ) + n p=1 c ,p 2 G p k (u k , u , u p ) ,$where we have set

$1 G p k (u k , u , u p ) := ∂ h k, (u k , u ) ∂u k h(u k , u p ) + ∂ h k, (u k , u ) ∂u k h(u k , u p ) and (S60) 2 G p k (u k , u , u p ) := ∂ h k, (u k , u ) ∂u h(u , u p ) + ∂ h k, (u k , u ) ∂u h(u , u p ) . (S61)$Combining equations (S58) through (S61), we obtain

$G k (u) = n =1 n p=1 c k, c k,p 1 G p k (u k , u , u p ) + n =1 n p=1 c k, c ,p 2 G p k (u k , u , u p ) . (S62$$)$We may interpret Equation (S62) as representing a new interaction structure, one where the interaction is now encoded through certain trees in the graph instead of links. In this regard, the emergent interaction function (S62) looks a lot like our original response function (S56), but counting such trees instead of links. The only way in which Equation (S62) does not generalize Equation (S56) perfectly is by the fact that 1 G p k and 1 G p k have indices k, and p (whereas h does not). However, we see from equations (S60) and (S61) that there is no dependence on p; this index is only there for notational purposes. Moreover, the dependence on k and is only through a rescaling of the monomials. Hence, we find an emergent interaction that is in very good agreement with a generalization of our original interaction to tree interaction. What is more, the trees that Equation (S62) counts are easily identified in the original graph. See Example 2.11, which describes a special case of interaction through (S56), and the corresponding Figure [3](#fig_3) of the main manuscript.

Example 2.17. We return to Example 2.3, where the interaction functions are given by

$H k (z) = n =1 c k, (z k z + z 2 k z ) . (S63)$This is of the form (S56) as discussed in Remark 2.16, with h given by

$h(z k , z ) = (z k + z 2 k )z . (S64)$Following the notation of Remark 2.16, we see that

$h k, (z k , z ) = z k z γ + z 2 k z γ k + γ . (S65$$)$We therefore find

$1 G p k (u k , u , u p ) = z γ + 2z k z γ k + γ (z k + z 2 k )z p = (z k + z 2 k )z z p γ + 2(z 2 k + z 3 k )z z p γ k + γ , (S66) 2 G p k (u k , u , u p ) = z k γ + z 2 k γ k + γ (z + z 2 )z p = z k (z + z 2 )z p γ + z 2 k (z + z 2 )z p γ k + γ .$As we may ignore terms of degree 5 and higher, we may also set

$1 G p k (u k , u , u p ) = (z k + z 2 k )z z p γ + 2z 2 k z z p γ k + γ , (S67$$) 2 G p k (u k , u , u p ) = z k (z + z 2 )z p γ + z 2 k z z p γ k + γ ,$which describe the new interaction through Equation (S62).

## A coordinate transformation

In this subsection and the next ones we prove Theorem 2.4 and the accompanying Proposition 2.9. Recall that we want to transform

$żk = γ k z k -β k z k |z k | 2 + αH k (z) , (S68$$)$into an ODE where the leading interaction terms are of order α 2 . Recall as well that H 5 k (z) denotes the Taylor expansion of H k (z) up to fifth order. In particular, we may write

$H k (z) = H 5 k (z) + O(|z| 6 ) . (S69)$It follows that H 5 k (z) is a complex polynomial of order 5 in the variables z 1 , . . . , z n and z 1 , . . . , z n . We write z = (z 1 , . . . , z n ), and similarly for other variables, and assume implicitly that any function of z may also depend on its complex conjugate z = (z 1 , . . . , z n ).

We start by rewriting the ODE (S68) using the transformation

$w k = z k -α H 5 k (z) = z k -αP k (z) , (S70$$)$where we have set P k := H 5 k for convenience. Note that each P k : C n → C is a complex polynomial of lower degree 2 (see Definition 2.13). It follows that Expression (S70) describes an invertible transformation around z = 0. The following lemma deals with its inverse. Lemma 2.18. Suppose the variables w = (w 1 , . . . , w n ) may be expressed in z = (z 1 , . . . , z n ) and α by

$w k = z k -αP k (z) , (S71$$)$for some polynomials P k of lower degree d ≥ 2. Then z can be expressed in w and α by the formal expression

$z k = w k + αP k (w) + α 2 R k,2 (w) + α 3 R k,3 (w) + . . . . (S72)$Here the R k,t (w) are polynomials with lower degree (d -1)t + 1 or higher.

Proof. We write

$z k = R k,0 (w) + αR k,1 (w) + α 2 R k,2 (w) + . . . ,(S73)$for some functions R k,t (w) : C n → C. To determine these functions, we substitute the z variables in Equation (S71) by Expression (S73). We obtain

$w k = z k -αP k (z 1 , . . . , z n ) (S74) = [R k,0 (w) + αR k,1 (w) + . . . ] -αP k ([R 1,0 (w) + αR 1,1 (w) + . . . ], . . . , [R n,0 (w) + αR n,1 (w) + . . . ]) .$Comparing constant terms in α (i.e. α 0 ), Expression (S74) gives us

$w k = R k,0 (w) . (S75)$This simplifies Equation (S74) to

$w k = [w k + αR k,1 (w) + . . . ] -αP k ([w 1 + αR 1,1 (w) + . . . ], . . . , [w n + αR n,1 (w) + . . . ]) . (S76$$)$Comparing α-terms now yields

$0 = R k,1 (w) -P k (w) , (S77) so that R k,1 (w) = P k (w) . (S78$$)$It remains to show that the higher order terms are indeed polynomials of the required lower degree. We will show this by induction on t. Note that R k,0 (w) = w k has (lower) degree

$(d -1)0 + 1 = 1. Likewise, R k,1 (w) = P k (w) is of lower degree (d -1)1 + 1 = d.$We therefore fix an integer T > 1 and assume that the function R k,t (w) is a complex polynomial of lower degree (d -1)t + 1 or higher for all t < T and k ∈ {1, . . . , n}. The α T terms in Equation (S76) are given by

$0 = R k,T (w) -[α T -1 ]P k ([w 1 + αR$1,1 (w) + . . . ], . . . , [w n + αR n,1 (w) + . . . ]) . (S79) Here [α T -1 ]F (α) denotes the α T -1 term in the expansion of a function F in α. As P k is a polynomial of lower degree d, the α T -1 term in P k ([w 1 + αR 1,1 (w) + . . . ], . . . , [w n + αR n,1 (w) + . . . ]) must be a finite sum of scalar multiples of expressions of the form Ri 1 ,t 1 (w) Ri 2 ,t 2 (w) . . . Ris,ts (w) , for s ≥ d and for some i 1 , . . . , i s ∈ {1, . . . , n} and t 1 , . . . , t s ∈ Z ≥0 satisfying t 1

$+ • • • + t s = T -1.$Each term Ri j ,t j (w) may furthermore independently denote R i j ,t j (w) or its complex conjugate R i j ,t j (w). As we have

$t 1 +• • •+t s = T -1, it in particular holds that t 1 , . . . , t s ≤ T -1.$By the induction hypothesis, we therefore know that each of the terms Ri j ,t j is a polynomial of lower degree (d -1)t j + 1 or higher. This means the expression

$Ri 1 ,t 1 (w) Ri 2 ,t 2 (w) . . . Ris,ts (w)$is a polynomial of lower degree D satisfying

$D ≥ [(d -1)t 1 + 1] + [(d -1)t 2 + 1] + • • • + [(d -1)t s + 1] = (d -1)(t 1 + t 2 + • • • + t s ) + s = (d -1)(T -1) + s ≥ (d -1)(T -1) + d = (d -1)T + 1 .$It follows from Equation (S79) that R k,T (w) is indeed a polynomial of lower degree (d-1)T +1

or higher for all k ∈ {1, . . . , n}. This proves the lemma by induction.

Setting d = 2, it follows that the inverse of Equation (S70) is given by

$z k = w k + αP k (w) + O(|α| 2 |w| 3 ) . (S80)$At some point later on, we will need to know Expression (S80) up to higher order terms. To this end, we will show how our bracket [•||•] from Definition 2.6 shows up when performing coordinate transformations.

Lemma 2.19. Let R(z) be a complex polynomial and suppose we may express the z-variables in some new w-variables by

$z k = w k + αS k (w) + O(|α| 2 ) , k ∈ {1, . . . , n} . (S81)$Here each S k is a complex polynomial and we have α ∈ R. Then R(z) is given in the wvariables by

$R(z) = R(w) + α[R||S](w) + O(|α| 2 ) ,(S82)$where we have set S = (S 1 , . . . , S n ).

Proof. We write R(z) as

$R(z) = T 0 (w) + αT 1 (w) + O(|α| 2 ) ,(S83)$where T 0 (w) and T 1 (w) are to be determined. Assume first that R(z) is given by

$R(z) = z i 1 z i 2 . . . z im z j 1 z j 2 . . . z j l ,$for some (not necessarily distinct) i 1 , . . . , i m , j 1 , . . . , j l ∈ {1, . . . , n}. We get

$R(z) = z i 1 . . . z im z j 1 . . . z j l (S84) = (w i 1 + αS i 1 (w)) . . . (w im + αS im (w))(w j 1 + αS j 1 (w)) . . . (w j l + αS j l (w)) + O(|α| 2 ) = w i 1 . . . w im w j 1 . . . w j l + α m s=1 R(w) w is S is (w) + l r=1 R(w) w ir S ir (w) + O(|α| 2 ) = R(w) + α[R||S](w) + O(|α| 2 ) ,$where in the last line we have used Expression (S54) from the proof of Lemma 2.12. As T 0 and T 1 are determined linearly by R, we may conclude from Lemma 2.12 that T 0 (w) = R(w) and T 1 (w) = [R||S](w) for general polynomials R. This completes the proof.

Example 2.20. Suppose we are given the polynomial

$Q(z) = Q(z 1 , z 2 , z 1 , z 2 ) = z 2 1 + z 1 z 2 . Equation (S81) gives Q(z) = (w 1 + αS 1 (w) + O(|α| 2 )) 2 + (w 1 + αS 1 (w) + O(|α| 2 )(w 2 + αS 2 (w) + O(|α| 2 )) (S85) = (w 1 + αS 1 (w)) 2 + (w 1 + αS 1 (w))(w 2 + αS 2 (w)) + O(|α| 2 ) = w 2 1 + w 1 w 2 + α(2w 1 S 1 (w) + w 1 S 2 (w) + S 1 (w)w 2 ) + O(|α| 2 ) = Q(w) + α d dt Q(w) ẇ1 = S 1 (w) ẇ2 = S 2 (w) + O(|α| 2 ) = Q(w) + α[Q||S](w) + O(|α| 2 ) ,$which is in accordance with Lemma 2.19.

Returning to the transformation (S70) with inverse Equation (S80), we may in fact conclude the following:

Lemma 2.21. Suppose we have a coordinate transformation of the form

$w k = z k -αP k (z) ,(S86)$where each P k : C n → C is a complex polynomial of lower degree 2 or higher. The inverse transformation is given by

$z k = w k + αP k (w) + α 2 [P k ||P ](w) + O(|α| 3 |w| 4 ) ,(S87)$where P = (P 1 , . . . , P n ).

Proof. It follows from Lemma 2.18 that we may write

$z k = w k + αP k (w) + α 2 R k,2 (w) + O(|α| 3 |w| 4 ) ,(S88)$for some function R k,2 (w). Hence, we only have to show that R k,2 (w) = [P k ||P ](w). To this end, we rewrite Expression (S86) as

$z k = w k + αP k (z) . (S89)$Next, we use Equation (S88) to write

$z k = w k + αP k (w) + O(|α| 2 ) . (S90)$Applying Lemma 2.19 to the term P k (z) and the transformation (S90) yields

$P k (z) = P k (w) + α[P k ||P ](w) + O(|α| 2 ) .(S91)$Combined with Equation (S89), we obtain

$z k = w k + α(P k (w) + α[P k ||P ](w) + O(|α| 2 )) (S92) = w k + αP k (w) + α 2 [P k ||P ](w) + O(|α| 3 ) .$Comparing the two expressions (S88) and (S92) for z k , we see that indeed

$z k = w k + αP k (w) + α 2 [P k ||P ](w) + O(|α| 3 |w| 4 ) .(S93)$This proves the lemma.

Our next step is to differentiate Equation (S70) with respect to time. This gives us

$ẇk = żk -α d dt P k (z) .(S94)$We will first focus on the term

$d dt P k (z) ,(S95)$and then deal with the term żk .

The term ∂ t P k We first focus on the term (S95). We start by rewriting Equation (S68) as

$żk = γ k z k -β k z k |z k | 2 + αH k (z) (S96) = γ k z k -β k z k |z k | 2 + αH 5 k (z) + O(|α||z| 6 ) ,$where we recall that H 5 k (z) denotes the Taylor expansion of H k (z) up to fifth order. From Equation (S96) and Lemma 2.12 we get

$d dt P k (z) = d dt P k (z) żj = γ j z j -β j z j |z j | 2 + αH j (z) ∀ j ∈ {1, . . . , n}(S97)$$= d dt P k (z) żj = γ j z j -β j z j |z j | 2 + αH 5 j (z) ∀ j ∈ {1, . . . , n} + O(|α||z| 7 ) = [P k ||(. . . , γ j z j -β j z j |z j | 2 + αH 5 j (z), . . . )](z) + O(|α||z| 7 ) = [P k ||(. . . , γ j z j , . . . )](z) -[P k ||(. . . , β j z j |z j | 2 , . . . )](z) + α[P k ||(. . . , H 5 j (z), . . . )](z) + O(|α||z| 7 ) = ΓP k (z) -L 1 k (z) + α[P k ||H 5 ](z) + O(|α||z| 7 ) ,$where we have set

$L 1 k (z) := [P k ||(. . . , β j z j |z j | 2 , . . . )](z)$and H 5 := (. . . , H 5 j (z), . . . ) .

We have moreover used that P k (z) has lower degree at least 2 to arrive at the remainder term O(|α||z| 7 ), and we refer to Definition 2.6 for the meaning of the term ΓP k (z). Note that L 1 k (z) is a polynomial of lower degree at least 4, whereas [P k ||H 5 ](z) has lower degree 3 or higher.

Next, we return to Equation (S80), which we recall states

$z k = w k + αP k (w) + O(|α| 2 |w| 3 ) = w k + O(|α||w| 2 ) . (S98$$)$We obtain

$L 1 k (z) = L 1 k (w) + O(|α||w| 5 ) (S99) [P k ||H 5 ](z) = [P k ||H 5 ](w) + O(|α||w| 4 ) . (S100)$From Lemma 2.19 we furthermore get

$ΓP k (z) = ΓP k (w) + α[ΓP k ||P ](w) + O(|α| 2 |w| 4 ) ,(S101)$where we have set P = (P 1 , . . . , P n ). The remainder term in Equation (S101) follows from the lower degrees of ΓP k (z) and P k (z), and the remainder in Equation (S98).

Note that [ΓP k ||P ](w) is a polynomial of lower degree 3 or higher. Combining equations (S97), (S99), (S100) and (S101), we arrive at:

Lemma 2.22. The term

$d dt P k (z)$may be expressed in the new w coordinates by

$d dt P k (z) = ΓP k (z) -L 1 k (z) + α[P k ||H 5 ](z) + O(|α||z| 7 ) (S102) = ΓP k (w) -L 1 k (w) + α[P k ||H 5 ](w) + α[ΓP k ||P ](w) + O(|α||w| 5 + |α| 2 |w| 4 ) .$The term żk Next, we focus on the term żk . Again we write.

$żk = γ k z k -β k z k |z k | 2 + αH k (z) (S103) = γ k z k -β k z k |z k | 2 + αH 5 k (z) + O(|α||z| 6 ) ,$where H 5 k (z) denotes the Taylor expansion of H k (z) up to fifth order. Recall the result of Lemma 2.21, which tells us that

$z k = w k + αP k (w) + α 2 [P k ||P ](w) + O(|α| 3 |w| 4 ) . (S104)$Combined, and using Lemma 2.19, we get

$żk = γ k z k -β k z k |z k | 2 + αH 5 k (z) + O(|α||z| 6 ) (S105) = γ k (w k + αP k (w) + α 2 [P k ||P ](w)) + O(|α| 3 |w| 4 ) -β k w k |w k | 2 -α[β k w k |w k | 2 ||P ](w) + O(|α| 2 |w| 5 ) + αH 5 k (w) + α 2 [H 5 k ||P ](w) + O(|α| 3 |w| 4 ) + O(|α||w| 6 ) = γ k w k -β k w k |w k | 2 + α(γ k P k (w) + H 5 k (w)) -α[β k w k |w k | 2 ||P ](w) + α 2 (γ k [P k ||P ](w) + [H 5 k ||P ](w)) + O(|α||w| 6 + |α| 2 |w| 5 + |α| 3 |w| 4 ) .$We will write

$L 2 k (w) := [β k w k |w k | 2 ||P ](w) ,(S106)$which has lower degree 4 or higher, to arrive at: Lemma 2.24. Let Q be a polynomial for which the kth non-resonance condition is satisfied. In particular, it follows that the corresponding modified polynomial Q k is well-defined. We then have

$γ k Q k + Q -Γ Q k = 0 . (S111)$Proof. By definitions 2.6 and 2.8, we see that it suffices to show this when Q is given by a single monomial

$Q(z) = z s 1 1 . . . z sn n z t 1 1 . . . z tn n ,$where t 1 , . . . , t n , s 1 , . . . , s n are non-negative integers. More precisely, we use here that the maps Q → Q k and Q → ΓQ = [Q|| . . . , γ j z j , . . . ] are complex linear, when defined. By Definition 2.8 we find

$Q k (z) = z s 1 1 . . . z sn n z t 1 1 . . . z tn n s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k = Q(z) s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k .$Example 2.7 now tells us that

$Γ Q k (z) = (s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n )z s 1 1 . . . z sn n z t 1 1 . . . z tn n s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k (S112) = (s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n )Q(z) s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k .$We therefore conclude that

$Γ Q k (z) -γ k Q k (z) = (s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n )Q(z) s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k (S113) - γ k Q(z) s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k = (s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k )Q(z) s 1 γ 1 + • • • + s n γ n + t 1 γ 1 + • • • + t n γ n -γ k = Q(z) .$Thus, we precisely find

$γ k Q k + Q -Γ Q k = -(Γ Q k -γ k Q k ) + Q = -Q + Q = 0 ,(S114)$which completes the proof.

As we have used the shorthand notation H 5 k := (H 5 k ) k , we see that indeed

$γ k P k + H 5 k -ΓP k = γ k H 5 k + H 5 k -Γ H 5 k = 0 . (S115)$Returning to Equation (S110), we find that it simplifies to

$ẇk = γ k w k -β k w k |w k | 2 + α(L 1 k (w) -L 2 k (w)) -α 2 [P k ||H 5 ](w)($S116) + O(|α||w| 6 + |α| 2 |w| 5 + |α| 3 |w| 4 ) , where we recall that L 1 k and L 2 k are defined as L 1 k (w) := [P k ||(. . . , βw j |w j | 2 , . . . )](w) and (S117)

$L 2 k (w) := [β k w k |w k | 2 ||P ](w) ,$which are both polynomials of lower degree 4 or higher.

## The second reduction

Next, we wish to get rid of the term α(L 1 k (w) -L 2 k (w)) in Equation (S116). This follows along the same lines as in the previous reduction. We start by defining new variables

$u k = w k -αQ k (w) (S118)$where each Q k is a polynomial of lower degree 4 or higher. Note that by Lemma 2.18 we may write

$w k = u k + αQ k (u) + O(|α| 2 |u| 7 ) . (S119$$)$Using Equation (S116) we obtain

$uk = ẇk -α d dt Q k (w) ẇj = γ j w j ∀ j ∈ {1, . . . , n} + O(|α||w| 6 ) (S120) = ẇk -αΓQ k (w) + O(|α||w| 6 ) = γ k w k -β k w k |w k | 2 + α(L 1 k (w) -L 2 k (w)) -α 2 [P k ||H 5 ](w) -αΓQ k (w) + O(|α||w| 6 + |α| 2 |w| 5 + |α| 3 |w| 4 ) .$Next, substituting w k by the right hand side of Equation (S186) yields

$uk = γ k w k -β k w k |w k | 2 + α(L 1 k (w) -L 2 k (w)) -α 2 [P k ||H 5 ](w) -αΓQ k (w) (S121) + O(|α||w| 6 + |α| 2 |w| 5 + |α| 3 |w| 4 ) = γ k u k + αγ k Q k (u) -β k u k |u k | 2 + α(L 1 k (u) -L 2 k (u)) -α 2 [P k ||H 5 ](u) -αΓQ k (u) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) = γ k u k -β k u k |u k | 2 + α(L 1 k (u) -L 2 k (u) + γ k Q k (u) -ΓQ k (u)) -α 2 [P k ||H 5 ](u) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) .$Lemmas 2.25 and 2.26 guarantee that the kth non-resonance condition of S k (u) = L 1 k (u) -L 2 k (u) is satisfied if the kth non-resonance condition of P k = H 5 k is satisfied. As H 5 k has the same monomial terms as H 5 k (though rescaled), we see that the kth non-resonance conditions of S k (u) are indeed satisfied. Therefore, a solution to Equation (S122) exists by Lemma [(2.24)](#) and may be given by Q k = S k . Note that this choice of Q k has lower degree 4 or higher, as we assumed throughout.

Returning to Equation (S121), we finally arrive at

$uk = γ k u k -β k u k |u k | 2 -α 2 [P k ||H 5 ](u) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) . (S132)$We have therefore shown:

Proof of Theorem 2.4 and Proposition 2.9. The calculations in this section show that the successive coordinate transformations

$w k = z k -αP k (z) (S133) u k = w k -αQ k (w) bring the ODE żk = γ k z k -β k z k |z k | 2 + αH k (z)$into the form

$uk = γ k u k -β k u k |u k | 2 -α 2 [P k ||H 5 ](u) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) . If we now set G k (u) := [P k ||H 5 ] = [ H 5 k ||H 5 ] ,$then we indeed get

$uk = γ k u k -β k u k |u k | 2 -α 2 G k (u) + O(|α||u| 6 + |α| 2 |u| 5 + |α| 3 |u| 4 ) .$This completes the proof.

## Anomalous synchronization on a 4-node ring

Consider the four node ring network with a coupling function h(z, w) = z w. leading to

$ż1 = γ 1 z 1 -βz 1 |z 1 | 2 + α(z 1 z 2 + z 1 z 4 ) (S134) ż2 = γ 2 z 2 -βz 2 |z 2 | 2 + α(z 2 z 3 + z 2 z 1 ) ż3 = γ 3 z 3 -βz 3 |z 3 | 2 + α(z 3 z 4 + z 3 z 2 ) ż4 = γ 4 z 4 -βz 4 |z 4 | 2 + α(z 4 z 1 + z 4 z 3 )$We set the parameters β k = -1, γ k = λ + iω k , λ = 1 and ω 1 = 1 + δ, ω 2 = 1 and ω 3 = 5

and ω 4 = 6 for performing the simulation of Eq. (S134). We then vary the mismatch δ and coupling α. Notice that by a naive inspection of the original equations we obtain

$θk = ω k + α 4 =1$A k sin θ thus, instead of a diffusive interaction we would obtain a interaction akin to forcing [[37]](#b36). For each set of α and δ values, we simulate the network for 50000s with 0.01 time step. We remove first 10000s from as transient and compute the unwrapped phases. As we are interested in the phase synchronization, we introduce a new variable for the phase differences, φ = θ 1 -θ 2 , and a naive calculation leads to

$φ = δ + α[sin θ 2 + sin θ 4 -sin θ 1 -sin θ 3 ] + O(α 2 ).$Because ω 2 , ω 3 ω 1 , we can average over the fast oscillations and neglect contributions from these phases then θ 2 = θ 1 + φ we would obtain a interaction term as α[sin θ 1 cos φ + cos θ 1 sin φ] + O(α 2 ), however, since θ 1 is a fast variable for φ we also average over θ 1 . Thus the whole interaction term linear in α vanishes.

We calculate the mean synchronization error as

$E = 1 T T t=1 |φ(t)|. (S135)$The synchronization error for varying δ = -0.2 to 0.2 with 0.01 step size and α = 0.0 to 0.5 with step size 0.025, we observed a synchronization tongue scales with α ∝ √ δ (Supplementary Fig. [7](#fig_7)). 1, synchronization occurs for small coupling strength. However, if the mismatch is high then also stronger coupling is needed to emerge synchronization. The borderline between synchrony and asynchrony scales with α ∝ √ δ.

## Explanation of anomalous synchronization via normal form theory

Recall that we may bring this ODE into the form

$u1 = γ 1 u 1 -βu 1 |u 1 | 2 (S136) -α 2 u 1 u 2 u 4 γ 2 + u 4 u 2 γ 4 + u 2 u 2 γ 2 + u 4 u 4 γ 4 + u 2 u 3 γ 2 + u 2 u 1 γ 2 + u 4 u 3 γ 4 + u 4 u 1 γ 4 + h.o.t. u2 = γ 2 u 2 -βu 2 |u 2 | 2 -α 2 u 2 u 1 u 3 γ 1 + u 3 u 1 γ 3 + u 1 u 1 γ 1 + u 3 u 3 γ 3 + u 3 u 4 γ 3 + u 3 u 2 γ 3 + u 1 u 4 γ 1 + u 1 u 2 γ 1 + h.o.t. u3 = γ 3 u 3 -βu 3 |u 3 | 2 -α 2 u 3 u 2 u 4 γ 2 + u 4 u 2 γ 4 + u 2 u 2 γ 2 + u 4 u 4 γ 4 + u 2 u 3 γ 2 + u 2 u 1 γ 2 + u 4 u 3 γ 4 + u 4 u 1 γ 4 + h.o.t. u4 = γ 4 u 4 -βu 4 |u 4 | 2 -α 2 u 4 u 1 u 3 γ 1 + u 3 u 1 γ 3 + u 1 u 1 γ 1 + u 3 u 3 γ 3 + u 3 u 4 γ 3 + u 3 u 2 γ 3 + u 1 u 4 γ 1 + u 1 u 2 γ 1 + h.o.t.$We will assume that γ 1 ≈ γ 2 . In particular, we consider the possibility that γ 1 = γ 2 . In that case we have γ 1 +γ 2 = 2 Re(γ 1 ), which may be arbitrarily small. Therefore, we may not assume that γ 1 +γ 2 = 0. Other than this, there are no relevant restrictions. I.e., γ 1 , . . . , γ 4 , γ 2 -γ 3 . . . γ 3 -γ 4 are all sufficiently large. It follows that we may bring equation (S136) into the form

$v1 = γ 1 v 1 -βv 1 |v 1 | 2 - v 1 v 2 v 1 γ 2 + O(| , v| 5 ) (S137) v2 = γ 2 v 2 -βv 2 |v 2 | 2 - v 2 v 1 v 2 γ 1 + O(| , v| 5 ) v3 = γ 3 v 3 -βv 3 |v 3 | 2 - v 3 v 2 v 1 γ 2 + O(| , v| 5 ) v4 = γ 4 v 4 -βv 4 |v 4 | 2 - v 4 v 1 v 2 γ 1 + O(| , v| 5 ) ,$where = α 2 . Note that the network topology has changed drastically. Moreover, performing a phase reduction and introducing the phase difference ψ = θ 1 -θ 2 we obtain

$ψ = δ -cα 2 sin ψ$where c is a constant depending on γ 1 . By analyzing the fixed points of this equation we obtain the synchronization tongue behavior where the critical coupling α c for synchronization scales as √ δ.

4 Phase reduction for h = (z 2 +z) w and resonance ω 1 -ω 2,4 + ω 3 = 0

For simplicity we fix β k = -1 and obtain γ k = r 2 0 + iω k . We also introduce ∆ pq = ω p -ω q . Note that r(t) = r 0 + h.o.t along with z ż = ir 2 0 θ + h.o.t. and

$1 γ p + γq = 2r 2 0 -i∆ pq 4r 4 0 + ∆ 2 pq (S138)$Replacing these observations into Eq. ( [6](#formula_6)) of the main manuscript and performing the reduction we obtain the functions in Eq. (7-8) of the main manuscript as We consider networks of n coupled oscillators

$ρ pq (φ) = - ∆ pq 4r 4 0 + ∆ 2 pq cos φ + 2r2$$żk = f k (z k ) + α n =1 A k h k (z k , z ) (S140)$where z k ∈ C is the state of the kth oscillator, f k : C → C is its isolated vector field, h k :

C×C → C is the pairwise coupling function, A = (A ij ) n i,j=1 is the adjacency matrix describing the network structure, and α > 0 is the coupling strength. We then generate a multivariate time series for a four-node ring network, as illustrated in Figure [8](#fig_10)   (b) Hypernetwork recovered from original dynamics data. The state of a given node is influenced by triplet interactions. We show that as along as some sparsity is imposed when the model is obtained from data, only hypernetworks can be found. Our theory predicts the emergence of the hypernetwork determined by the original coupling function h, the network, and the resonance relations among the isolated frequencies.

We fix λ = 0.15, ω 1 = 1.01, ω 2 = 2.5, ω 3 = 1.5, ω 4 = 2.49, and α = 0.18. Numerical integration of complex differential equations is used to solve the differential equations for 10000-sec with 0.01-sec time-step. We discard the first 5000-sec points as transient, and we obtain a multivariate time series {z 1 (t), z 2 (t), z 3 (t), z 4 (t)} 5000 t=1 . Next, we aim at obtaining a model from the multivariate time series of z. Because α is small and the isolated orbit is exponentially stable, the amplitude of each time series is slightly affected by |z k | ≈ √ λ + O(α) as illustrated in Figure. 9 (a), and the dynamics is captured by the phases θ k (t) of z k (t). Therefore, we perform a polar decomposition z k (t) = r k (t)e iθ k (t) to get the unwrapped phase of each time series and obtain governing equations of the model from its phase dynamics.

Each phase θ k has a frequency close to ω k , as illustrated in Figure [9 (b)](#fig_11). This means that the growth of the phases is almost linear with coupling terms as perturbations. In fact, the coupling terms generically contain fast variables such as phases θ's and slow variables involving the resonant combinations of phases such as θ 1 -θ 2 + θ 3 that change slowly in time. Therefore, we subtract the linear growth of the phases to analyse the effects of the coupling. To this end, we

$introduce ϑ k (t) = θ k (t) -Ω k t,(S142)$where Ω k is obtained from data under the resonance condition Ω 1 -Ω i + Ω 3 = 0, with i = 2, 4. and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions (see Supplementary Fig. [8 (b)](#fig_10)).

of the slow phase and the simulations and theory. In Figure [9 c](#fig_11)), we compare our predictions and slow phases estimated from data. The theoretical prediction is in excellent agreement with the data with an error in the prediction of less than 5% per cycle of the slow phase.

6 Model recovery of a 3-path with coupling h = (z 2 + z) w and resonance ω 1 -ω 2 + ω 3 = 0 Now we consider the model for 3-nodes on a chain (Supplementary Fig. [10](#fig_14)) that reads as We consider the network ODE We will assume either one of 1. γ 2 ≈ γ 5 , γ 1 ≈ γ 6 and γ 3 ≈ γ 4 , with γ 1 ≈ γ 2 (and hence γ 1 , γ 6 ≈ γ 2 , γ 5 ), γ 2 ≈ γ 3 and γ 1 ≈ γ 3 .

$ż1 = γ 1 z 1 -βz 1 |z 1 | 2 + α(z 1 z 2 + z 2 1 z 2 ) (S145) ż2 = γ 2 z 2 -βz 2 |z 2 | 2 + α([z 2 z 1 + z 2 2 z 1 ] + [z 2 z 3 + z 2 2 z 3 ]) ż3 = γ 3 z 3 -βz 3 |z 3 | 2 + α(z 3 z 2 + z 2 3 z 2 ) ,$2. γ 2 ≈ γ 5 and γ i ≈ γ j for all i, j ∈ {1, . . . , 6} with i = j and (i, j) = (2, 5), [(5,](#b4)[2)](#b1).

In each case, we may transform ODE (S151) into where = α 2 leading to the emergent higher order network displayed in Figure [12b](#fig_14)). As the basis is formed by homogeneous polynomials, using Eq. (S157) we conclude that there is L such that Φ(X) -Φ(Y ) 2 ≤ Lε 2

$v1 = γ 1 v 1 -βv 1 |v 1 | 2 - v 1 v 2 v 5 γ 2 + O(| , v| 5 ) (S152) v2 = γ 2 v 2 -βv 2 |v 2 | 2 - v 2 v 5 v 2$
## Model recovery and normal form representation

By (H3) Φ(X) is full rank and for ε 2 small enough, we conclude that Φ(Y ) is also full rank since the rank is lower semicontinuous. Next notice that the equation Using Eq. (S157) we obtain

$Φ(Y )ζ i + ρ i (Y ) = u i($$v i = u i + z i (S159)$where z i corresponds to terms as DP (y) ẏ. By (H2) trajectories stay in the neighbourhood V ε , thus, there is a constant C such that z i 2 ≤ Cε 2 , ∀i ∈ {1, . . . , m}

Step 2: A sparse solution. Consider the unique solution ζ i of Eq. (S158) and let σ i = ζ i 0 .

Consider the set B λ,σ i = {q ∈ R k : q 0 ≤ σ i and Φ(X)q -v i 2 ≤ λ} Now we claim that if λ := (L

$ζ i 2 + C + M )ε d then ζ i ∈ B λ,σ i . Indeed, consider Φ(X)ζ i -v i 2 = Φ(X)ζ i + Φ(Y )ζ i -Φ(Y )ζ i -v i 2 = [Φ(X) -Φ(Y )]ζ i + Φ(Y )ζ i -u i -z i + ρ i -ρ i 2 = [Φ(X) -Φ(Y )]ζ i -z i -ρ i 2 ≤ Φ(X) -Φ(Y ) 2 ζ i 2 + z i 2 + ρ i 2 ≤ (L ζ i 2 + M + C)ε 2$Step 3: Uniqueness. Assume that there is η ∈ B λ,σ i with η 0 < σ i . Since Φ(X) is full rank, this implies that there is R such that R(x) 2 ≤ K x d+1 2 for some K and ẋ = Ĝ(x) + R(x).

Thus, Ĝ has fewer coefficients than G, implying that either G must have a non-resonant term or (H0) was violated. This contracts (H1) and completes the proof.

Remark 8.2. Assumption H2 is natural in our context. Notice since the isolated system has a limit cycle near the origin. Thus, an open set of initial conditions is attracted to the cycles and stays for all times near the origin where we control the norm of solutions [[13]](#b12). When coupling such dynamics to a network this behaviour persists.

Remark 8.3. Assumption H3 is in general not restrictive. If solutions of ẋ = F (x) are not degenerated such as all solutions converge to fixed points, then typically Φ(X) is full rank. In fact, if solutions converge to an attractor, we can adapt the basis to the dynamics such that in the adapted basis Φ * (X)Φ(X) is close to identity for large T [[38]](#b37). This implies that Φ(X) is close to orthogonal. 

![d) shows the time series of the electrode potential for K=5.2 and τ =1.65 s. The slow oscillators (1 and 3) have larger amplitudes and the time series exhibit nonlinear waveform modulations without any obvious synchronization pattern (one-cluster state).]()

![Figure 1: Emergent hypernetworks in an electrochemical network experiment. (a) Experimental setup. (b) Schematic illustration of the electrochemical experiment with the nonlinear feedback. The blue, orange, yellow, and green lines represent the elements 1 to 4, respectively. The electrode potential signals (E k ) of the four (nearly) isolated electrodes are nonlinearly modulated and fed back with a delay τ to the corresponding circuit potential (V k ), which drives the metal dissolution. (The delay is implemented by storing the past data in the memory of the computer.) (c) Representation of the in a ring network topology used in the experiment. (d) Electrode potential time series. (e) Filtered and fitted (dark red line) instantaneous frequency using LASSO for hypernetwork reconstruction corresponding from top to bottom to oscillators 1 to 4, respectively. (f) Experimental recovery of the phase interactions given by a hypernetwork.]()

![Figure2: Emergent higher-order interactions from the original ring network. Coupling functions appearing in Eq. (12) of node 1. Colors correspond to signs in the phase combination with blue standing for positive and orange for negative. (a) resonant interaction term appearing as 2 G23 1 . (b) resonant interaction term appearing as 2 G 43 1 . Finally, (c) is a nonresonant term and (d) 2 G24 1 is a forbidden term (it does not appear). These new interaction terms can be predicted from the combinatorics of the original network and coupling function.]()

![Figure3: Normal form theory explains the experimental results. We show the time series of the slow phase φ 1 and φ 2 from experimental data (solid) and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions. The vector field describing the phase interaction is obtained from first principles. The coefficients of the vector field are obtained by least-square minimization.]()

![Figure 4: Interacting subpopulations lead to higher order interaction of mean-fields. a)The original network of coupled subpopulations (with four distinct colours, namely, red, yellow, blue and orange). Oscillators are interacting by an internal coupling constant µ and intersubpopulations coupling constant α. b) Higher order phase interaction of the mean-fields represented with the same colors as in a) (red, yellow, blue and orange). Applying our approach we uncover that the phase interaction between the mean-fields is described by a hypernetwork. c) The mean-field slow phase variables ϕ 1 (green) and ϕ 2 (purple) were computed from the data collected from the simulations of mean fields on the associated network. The dashed curve is the simulation of the vector field of the slow phases ϕ 1,2 reconstructed from data using the Lasso method.]()

![Figure 5: Dynamical behavior without coupling in the experiments. a) Natural frequency of each oscillators without coupling ω 1 =0.152 Hz, ω 2 =0.385 Hz, ω 3 =0.237 Hz and ω 4 =0.384 Hz. The blue, orange, yellow and green dots represent the elements 1 to 4 respectively. b) Time series of the phase difference with respect oscillator one. The blue line: θ 1 -θ 1 = 0, orange line: θ 2 -θ 1 , yellow line: θ 3 -θ 1 and green line: θ 4 -θ 1 . c) Electrode potential time series. Blue, orange, yellow, and green line corresponds to oscillator one to four respectively. d) Time series of the slow phases, φ 1 (blue) and φ 2 (green) without coupling.]()

![Figure 6: Schematic depiction of the hidden 'triplet terms' that show up in G k .]()

![Figure 7: Arnold tongue represents the phase synchronization between nodes 1 and 2. The tongue is illustrated for varying mismatch δ and coupling strength α. As the absolute value of |δ|1, synchronization occurs for small coupling strength. However, if the mismatch is high then also stronger coupling is needed to emerge synchronization. The borderline between synchrony and asynchrony scales with α ∝]()

![pqr (φ) = -χ pqr sin φ + υ pqr cos φ Slow phase dynamics for h = (z 2 + z) w and resonance ω 1ω 2,4 + ω 3 = 0]()

![(a), with nonlinear pairwise coupling function h(z, w) = (z + z 2 ) w.]()

![Figure 8: Emergent hypernetworks with triplet interactions. (a) The original ring network.(b) Hypernetwork recovered from original dynamics data. The state of a given node is influenced by triplet interactions. We show that as along as some sparsity is imposed when the model is obtained from data, only hypernetworks can be found. Our theory predicts the emergence of the hypernetwork determined by the original coupling function h, the network, and the resonance relations among the isolated frequencies.]()

![Figure 9: Time series and emergent hypernetwork prediction. The simulation was performed on a ring network (see Supplementary Fig. 8 (a)). (a) Amplitudes (solid lines) are slightly affected by the coupling and remaining close to a circle with radius r = √ λ (dashed circle). (b) Unwrapped phases θ i growth. (c) Time series of the slow phase φ 1 from data (solid) and the prediction of the emergent hypernetwork (dashed) capturing higher-order interactions (see Supplementary Fig. 8 (b)).]()

![Figure12: Emergent hypernetworks with triplet interaction. Inset a) shows the original network. Each isolated node dynamics is close to a Hopf bifurcation. The pairwise coupling function h(z, w) = z w. Inset b) shows the hypernetwork reconstructed from the phase dynamics of the original dynamics. The state of a given node is influenced by the triple interaction of its own state in combination of the incoming links. Our theory also predicts the emergent of such hypernetwork. The hypernetwork emerges as a combination of the original coupling function h(z, w) = z w., the network, and the resonance relations of the isolated frequencies.]()

![O(| , v| 5 ) v3 = γ 3 v 3 -βv 3 |v 3 | O(| , v| 5 ) v4 = γ 4 v 4 -βv 4 |v 4 | O(| , v| 5 ) v5 = γ 5 v 5 -βv 5 |v 5 | 2 -v 5 v 2 v 5 γ 2 + O(| , v| 5 ) v6 = γ 6 v 6 -βv 6 |v 6 | 2 -v 6 v 5 v 2 γ 5 + O(| , v| 5 ) ,]()

![Let x ∈ R m and considerẋ = F (x) (S153)We assume for simplicity that F : R m → R m is a polynomial map andẋi = k j=1 a ij p j (x),(S154)where x i is the ith coordinate of x and p j 's form a basis of homogeneous polynomials. Notice that in a network context, x ∈ R m would represent the state vector of the network and F would model isolated dynamics and interactions. Once a trajectory x(t) and ẋ(t) are known, we perform a model recovery as follows. Fix a sampling h and introduceẋ2 (0) . . . ẋm (0) ẋ1 (h) ẋ2 (h) . . . ẋm (h) . . . . . . . . . . . . ẋ1 (T ) ẋ2 (T ) . . . ẋm (T ) (0) x 2 (0) . . . x m (0) x 1 (h) x 2 (h) . . . x m (h) . . . . . . . . . . . . x 1 (T ) x 2 (T ) . . . x m (T )The trajectories {x(t)} T t=0 as well as { ẋ(t)} T t=0 are given with T sufficiently large and stay in a sufficiently small neighbourhood V ε of the origin such that sup t∈[0,T ] x(t) C 1 ≤ ε for initial conditions in an open neighbourhood of the origin. (H3) The operator Φ is full rank.Then there exist λ = λ(ε, d) > 0 such the solution to the sparse recovery problemmin q∈R k q 0 subjected to Φ(X)q -v i 2 ≤ λis the vector of coefficients of (b i1 , b i2 , . . . , b ik ) * of the normal form of Eq. (S154) Proof. We break the arguments into three steps:Step1: Approximations and Uniqueness solutions. By normal form theory there are func-tions Q 1 and Q 2 such that x = y + Q 1 (y) and y = x + Q 2 (x) (S157)where Q 1 (y) = O( y 2 ) and Q 2 (x) = O( x 2 ). Given a trajectory y(t) we construct the matrix Y in the same manner as X and consider]()

![S158) also has a solution ζi = (b i1 , b i2 , . . . , b ik ) * by construction and it is unique since Φ(Y ) is full rank. Furthermore, in V ε there is a constant M such that ρ i (Y ) 2 ≤ M ε 2 , ∀i ∈ {1, . . . , m}]()

![Another interesting case is whenẋ = F (x) + U (t, x)and U has fast oscillations. This happens typically in phase dynamics when we subtract the trends of linear frequencies. For example, considerθ = 1 + sin(θ -φ) + cos(θ + φ) (S160) φ = 1 + δ + sin(φ -θ) + cos(θ + φ) (S161Subtracting the trend ϑ = θ -t and ϕ = φ -t leads toθ = sin(ϑ -ϕ) + cos(ϑ + ϕ -2t) (S162) φ = δ + sin(ϕ -ϑ) + cos(ϑ + ϕ -2t) (S163)Since φ and θ are O(δ) by the averaging Theorem, fast oscillating terms containing cos are averaged out and can be neglected in a time scale as 1/δ. Thus, also in this case when performing a model recovery with finite amount of data the function U cannot be recovered. This also happens for our examples in the main text. Thus, sparsity and fast oscillations can contribute to the impossibility of recovering the original model.]()

![]()

![Recovered coefficients from Eq. S28.]()

