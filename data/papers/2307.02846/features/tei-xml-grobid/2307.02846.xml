<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Probability Metrics for Tropical Spaces of Different Dimensions</title>
				<funder>
					<orgName type="full">President</orgName>
				</funder>
				<funder>
					<orgName type="full">IGSSE/TUM-GS</orgName>
				</funder>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability  status="unknown">
					<licence/>
				</availability>
				<date type="published" when="2024-09-29">29 Sep 2024</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">Roan</forename><surname>Talbut</surname></persName>
							<email>r.talbut21@imperial.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Imperial College London</orgName>
								<address>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Daniele</forename><surname>Tramontano</surname></persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">School of Computation, Information and Technology</orgName>
								<orgName type="department" key="dep2">Department of Mathematics</orgName>
								<orgName type="institution">Technical University of Munich</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Yueqi</forename><surname>Cao</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Imperial College London</orgName>
								<address>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Mathias</forename><surname>Drton</surname></persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">School of Computation, Information and Technology</orgName>
								<orgName type="department" key="dep2">Department of Mathematics</orgName>
								<orgName type="institution">Technical University of Munich</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Imperial College London</orgName>
								<address>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Probability Metrics for Tropical Spaces of Different Dimensions</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2024-09-29">29 Sep 2024</date>
						</imprint>
					</monogr>
					<idno type="MD5">0DA511ECA81AA8FD28EFCBCA0238809D</idno>
					<idno type="arXiv">arXiv:2307.02846v2[math.MG]</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.8.2-SNAPSHOT" ident="GROBID" when="2025-03-15T12:46+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Simple projection</term>
					<term>tropical matrix maps</term>
					<term>tropical projective torus</term>
					<term>Wasserstein metrics</term>
					<term>phylogenetic data</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The problem of comparing probability distributions is at the heart of many tasks in statistics and machine learning. Established comparison methods treat the standard setting that the distributions are supported in the same space. Recently, a new geometric solution has been proposed to address the more challenging problem of comparing measures in Euclidean spaces of differing dimensions. Here, we study the same problem of comparing probability distributions of different dimensions in the tropical setting, which is becoming increasingly relevant in applications involving complex data structures such as phylogenetic trees. Specifically, we construct a Wasserstein distance between measures on different tropical projective tori-the focal metric spaces in both theory and applications of tropical geometry-via tropical mappings between probability measures. We prove equivalence of the directionality of the maps, whether mapping from a low dimensional space to a high dimensional space or vice versa. As an important practical implication, our work provides a framework for comparing probability distributions on the spaces of phylogenetic trees with different leaf sets. We demonstrate the computational feasibility of our approach using existing optimisation techniques on both simulated and real data.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Some of the most immediate and important tasks in statistics and machine learning-such as clustering <ref type="bibr" target="#b16">(Irpino &amp; Verde, 2008)</ref> and density estimation <ref type="bibr" target="#b31">(Sheather, 2004</ref>)-require measuring a distance between probability distributions. This is usually done with a notion of distance or divergence between measures; some of the most well-known distances and divergences between probability distributions are the Kullback-Leibler divergence, total variation distance, and Hellinger distance. These notions fall within the class of maps known in probability theory as f -divergences <ref type="bibr" target="#b8">(Csiszr, 1967)</ref>. More recently, the Wasserstein distance between measures has become increasingly relevant in statistics as it metrises weak convergence of measures and reflects the geometry of the underlying state space (e.g., <ref type="bibr" target="#b27">Panaretos &amp; Zemel, 2019</ref><ref type="bibr" target="#b28">, 2020)</ref>.</p><p>An underlying assumption behind computing f -divergences and Wasserstein distances, however, is that the measures live in the same space. Nevertheless, there exist many application settings where the measures to be compared occur in distinct spaces of different dimensions. For example, phylogenetic trees are used to capture the progression of cancer in a biomedical application or the evolutionary patterns of the spread of disease in a public health application. In such applications, the numbers of leaves in the trees can differ before and after intervention such as treatment or public inoculation, and therefore such datasets will lie on spaces of different dimensions. Existing work by <ref type="bibr" target="#b30">Ren et al. (2017)</ref> and <ref type="bibr" target="#b13">Grindstaff &amp; Owen (2019)</ref> study the problem of comparing sets of trees with differing numbers of leaves in BHV tree space <ref type="bibr" target="#b4">(Billera et al., 2001)</ref>; here, we consider probability measures rather than discrete data sets in tropical tree space <ref type="bibr" target="#b32">(Speyer &amp; Sturmfels, 2004)</ref>.</p><p>There is an inherent connection between the space of phylogenetic trees and tropical geometry <ref type="bibr" target="#b32">(Speyer &amp; Sturmfels, 2004)</ref>, which has recently been exploited to develop many statistical and machine learning tools for sets of phylogenetic trees (e.g., <ref type="bibr" target="#b3">Barnhill et al., 2023;</ref><ref type="bibr" target="#b34">Tang et al., 2024;</ref><ref type="bibr" target="#b37">Yoshida et al., 2019;</ref><ref type="bibr" target="#b0">Aliatimis et al., 2024)</ref>. The ambient space of phylogenetic trees as well as Gröbner complexes-central objects in tropical geometry-is the tropical projective torus, which makes it a fundamental space in tropical geometry for both theory and applications. In this work, we therefore study Wasserstein distances between probability distributions on tropical projective tori of different dimensions.</p><p>Our strategy is to leverage recent work in the Euclidean setting by <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref>, who construct a Wasserstein distance between Euclidean spaces of different dimensions. The optimal transport problem and thus Wasserstein distances are well defined and have been previously studied on the tropical projective torus by <ref type="bibr" target="#b20">Lee et al. (2022)</ref>. In this work, we build on these existing results and relevant foundations to construct a Wasserstein distance between measures on tropical projective tori of different dimensions. We prove that there need not be a choice of whether to map from the lower dimensional torus to the higher dimensional one or vice versa, because the directional mappings are equivalent.</p><p>The remainder of this manuscript is structured as follows. We begin with an outline of the relevant background and concepts in Section 2. We then characterise the tropical equivalents to the necessary tools in Section 3, which leads to our main theorem and a discussion of practical implications for phylogenetic trees in Section 4. Section 5 consists of numerical experiments for the computation of our proposed distance and a demonstration of our algorithm using real influenza data. We close with a discussion of future work in Section 6.</p><p>Throughout this manuscript we use the term polyhedron to refer to a (possibly unbounded) finite intersection of closed half spaces of dimension d, in accordance with <ref type="bibr" target="#b40">Ziegler (2012)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Background and Preliminaries</head><p>In this section, we present the tropical setting of our work, the Wasserstein distance definition, and an overview of the approach for mapping between probability distributions of different dimensions in the Euclidean case, which we will closely follow in our work.</p><p>Notation. Throughout this manuscript, we use the notation [n] := {1, 2, . . . , n}.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Essentials of Tropical Algebra and Geometry</head><p>We begin by outlining the basic concepts of tropical algebra and tropical geometry needed for our work; a complete introduction is given by <ref type="bibr" target="#b23">Maclagan &amp; Sturmfels (2015)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">Tropical Algebra and Phylogenetics</head><p>Definition 1 (Tropical Algebra). The tropical algebra is the semiring R = R ∪ {-∞} with the addition and multiplication operators-tropical addition and tropical multiplication, respectively-given by a ⊞ b = max{a, b}, a ⊙ b = a + b.</p><p>The additive identity is -∞ and the multiplicative identity is 0. Tropical subtraction is not defined; tropical division is given by classical subtraction.</p><p>Remark 2. Note that <ref type="bibr" target="#b23">Maclagan &amp; Sturmfels (2015)</ref> use the min-plus convention where tropical addition is given by the minimum between two elements, rather than the maximum as above. While they are equivalent, we use the max-plus convention as this has been used more frequently in recent applications (e.g., <ref type="bibr" target="#b37">Yoshida et al., 2019</ref><ref type="bibr" target="#b38">Yoshida et al., , 2023;;</ref><ref type="bibr" target="#b0">Aliatimis et al., 2024)</ref>.</p><p>Using the tropical algebra, we can define tropical parallels to most algebraic objects. For example, we can define tropical polynomials as the maximum of finitely many linear maps with integer coefficients. Evaluating functions or other mathematical expressions using the tropical algebra is referred to as tropicalisation.</p><p>The metric space in which we work is the following.</p><p>Definition 3 (Tropical projective torus, Tropical metric). The n-dimensional tropical projective torus is a quotient space constructed by endowing R n+1 with the equivalence relation</p><formula xml:id="formula_0">x ∼ y ⇔ x = a ⊙ y;<label>(1)</label></formula><p>it is denoted by R n+1 /R1. The generalised Hilbert projective metric, also referred to as the tropical metric, is given by</p><formula xml:id="formula_1">d tr (x, y) = max i {x i -y i } -min i {x i -y i } = max i,j {x i -y i -x j + y j },</formula><p>and is induced by the tropical norm ∥x∥ tr = max</p><formula xml:id="formula_2">i x i -min i x i .</formula><p>As we are mapping between tropical projective tori of different dimensions, when necessary we will distinguish between metrics on different spaces by denoting the R n /R1 metric by d n tr . Figure <ref type="figure" target="#fig_0">1</ref> shows the tropical ball on the tropical projective plane, where we have normalised the first coordinate to embed into R 2 . We use this embedding, given more generally by</p><formula xml:id="formula_3">φ : R n+1 /R1 → R n , (x 0 , . . . , x n ) → (x 2 -x 0 , . . . , x n -x 0 ),</formula><p>for all visualisation figures in this paper. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Phylogenetic Trees</head><p>The space of phylogenetic trees with N leaves, which are metric N -trees with non-negative lengths on all edges, have an important connection to tropical geometry. It was proved by <ref type="bibr" target="#b32">Speyer &amp; Sturmfels (2004)</ref> that the tropical Grassmannian-the projective variety obtained by tropicalising the Grassmannian-is homeomorphic to the space of phylogenetic trees, and therefore the tropical projective torus is the ambient space of phylogenetic trees. Phylogenetic trees are a fundamental data type in biology that model evolutionary processes in many settings, such as the evolution of species and disease, as well as the spread of pathogens. The tropical projective torus, therefore, is an important space in mathematical biology as the ambient space of phylogenetic trees.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Tropical Matrices</head><p>To respect the tropical structure of the tropical projective torus, we use tropical matrices to map probability distributions from one tropical projective torus to another. Here we outline the behaviour of tropical matrix maps and their connections to tropical convexity as first presented by <ref type="bibr" target="#b9">Develin &amp; Sturmfels (2004)</ref> and discussed in Chapter 5.2 of <ref type="bibr" target="#b23">Maclagan &amp; Sturmfels (2015)</ref>. The foundational objects of convexity analysisline segments and convex hulls -are defined in the tropical setting as follows:</p><p>Definition 4 (Tropical line segment, Tropical convex hull). For any two points a, b ∈ R n /R1, the tropical line segment between a and b is the set</p><formula xml:id="formula_4">γ ab = {α ⊙ a ⊞ β ⊙ b | α, β ∈ R}</formula><p>with tropical addition taken coordinate-wise.</p><p>For a finite subset X = {x 1 , . . . , x r } ⊂ R n /R1, the tropical convex hull of X is the smallest subset containing X where the tropical line segment between any two points in X is contained in X; it is the set of all tropical linear combinations of X,</p><formula xml:id="formula_5">tconv(X) = {α 1 ⊙ x 1 ⊞ α 2 ⊙ x 2 ⊞ • • • ⊞ α r ⊙ x r | α 1 , . . . , α r ∈ R}.</formula><p>We will be studying tropical matrices M ∈ R m×n with at least one real entry per row-a non-degeneracy condition which ensures M maps into R m /R1. This condition is assumed through the rest of the manuscript. From the definition above, we can observe that the image of a tropical matrix M in R m /R1 is the tropical span of the columns of M ; when M has all real entries, its image in R m /R1 is the tropical convex hull of its columns <ref type="bibr" target="#b23">(Maclagan &amp; Sturmfels, 2015)</ref>.</p><formula xml:id="formula_6">Example 5. Let M :=   2 0 0 -2 2 1 1 3 -1   .</formula><p>Its image is given in Figure <ref type="figure">2</ref>.</p><p>(2, 3)</p><formula xml:id="formula_7">(1, -1) (-4, -1) Figure 2: The image of M from Example 5 under φ : R 3 /R1 → R 2 .</formula><p>The local behaviour of tropical matrices is classically linear, but to understand the global behaviour of their images and fibres, we must understand the combinatoric structure of tropical matrices. This combinatoric information is given by the type at a point x, and dictates the local behaviour at x. Definition 6. Let M ∈ R m×n . The type of a point x ∈ R n /R1 with respect to M is the n-tuple S = (S 1 , . . . , S n ), where</p><formula xml:id="formula_8">S j = {i ∈ [m] : (M x) i = M i• ⊙ x attains its maximum at M ij + x j }.</formula><p>The type of a point is denoted by type(x). The set of all points with type S forms a convex polyhedron which is denoted by</p><formula xml:id="formula_9">X S := {x ∈ R n /R1 : S ⊆ type(x)}.</formula><p>Note that the type sets S cover [m]. This definition is given by <ref type="bibr" target="#b9">Develin &amp; Sturmfels (2004)</ref> for real-valued matrices; we note it is also valid for matrices with -∞ entries.</p><p>Intuitively, S j is the set of coordinates i of M x that depend on the jth coordinate of x; in neighbourhoods where S j = ∅ then M x is invariant under changes to x j , and in neighbourhoods where S j = [m] for some j then M x takes the form x j ⊙ M •j and is therefore constant due to the equivalence relation on the tropical projective torus.</p><p>The collection of all type cells X S form a cell decomposition of R n /R1 (Theorem 15 by <ref type="bibr" target="#b9">Develin &amp; Sturmfels (2004)</ref>) where X S ≤ X T if, and only if, ∀ j, T j ⊆ S j . For any two types S and T , X S ∩X T = X S∪T . Figure <ref type="figure" target="#fig_1">3</ref> shows the cell decomposition for a 2×3 matrix, and the local classically linear form of M x according to the type.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Wasserstein Distances Between Probability Distributions</head><p>Wasserstein distances measure distances between probability distributions. They arise as a certain class of optimal transport problem, with applications in PDEs, image processing, optimisation and statistics. As opposed to f -divergences, they preserve the geometry of the state space over which they are defined and metrise weak convergence results such as the central limit theorem (e.g., <ref type="bibr">Lee et al., 2022, Section 3.1)</ref>.</p><formula xml:id="formula_10">(0, a -b, a -c) (0, d -e, d -f ) Type: ({1, 2}, ∅, ∅) M x = (a + x1, d + x1) Type: ({2}, ∅, {1}) M x = (c + x3, d + x1) Type: (∅, ∅, {1, 2}) M x = (c + x3, f + x3) Type: (∅, {1}, {2}) M x = (b + x2, f + x3) Type: (∅, {1, 2}, ∅) M x = (b + x2, e + x2) Type: ({2}, {1}, ∅) M x = (b + x2, d + x1)</formula><p>The Wasserstein distance is a solution to a particular case of the optimal transport problem, first introduced by <ref type="bibr" target="#b25">Monge (1781)</ref>. The optimal transport problem is the search for an optimal mapping to transport a set of resources from their sources to sinks which minimises the transport cost. When the cost function is given by a distance between source and sink, the solution to the optimal transport problem yields the Wasserstein distances. The space on which the source and sink locations are located is referred to as the state space, while the physical distance that the resources need to be transported is measured by the ground metric.</p><p>The optimal transport problem was then relaxed to a probabilistic framework <ref type="bibr" target="#b17">(Kantorovich, 1942)</ref>. The question is then to find the optimal coupling of two random variables which minimises the expectation of a cost function; when the cost function is the ground metric of the state space, the solution to the problem gives the Wasserstein distance between probability measures. Definition 7 (p-Wasserstein Distance). Let (Ω, d) be a Polish metric space and p ∈ [1, ∞). Let µ, ν ∈ P (Ω) and let Π(µ, ν) be the set of all couplings of µ and ν. The p-Wasserstein distance W p on P (Ω) is defined by</p><formula xml:id="formula_11">W p (µ, ν) p := inf π∈Π(µ,ν) E (X,Y )∼π [d(X, Y ) p ] .</formula><p>The p-Wasserstein distance is not necessarily finite on all of P (Ω), but will be finite on measures with finite p-moments, which we denote by P p (Ω) <ref type="bibr" target="#b36">(Villani, 2009</ref><ref type="bibr" target="#b35">(Villani, , 2003))</ref>. The tropical projective torus is a Polish space <ref type="bibr" target="#b26">(Monod et al., 2018)</ref>, while the tropical p-Wasserstein distance is well-defined and has been previously studied by <ref type="bibr" target="#b20">Lee et al. (2022)</ref> using the tropical projective torus as the state space and the tropical metric as the ground metric.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Wasserstein Distances Between Euclidean Spaces of Different Dimensions</head><p>To measure differences between probability distributions supported on Euclidean space of different dimensions, <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> constructed a Wasserstein pseudo-metric; it is a pseudo-metric in that it is symmetric and positive up to isometries. They note this pseudo-metric reflects well-understood properties of certain families of measures, as well as demonstrating computational advantages over the Gromov-Wasserstein distance <ref type="bibr" target="#b24">(Mémoli, 2011)</ref>. We look to mirror their approach in the more complex tropical setting. <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> also establish the same results for f -divergences, but we will restrict our considerations to Wasserstein distances due to their inherently geometric behaviour; this behaviour is favourable for applications where our data has a tropical structure such as phylogenetic tree data.</p><p>We will leverage the approach of <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> in our work and so we provide an outline of their strategy here. Suppose we have two measures, µ, ν in P p (R m ) and P p (R n ) respectively, with m ≤ n; we suppose there is no known correspondence between the coordinate systems of R m and R n , even if m = n.</p><p>Both measures are required to be on the same state space to take a Wasserstein distance, so <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> define their projections of interest as those composed of a semi-orthogonal matrix and a translation:</p><formula xml:id="formula_12">M = {ϕ : R n → R m : ϕ(x) = Ax + b, A ∈ O(m, n), b ∈ R m }.</formula><p>Then the sets of projection and embedding measures are defined as, respectively,</p><formula xml:id="formula_13">Φ -(ν, m) := {β ∈ P (R m ) : β = ϕ * (ν) for some ϕ ∈ M}, Φ + (µ, n) := {α ∈ P (R n ) : µ = ϕ * (α) for some ϕ ∈ M},</formula><p>where ϕ * (α) denotes the push-forward of α; that is, ϕ * (α)(A) = α(ϕ -1 (A)).</p><p>From these projected and embedded measures, the projection and embedding Wasserstein distances are defined respectively by</p><formula xml:id="formula_14">W - p (µ, ν) = inf β∈Φ -(ν,m) W p (µ, β),<label>(2)</label></formula><formula xml:id="formula_15">W + p (µ, ν) = inf α∈Φ + (µ,n) W p (α, ν).<label>(3)</label></formula><p>While both the projection and embedding distances offer an intuitive measure for comparing µ and ν, it is not obvious which would be more meaningful in practice: to map from the lower dimensional space to the higher dimensional one, or vice versa. The main result by <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> tells us we need not make an arbitrary choice; the two distances are equal.</p><formula xml:id="formula_16">Theorem 8. (Cai &amp; Lim, 2022, Theorem 2.2) For m ≤ n, p ∈ [1, ∞], let µ ∈ P p (R m ), ν ∈ P p (R n ). Then W -(µ, ν) = W + (µ, ν)</formula><p>where W -and W + are defined by (2) and (3).</p><p>The focal contribution of our work is a tropical parallel to the framework of <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref>, allowing us to map between probability measures in tropical projective tori of different dimensions and establish the same metric equivalence in the more complex tropical setting.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Building Tropical Tools</head><p>To build up to the tropical equivalent of Theorem 8, we first require tropical counterparts of central objects to the construction by <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref>. Specifically, we require a semi-orthogonal map in the tropical setting. Notice that in our setting, the equivalence relation (1) defining the tropical projective torus must always be preserved in mappings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Tropical Matrix Maps</head><p>Standard linear maps fail to preserve the equivalence relation (1) that characterizes the tropical projective torus, making them unsuitable for our aim of mapping between tropical projective tori. Instead, we consider tropical linear maps. We now review the properties of general tropical matrices, highlighting their irregular properties; namely, that tropical matrices can have bounded image and fibres of different dimension.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">Metric Geometry Under Tropical Linear Maps.</head><p>To formulate Wasserstein distances over tropical linear maps, we must understand their metric geometry.</p><p>Here we prove a useful property of tropical linear maps, namely that they are always non-expansive with respect to the tropical metric.</p><p>Proposition 9. For any tropical matrix M :</p><formula xml:id="formula_17">∀ x, y ∈ R n /R1 : d tr (M x, M y) ≤ d tr (x, y)</formula><p>Proof. There exist coordinates r, s such that</p><formula xml:id="formula_18">d tr (M x, M y) = max i {M ri + x i } -max j {M rj + y j } -max k {M sk + x k } + max ℓ {M sℓ + y ℓ },</formula><p>Fix i, j, k, ℓ as the maximal arguments for the terms above. Then</p><formula xml:id="formula_19">d tr (M x, M y) = M ri + x i -(M rj + y j ) -(M sk + x k ) + M sℓ + y ℓ ≤ M ri + x i -(M ri + y i ) -(M sℓ + x ℓ ) + M sℓ + y ℓ ≤ x i -y i -x ℓ + y ℓ ≤ d tr (x, y).</formula><p>In light of Proposition 9, we note the non-expansive property is more restrictive in the Euclidean setting than the tropical setting; every tropical matrix map is non-expansive, but not every Euclidean matrix map is non-expansive.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Images of Tropical Matrices.</head><p>To define embedded measures, we must take a pull-back through M ; this requires the image of M to cover the support of our measure µ ∈ P p (R m /R1). However, tropical matrices often have bounded image, as we saw in Example 5. The following result characterises surjectivity for tropical matrix maps.</p><p>Lemma 10. A tropical matrix map M is surjective on R m /R1 if and only if, for each row i, there is at least one column c(i) such that</p><formula xml:id="formula_20">M r,c(i) ∈ -∞ if r ̸ = i, R if r = i.<label>(4)</label></formula><p>Proof. Suppose M is surjective. Then let x be such that M x = [(0, . . . , K, . . . , 0)], where only the i-th entry is K, and K is a positive real number such that</p><formula xml:id="formula_21">K &gt; max{M i0j0 -M i1j1 : M i0j0 , M i1j1 ∈ R}. Let j ∈ [n] be some coordinate such that (M x) i = M ij + x j = K. If M lj is real for any other coordinate, then 0 = (M x) l ≥ M lj + x j = M lj -M ij + M ij + x j = M lj -M ij + K &gt; 0,</formula><p>a contradiction. Notice that the final equality comes from the definition of x, while the last equality is a consequence of the definition of K.</p><p>To prove the other direction, let us consider y = (y 1 , . . . , y m ) ∈ R m /R1. For each i ∈ [m], we can pick some column c(i) that satisfies (4). Let I := {c(i) : i ∈ [m]}. Then we define K as before and define</p><formula xml:id="formula_22">x = (x 1 , . . . , x n ) ∈ R n /R1 by x j := y i -M i,c(i) if j = c(i), min i∈[m] {-K -y i + M i,c(i) } j / ∈ I</formula><p>By direct computation, we can check that the maximum for each row i is achieved at c(i) and that the value is exactly y i .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.3">Fibres of Tropical Matrices.</head><p>The semi-orthogonal projections used by <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref> are well-behaved in the sense that they preserve some of the structure of ν ∈ P p (R n ). For example, a push-forward through a semi-orthogonal projection cannot increase the co-dimension of a measure <ref type="bibr" target="#b14">(Heurteaux, 2007)</ref>, as each fibre has dimension n -m. It is the fibres of M which determine the dimensionality of a projected measure and are therefore central to our work.</p><p>Definition 11. The fibre of M at a point y ∈ R m /R1 is given by</p><formula xml:id="formula_23">F y = {x ∈ R n /R1 : M x = y}. Example 12. Let M := a b c d e f</formula><p>, as in Figure <ref type="figure" target="#fig_1">3</ref>. If S j is empty at x, then M x is locally independent of e j ; from this we can draw the fibres of M , as illustrated in Figure <ref type="figure" target="#fig_2">4</ref> -points of the same colour are mapped to the same point by M .</p><p>(0, a -b, a -c)</p><formula xml:id="formula_24">(0, d -e, d -f ) Type: ({1, 2}, ∅, ∅) M x = (a + x1, d + x1) Type: ({2}, ∅, {1}) M x = (c + x3, d + x1) Type: (∅, ∅, {1, 2}) M x = (c + x3, f + x3) Type: (∅, {1}, {2}) M x = (b + x2, f + x3) Type: (∅, {1, 2}, ∅) M x = (b + x2, e + x2)</formula><p>Type: ({2}, {1}, ∅) The following lemma characterises the fibres of general tropical matrices as polyhedral complexes; this can be seen as a refinement of Theorem 15 by <ref type="bibr" target="#b9">Develin &amp; Sturmfels (2004)</ref>.</p><formula xml:id="formula_25">M x = (b + x2, d + x1)</formula><p>Lemma 13. The fibres</p><formula xml:id="formula_26">F y = {x ∈ R n /R1 : M (x) = y} of a general tropical matrix M are (unbounded) polyhedral complexes.</formula><p>Proof. For a given type S, we define</p><formula xml:id="formula_27">B S y := i∈[m] {x ∈ R n /R1 : x j -x k = M 1k -M ij + y i -y 1 | 1 ∈ S k , i ∈ S j }.</formula><p>Then we define C S y := X S ∩ B S y and let C y := {C S y : S is a type}. We will show that C y is a polyhedral complex in R n /R1. Since for every type S, both X S and B S y are polyhedra in R n /R1, C S y is a well-defined polyhedron in R n /R1 as well.</p><p>We first prove C y is closed under intersections. Consider two types S and T ; we can write</p><formula xml:id="formula_28">C S y ∩ C T y as (X S ∩ X T ) ∩ (B S y ∩ B T y ) = X S∪T ∩ (B S y ∩ B T y )</formula><p>and we will prove this last term is equal to</p><formula xml:id="formula_29">X S∪T ∩ B S∪T y . By definition, B S∪T y is equal to: i∈[m] {x ∈ R n /R1 : x j -x k = M 1k -M ij + y i -y 1 | 1 ∈ S k ∪ T k , i ∈ S j ∪ T j }.</formula><p>We see that B S∪T y ⊂ B S y ∩ B T y , so it remains to show that for any x ∈ X S∪T ∩ (B S y ∩ B T y ), x belongs to B S∪T y as well. This amounts to proving that:</p><formula xml:id="formula_30">x j -x k = M 1k -M ij + y i -y 1 , ∀i ∈ [m], 1 ∈ S k ∪ T k , i ∈ S j ∪ T j .</formula><p>Let i, j, k be such that 1 ∈ S k and i ∈ S j . In this case, the equation holds trivially based on the definition of B S y . Similarly, if 1 ∈ T k and i ∈ T j we are done. So, the remaining case is the one in which 1 ∈ S k and i ∈ T j . We consider j 0 such that i ∈ S j0 , notice that this exists since S covers [m]. Since x ∈ X S∪T the following equation holds:</p><formula xml:id="formula_31">M ij + x j = M ij0 + x j0 = y i , implying that x j = M ij0 -M ij + x j0</formula><p>. Now we can write x j -x k in the following form:</p><formula xml:id="formula_32">x j -x k = M ij0 -M ij + x j0 -x k = M ij0 -M ij + M 1k -M ij0 + y i -y 1 = M 1k -M ij + y i -y 1 ,</formula><p>where for the first equality we used that x ∈ B S y . Notice that we don't need to prove the case in which 1 ∈ T k and i ∈ S i , as the roles of S and T are equivalent and so the same proof applies swapping their roles. So we proved that C y is closed under intersection.</p><p>We prove now that the faces of elements of C y are contained in C y . Since by definition B S y is an affine space for any type S, the faces of C S y are of the form X T ∩ B S y where X T is one of the faces of X S ; that is,</p><formula xml:id="formula_33">S ≤ T . It suffices to show now that X T ∩ B S y = X T ∩ B T y . As S ≤ T , it is immediate that B T y ⊂ B S y . It remains to show that for all x ∈ X T ∩ B S y we have x ∈ B T y . Consider i, j, k such that 1 ∈ T k , i ∈ T j ; we will show that x j -x k = M 1k -M ij + y i -y 1 . As S covers</formula><p>[m] and we have S ≤ T , there are some k ′ , j ′ such that 1 ∈ S k ′ , T k ′ and i ∈ S j ′ , T j ′ . For all x ∈ X T we have</p><formula xml:id="formula_34">x k + M 1k = x k ′ + M 1k ′ , x j + M ij = x j ′ + M ij ′ .</formula><p>Hence, for all x ∈ X T ∩ B S y :</p><formula xml:id="formula_35">x j -x k = x j ′ + M ij ′ -M ij -x k ′ -M 1k ′ + M 1k , = y i -M ij -y 1 + M 1k ,</formula><p>where the first equality uses that x ∈ X T and the second equality uses that x ∈ B S y . We conclude that x ∈ B T y , and hence that C y is closed under taking faces.</p><p>In order to complete the proof, it only remains to show that F y = ∪ S C S y . We know that R n /R1 = ∪ S X S , which implies that F y = ∪ S (X S ∩ F y ). So it is enough to prove that X S ∩ F y = X S ∩ B S y . We start by proving X S ∩ F y ⊆ X S ∩ B S y . Consider i ∈ [n] and k, j ∈ [m], such that 1 ∈ S k and i ∈ S j , and fix x ∈ X S ∩ F y . It follows from the definition of types that:</p><formula xml:id="formula_36">(M x) i -(M x) 1 = x j + M ij -x k -M 1k .</formula><p>(5)</p><p>We can therefore write x j -x k as</p><formula xml:id="formula_37">x j -x k = M 1k -M ij + (x j + M ij ) -(M 1k + x k ) = M 1k -M ij + (M x) i -(M x) 1 (6) = M 1k -M ij + y i -y 1 ,</formula><p>where the penultimate equality is given by ( <ref type="formula">5</ref>) and the final equality follows from x ∈ F y . Hence x ∈ B S y , so we have</p><formula xml:id="formula_38">X S ∩ F y ⊆ X S ∩ B S y . Finally, we show X S ∩ B S y ⊆ F y by direct computation. For i, j, k such that 1 ∈ S k and i ∈ S j : (M x) i -(M x) 1 = M ij + x j -M 1k -x k = y i -y 1 ,</formula><p>where the first equality follows from x ∈ X S and the second equality follows from x ∈ B S y . Therefore the fibre F y = ∪ S C S y is a polyhedral complex, as desired.</p><p>Remark 14. From our proof of Lemma 13, we note that the poset of fibre cells C S y is given by a reverse type inclusion as in the case of type cells <ref type="bibr" target="#b9">(Develin &amp; Sturmfels, 2004)</ref>. Therefore, the maximal cells C S y of the fibre are exactly those whose type is given by a partition of [m] (and copies of the empty set).</p><p>We see in Figure <ref type="figure" target="#fig_2">4</ref> that fibre polyhedral complexes can have mixed dimension. A push-forward M (ν) through such matrices can preserve little to none of the structure of ν due to this irregular fibre dimension. We would therefore like to restrict our considerations to matrices with fibres of consistent dimension n -m. In the next section we identify the set of such matrices as the set of simple projections.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Simple Projections</head><p>In addition to the assumption that the tropical matrices we study have at least one real entry per row as specified above, the following class of tropical matrices-simple projections-have the necessary properties for our task of constructing our tropical Wasserstein distance.</p><p>Definition 15 (Simple Projection). A tropical matrix M ∈ R m×n , where n &gt; m, is called a simple projection when each column has at most one real entry.</p><p>For M , we define J i := {j : M ij ∈ R}. These sets are disjoint and non-empty, but do not necessarily cover <ref type="bibr">[n]</ref>. Then</p><formula xml:id="formula_39">(M x) i = max j∈Ji {M ij + x j }.<label>(7)</label></formula><p>The following relationship establishes when a tropical matrix is a simple projection in terms of the dimensionality of its fibres.</p><p>Lemma 16. M is a simple projection if and only if, for all y ∈ R m /R1, every maximal cell of the fibre F y has dimension n -m.</p><p>Proof. We will show that the following are equivalent:</p><p>1. M is a simple projection, 2. for all y, the maximal cells of the fibre F y have dimension n -m, 3. the maximal cells X S of the type cell decomposition of R n /R1 correspond to types consisting of m singletons and n -m empty sets.</p><p>We first show that 2 ⇔ 3. By Remark 14 a fibre cell C S y is maximal iff S is a partition which is equivalent to X S being a maximal cell. For such an S, we define the classical matrix M S ∈ R m×n and b S ∈ R m as follows</p><formula xml:id="formula_40">M S i,j := 1, if i ∈ S j , 0, if i / ∈ S j b i := M i,j(i) ,</formula><p>where j(i) is the only j such that i ∈ S j . From this, we directly notice that the restriction of M to X S is given by the classically affine operator mapping</p><formula xml:id="formula_41">x ∈ R n to M S • x + b S ∈ R m</formula><p>, where here, matrix-vector multiplication is computed in the usual non-tropical manner. The dimension the maximal fibre cell C S y in X S is then given by the dimension of the kernel of M S . Since this is a 0/1 matrix with one non-zero entry per row, we may use a standard linear algebra argument to derive that</p><formula xml:id="formula_42">KerM S = |{j ∈ [m] : M S •,j = 0}| = |{j ∈ [m] : S j = ∅}| ≤ n -m.</formula><p>From this we can deduce that every maximal type cell has exactly m non-empty S j if and only if, ∀ y ∈ R m /R1, every maximal cell in F y has dimension n -m. As S is a partition, we conclude that 2 ⇔ 3. We next show that 1 ⇔ 3. Suppose for contradiction that M is not a simple projection, but for every maximal type cell X S , the type S consists of singletons. Then for some j ∈ [n] and i 0 ̸ = i 1 ∈ [m], both M i0j and M i1j are real. We set</p><formula xml:id="formula_43">B := min{min(M i0j -M i0k , M i1j -M i1k ) : k ∈ [n]} U := {x ∈ R n /R1 : x k -x j ≤ -B for k ∈ [n] \ {j}}.</formula><p>U is a full dimensional polyhedron in R n /R1, so there is some maximal X S such that dim(X S ∩U ) = dim(X S ). By construction, for all x ∈ U and all k ∈ [n],</p><formula xml:id="formula_44">M i0k + x k ≤ M i0j + x j , M i1k + x k ≤ M i1j + x j ,</formula><p>and hence i 0 , i 1 ∈ S j on U j . Contradiction. To show the converse, suppose that M is a simple projection. Then for all x in a maximal type cell X S , i ∈ S j for some j ∈ J i . As the J i are disjoint, each S j is either ∅ or a singleton.</p><p>We can verify that simple projections satisfy the condition of Lemma 10 by their definition, and hence are surjective. By Lemma 16, they also have fibres of dimension n -m. We conclude that simple projections are the most general tropical matrices satisfying these properties. In Lemma 17 and Proposition 18 we now use these properties of simple projections to construct a homeomorphism f M between R n /R1 and R m /R1 × F 0 which is crucial for our main theorem.</p><p>Lemma 17. Let M be a simple projection from R n /R1 to R m /R1 and let F 0 be the fibre of M at 0 ∈ R m /R1. We define a map</p><formula xml:id="formula_45">f M : R n /R1 → R m /R1 × F 0 by mapping x ∈ R n /R1 to (M x, x -z x ) ∈ R m /R1 × R n /R1</formula><p>, where z x is defined as follows:</p><formula xml:id="formula_46">z x j := (M x) i -max k (M x) k j ∈ J i , 0 j / ∈ ∪ i∈[n] J i . (<label>8</label></formula><formula xml:id="formula_47">)</formula><p>The map f M is a well-defined map.</p><p>Proof. We must prove that this map respects the equivalence class defining R n /R1. This amounts to proving that for all c ∈ R and all</p><formula xml:id="formula_48">x ∈ R n /R1, f M (x) ∼ f M (c ⊙ x).</formula><p>Let us start by considering z c⊙x , which, from (8), is given by</p><formula xml:id="formula_49">z c⊙x j = (M (c ⊙ x) i -max k (M (c ⊙ x) k ) = M (x) i -max k (M x) k j ∈ J i 0 j / ∈ ∪ i J i , so it is equal to z x . Therefore we can write f M (c ⊙ x) as (c ⊙ M x, c ⊙ x -z x ) = (c ⊙ M x, c ⊙ (x -z x )) ∼ (M x, x -z x ) = f M (x), therefore proving that f M is well defined. We now prove that Im f M ⊂ R m /R1 × F 0 . It suffices to show x -z x ∈ F 0 , which can be done by writing M (x -z x ) i for each i ∈ [m] as max j∈Ji {M ij + x j -(M x) i -max k (M x) k } = max j∈Ji {x j + M ij } -(M x) i -max k (M x) k = -max k (M x) k ,</formula><p>which is independent of i, and hence M (x -z x ) ∼ 0. Notice that for the first equality, we may take (M x) i and max k (M x) k out of the maximum since they are independent of j, while for the second equality we use the simple projection definition.</p><p>Proposition 18. The map f M defined in Lemma 17 is a homeomorphism between R n /R1 and R m /R1 × F 0 satisfying</p><formula xml:id="formula_50">1 3 d R m /R1×F0 (f (x 1 ), f (x 2 )) ≤ d n tr (x 1 , x 2 ) ≤ d R m /R1×F0 (f (x 1 ), f (x 2 )), (<label>9</label></formula><formula xml:id="formula_51">)</formula><formula xml:id="formula_52">where d R m /R1×F0 ((u 1 , v 1 ), (u 2 , v 2 )) = d m tr (u 1 , u 2 ) + d n tr (v 1 , v 2 ).</formula><p>Proof. We begin by showing the surjectivity of f M . Consider (y, u) in R m /R1 × F 0 and define</p><formula xml:id="formula_53">w j := y i -max k y k j ∈ J i 0 j / ∈ ∪ i J i .</formula><p>We will show f M (w + u) ∼ (y, u). Let us start by considering the entries of M (w + u), which we can write in the following way:</p><formula xml:id="formula_54">M (w + u) i = max j∈Ji {M ij + y i -max k y k + u j } = max j∈Ji {M ij + u j } + y i -max k y k = y i -max k y k ,</formula><p>implying that M (w + u) = y and w = z w+u . This then implies that:</p><formula xml:id="formula_55">f M (w + u) = (y, w + u -w) = (y, u), hence f M is surjective.</formula><p>In order to show injectivity, consider</p><formula xml:id="formula_56">x 1 , x 2 ∈ R n /R1 such that f M (x 1 ) ∼ f M (x 2</formula><p>). This means that there are c 1 , c 2 ∈ R where:</p><formula xml:id="formula_57">M x 2 = c 1 ⊙ M x 1 ,<label>(10)</label></formula><formula xml:id="formula_58">x 1 -z x 1 = c 2 ⊙ (x 2 -z x 2</formula><p>). ( <ref type="formula">11</ref>)</p><p>From ( <ref type="formula" target="#formula_46">8</ref>) we see that (10) implies z x 1 = z x 2 . We can rewrite (11) as</p><formula xml:id="formula_59">∀ j ∈ [n] : x 1 j = z x 1 j + c 2 + x 2 j -z x 2 j = z x 2 j + c 2 + x 2 j -z x 2 j = c 2 + x 2 j from which we deduce x 1 ∼ x 2 , proving f M is a bijection.</formula><p>Finally, we prove that f M is an homeomorphism, i.e., f M and f -1 M are both continuous, by proving the metric equivalence (9). First, note that</p><formula xml:id="formula_60">z x 1 j -z x 2 j = (M x 1 ) i -max k (M x 1 ) k -(M x 2 ) i + max k (M x 2 ) k j ∈ J i 0 j / ∈ ∪ i J i , so we consider r 1 , r 2 ∈ [m] such that (M x 1 ) r1 = max k (M x 1 ) k and (M x 2 ) r2 = max k (M x 2 ) k . We then have z x 1 r1 -z x 2 r1 ≥ 0, z x 1 r2 -z x 2 r2 ≤ 0.<label>(12)</label></formula><p>Hence,</p><formula xml:id="formula_61">d n tr (z x 1 , z x 2 ) = ∥z x 1 -z x 2 ∥ tr = max a,b∈[n] {z x 1 a -z x 2 a -z x 1 b + z x 2 b } = max a,b∈∪iJi {z x 1 a -z x 2 a -z x 1 b + z x 2 b } = max r,s∈[m] {(M x 1 ) r -(M x 2 ) r -(M x 1 ) s + (M x 2 ) s } = d m tr (M x 1 , M x 2 ). (<label>13</label></formula><formula xml:id="formula_62">)</formula><p>Notice that (12) allows us to restrict the maximum to ∪ i J i , as for all j not in ∪ i J i we have that z x 1 j -z x 2 j = 0. We now prove the first half of (9). Firstly, by the triangle inequality, (13), and the non-expansivity of M (Proposition 9), we note:</p><formula xml:id="formula_63">1 3 d n tr (x 1 -z x 1 , x 2 -z x 2 ) = 1 3 ∥x 1 -z x 1 -x 2 + z x 2 ∥ tr ≤ 1 3 ∥x 1 -x 2 ∥ tr + ∥z x 2 -z x 1 ∥ tr = 1 3 d n tr (x 1 , x 2 ) + d m tr (M x 1 , M x 2 ) ≤ 2 3 d n tr (x 1 , x 2 ).</formula><p>Adding this to the non-expansive inequality gives us the left hand inequality of ( <ref type="formula" target="#formula_50">9</ref>):</p><formula xml:id="formula_64">1 3 d m tr (M x 1 , M x 2 ) + 1 3 d n tr (x 1 -z x 1 , x 2 -z x 2 ) ≤ d n tr (x 1 , x 2 ).</formula><p>We now prove the second half of (9):</p><formula xml:id="formula_65">d n tr (x 1 , x 2 ) = ∥x 1 -z x 1 -x 2 + z x 2 + z x 1 -z x 2 ∥ tr ≤ ∥x 1 -z x 1 -x 2 + z x 2 ∥ tr + ∥z x 1 -z x 2 ∥ tr = d n tr (x 1 -z x 1 , x 2 -z x 2 ) + d m tr (M x 1 , M x 2 ),</formula><p>where we used the triangle inequality and ( <ref type="formula" target="#formula_61">13</ref>). This shows strong equivalence of the metrics, proving that f is a homeomorphism.</p><p>This product space structure of R n /R1 will allow us to prove that when optimising over simple projections, the projective and embedding Wasserstein distances on tropical projective tori are the same.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Tropical Wasserstein Mappings for Different Dimensions</head><p>Given the tropical tools and results established above, we are now equipped to present our main theoretical result; when we use simple projections as our inter-dimensional tropical maps, the projection and embedding Wasserstein distances coincide as in the Euclidean case.</p><p>Following the presentation of our main result in this section, we discuss implications of our work in the setting of phylogenetic trees.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Equivalent Tropical Wasserstein Distances</head><p>We define our set of simple projections from R n /R1 to R m /R1 by</p><formula xml:id="formula_66">M tr := {ϕ M : R n /R1 → R m /R1 : ϕ M (x) = M x where M is a simple projection}.</formula><p>We note each ϕ ∈ M tr is measurable as it is continuous.</p><p>The sets of projected and embedded measures Φ </p><formula xml:id="formula_67">W - tr,p (µ, ν) = inf β∈Φ - tr (ν,m) W tr,p (µ, β), W + tr,p (µ, ν) = inf α∈Φ + tr (µ,n) W tr,p (α, ν).</formula><p>We begin by establishing the following lemma, which verifies that simple projections are non-expansive on P p (R n /R1) as well as on R n /R1. Proposition 19. For all p ∈ [0, ∞), ϕ ∈ M tr and α, ν ∈ P p (R n /R1), we have</p><formula xml:id="formula_68">W tr,p (ϕ * (α), ϕ * (ν)) ≤ W tr,p (α, ν).</formula><p>Proof. This proof follows the same approach as the proof of Lemma 2.1 by <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref>.</p><p>Let π ∈ P ((R n /R1) 2 ) be the optimal transport coupling for α and ν. Then define π m ∈ P ((R m /R1) 2 ) as the push-forward of π through ϕ × ϕ:</p><formula xml:id="formula_69">π m (A × B) = π(ϕ -1 (A) × ϕ -1 (B)).</formula><p>Checking the marginals of π m , we have</p><formula xml:id="formula_70">π m (A, R m /R1) = π(ϕ -1 (A) × R n /R1) = α(ϕ -1 (A)) = ϕ * (α)(A), π m (R m /R1, B) = π(R n /R1 × ϕ -1 (B)) = ν(ϕ -1 (B)) = ϕ * (ν)(B).</formula><p>Therefore, π m is a coupling of ϕ * (α) and ϕ * (ν). We can then bound the Wasserstein distance between ϕ * (α) and ϕ * (ν) by:</p><formula xml:id="formula_71">W tr,p (ϕ * (α), ϕ * (ν)) p ≤ E (X,Y )∼πm [d tr (X, Y ) p ] = E (U,V )∼π [d tr (ϕ * (U ), ϕ * (V )) p ] ≤ E (U,V )∼π [d tr (U, V ) p ] = W tr,p (α, ν) p ,</formula><p>where for the last inequality, we used the non-expansive property (Proposition 9).</p><p>Remark 20. Notice that although stated for simple projections, in the proof, we only used the non-expansive property so the proposition holds for any tropical matrix map.</p><p>As well as relating Wasserstein distances across spaces, Proposition 19 gives us the following corollary ensuring finite moments.</p><p>Corollary 21. For any ν ∈ P p (R n /R1) and any ∈ M tr , the push-forward ϕ * (ν) has finite pth moment; that is, ϕ * (ν) ∈ P p (R m /R1).</p><p>Proof. In order to prove that ϕ * (ν) has finite pth moment, we only need to show that there exists a measure with finite pth moment from which ϕ * (ν) has finite p-Wasserstein distance. Consider the Dirac measure on R m /R1, concentrated in 0. This can be seen as the push-forward of a Dirac measure in R n /R1 with the support in any point of x 0 ∈ F 0 . Let δ x be the Dirac measure concentrated at x. Then we can write</p><formula xml:id="formula_72">W tr,p (δ 0 , ϕ * (ν)) = W tr,p (ϕ * (δ x0 ), ϕ * (ν)) ≤ W tr,p (δ x0 , ν) &lt; ∞.</formula><p>Here, notice the last term is finite since ν has finite moments by definition.</p><p>We now state and prove our main theorem: the equivalence of the tropical projection and embedding Wasserstein distances W - tr,p and W + tr,p . Theorem 22. Let p ∈ [1, ∞). For all µ ∈ P p (R m /R1) and ν ∈ P p (R n /R1), W - tr,p (µ, ν) = W + tr,p (µ, ν) &lt; ∞.</p><p>Proof. The various results in Subsection 3.2 enable us to follow the same approach as in Theorem 2.2 of <ref type="bibr" target="#b6">Cai &amp; Lim (2022)</ref>.</p><p>We begin by proving W - tr,p ≤ W + tr,p . By Proposition 19,</p><formula xml:id="formula_73">W + tr,p (µ, ν) = inf ϕ∈Mtr {W tr,p (α, ν) : µ = ϕ * (α)} ≥ inf ϕ∈Mtr {W tr,p (µ, ϕ * (ν))} = W - tr,p (µ, ν).</formula><p>Note that each W tr,p (µ, ϕ * (ν)) is finite by Corollary 21. Hence, W + tr,p (µ, ν) is finite. In order to show that W - tr,p (µ, ν) ≤ W + tr,p (µ, ν), we prove that for all ϵ &gt; 0, and</p><formula xml:id="formula_74">β ϵ ∈ Φ - tr,p (ν, m) such that W p (µ, β ϵ ) ≤ W - p (µ, ν) + ϵ, there exists α ϵ ∈ Φ + tr (µ, n) such that W tr,p (α ϵ , ν) ≤ W tr,p (µ, β ϵ )</formula><p>. Indeed, if our claim is true, then we have ∀ ϵ &gt; 0:</p><formula xml:id="formula_75">W + tr,p (µ, ν) ≤ W tr,p (α ϵ , ν) ≤ W tr,p (µ, β ϵ ) ≤ W - p (µ, ν) + ϵ.</formula><p>Letting ϵ tend to 0 gives us the desired result. Now let ϕ M be the simple projection sending ν to β ϵ , i.e., β ϵ = ϕ M (ν). Using the homeomorphism f M as defined in Proposition 18, we define the complementary projection to ϕ M as ϕ F0 M ; that is, ϕ F0 M = proj 2 • f M . We then construct α ϵ by defining a coupling on R n /R1 × R n /R1 with marginals ν, α ϵ . We first consider R m /R1 × F 0 × R m /R1 and look to apply the gluing lemma to f M (ν) and π m .</p><p>Lemma 23. <ref type="bibr" target="#b36">(Villani, 2009</ref>, Chapter 1) Let (X i , µ i ), i = 1, 2, 3 be Polish spaces. Let (X 1 , X 2 ) be a coupling of (µ 1 , µ 2 ) and (X 2 , X 3 ) be a coupling of (µ 2 , µ 3 ). Then there exists a coupling of random variables</p><formula xml:id="formula_76">(Z 1 , Z 2 , Z 3 ) such that (Z 1 , Z 2 ) ∼ (X 1 , X 2 ) and (Z 2 , Z 3 ) ∼ (X 2 , X 3 ).</formula><p>The space R m /R1 is Polish, while F 0 is a closed subset of a Polish space and is therefore also Polish. Hence, by the gluing lemma, there exist random vectors (X, Y, Z) on R m /R1 × F 0 × R m /R1 such that (X, Y ) ∼ f M (ν) and (X, Z) ∼ π m . We call the distribution of (X, Y, Z) ∼ π.</p><p>We now define ρ :</p><formula xml:id="formula_77">R m /R1 × F 0 × R m /R1 → (R n /R1) 2 given by ρ(x, y, z) → (f -1 M (x, y), f -1 M (z, y)).</formula><p>This is a measurable map as f -1 M is continuous. We then define a coupling π n on (R n /R1) 2 and measure α ϵ by π n = ρ(π) and α ϵ = proj 2 (π n ). It remains to show that π n is a coupling of ν, α ϵ , the distance W tr,p (α ϵ , ν) is bounded by W tr,p (µ, β ϵ ), and that α ϵ ∈ Φ + (µ, n).</p><p>Since α ϵ is the second marginal of π n by definition, it suffices to compute the first marginal:</p><formula xml:id="formula_78">π n (A, R n /R1) = π(ρ -1 (A, R n /R1)) = π(f M (A), R m /R1) = ν(A).</formula><p>We now want to bound W tr,p (α ϵ , ν) using π n . We begin by showing that for any (x, y) ∈ R m /R1 × F 0 and z ∈ R m /R1, we have d n tr (ρ(x, y, z)) = d m tr (x, z). We obtain the lower bound on d n tr (ρ(x, y, z)) through the following argument:</p><formula xml:id="formula_79">d n tr (ρ(x, y, z)) = d n tr (f -1 M (x, y), f -1 M (z, y)) ≥ d m tr (ϕ M (f -1 M (x, y)), ϕ M (f -1 M (z, y))) = d m tr (x, z),</formula><p>in which we used Proposition 9 for the inequality, while the equalities come from the definitions of ρ and f M , respectively. Using the upper bound of (9) gives the upper bound:</p><formula xml:id="formula_80">d n tr (ρ(x, y, z)) = d n tr (f -1 M (x, y), f -1 M (z, y)) ≤ d m tr (x, z) + d n tr (ϕ F0 M (f -1 M (x, y)), ϕ F0 M (f -1 M (z, y))) = d m tr (x, z) + d n tr (y, y) = d m tr (x, z).</formula><p>This gives us the following upper bound for W tr,p (α ϵ , ν):</p><formula xml:id="formula_81">W tr,p (α ϵ , ν) p ≤ E U,V ∼πn [d n tr (U, V ) p ] = E X,Y,Z∼π [d n tr (ρ(X, Y, Z)) p ] = E X,Y,Z∼π [d m tr (X, Z) p ] = E X,Z∼πm [d m tr (X, Z) p ] = W tr,p (µ, β ϵ ) p .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Finally, it only remains to show that α</head><formula xml:id="formula_82">ϵ ∈ Φ + (µ, n), i.e., ϕ M (α ϵ ) = µ: ϕ M (α ϵ )(A) = π n (R n /R1, ϕ -1 M (A)) = π(ρ -1 (R n /R1, ϕ -1 M (A))) = π(R m /R1, F 0 , A) = π m (R m /R1, A) = µ(A).</formula><p>Given this equivalence, from now on, we now denote W - tr,p , W + tr,p by W m,n tr,p .</p><p>Remark 24. We stress that this proof only relies on ϕ ∈ M being a simple projection, and not M tr exhibiting any closure. We can therefore define Φ ± tr , W m,n tr,p with respect to any subset of maps M ′ tr ⊂ M tr and reach the same result.</p><p>However, it is important to note that the quantity W m,n tr,p (µ, ν) is not a formal metric. Indeed, we can have W m,n tr,p (µ, ν) = 0 for µ ̸ = ν if, say, ϕ ∈ M tr , such that ν = ϕ * (µ).</p><p>Proposition 25. The distance W m,n tr,p is 1-Lipschitz continuous on (P p (R m /R1), W tr,p )×(P p (R n /R1), W tr,p ).</p><p>Proof.</p><formula xml:id="formula_83">|W m,n tr,p (µ 1 , ν 1 )-W m,n tr,p (µ 2 , ν 2 )| = inf ϕ∈Mtr W tr,p (µ 1 , ϕ * (ν 1 )) -inf ϕ∈Mtr W tr,p (µ 2 , ϕ * (ν 2 )) ≤| inf ϕ∈Mtr [W tr,p (µ 1 , µ 2 ) + W tr,p (µ 2 , ϕ * (ν 2 )) + W tr,p (ϕ * (ν 2 ), ϕ * (ν 1 ))] -inf ϕ∈Mtr W tr,p (µ 2 , ϕ * (ν 2 ))| ≤| inf ϕ∈Mtr [W tr,p (µ 1 , µ 2 ) + W tr,p (µ 2 , ϕ * (ν 2 )) + W tr,p (ϕ * (ν 2 ), ϕ * (ν 1 ))] -inf ϕ∈Mtr W tr,p (µ 2 , ϕ * (ν 2 ))| ≤|W tr,p (µ 1 , µ 2 ) + W tr,p (ϕ * (ν 2 ), ϕ * (ν 1 )) + inf ϕ∈Mtr [W tr,p (µ 2 , ϕ * (ν 2 ))] -inf ϕ∈Mtr W tr,p (µ 2 , ϕ * (ν 2 ))| ≤ |W tr,p (µ 1 , µ 2 ) + W tr,p (ν 2 , ν 1 )| ≤ W tr,p (µ 1 , µ 2 ) + W tr,p (ν 2 , ν 1 ).</formula><p>This in turn gives the following implication for estimation of W m,n tr,p (µ, ν).</p><p>Corollary 26. Let X = {x 1 , . . . , x r } ⊂ R n /R1 and Y = {y 1 , . . . , y s } ⊂ R m /R1 sampled independently from µ ∈ P p (R m /R1) and ν ∈ P p (R n /R1), respectively. Consider μr and νs , the empirical measures of X and Y .Then W m,n tr,p = W m,n tr,p (μ r , νs ) is a consistent estimator for W m,n tr,p (µ, ν).</p><p>Proof. By Proposition 25 and the fact that Wasserstein distances respect weak convergence of measures (e.g., <ref type="bibr">Villani, 2009, Theorem 6</ref>.9), we only require the weak convergence of μr (/ν s ) to µ(/ν) as r(/s) tend to infinity. This is true by the law of large numbers as R n /R1 is a Polish space <ref type="bibr" target="#b26">(Monod et al., 2018)</ref>.</p><p>In this section we have defined simple projection matrices, the most general tropically linear maps through which we can project and embed measures while preserving non-expansivity and co-dimension. We have shown that the projection and embedding Wasserstein distances (defined with respect to simple projections) coincide as in the Euclidean case, despite the more complex geometry of the tropical projective torus. Furthermore, we have shown that this Wasserstein distance is Lipschitz, and so can be estimated consistently using samples from measures µ, ν.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Open Problems and Implications: Phylogenetic Trees</head><p>To conclude this section, we return to the application of interest which motivated our work -tropical phylogenetic tree space. We have constructed projection and embedding Wasserstein distances between probability measures in tropical projective tori of different dimensions, and proved that the projection and embedding distances are equivalent. We would like to be able to use this tool to compare probability distributions over phylogenetic tree spaces -which are subspaces within tropical projective tori -where the numbers of leaves in the trees differ. There are, however, important theoretical considerations to take into account which are specific to phylogenetic trees.</p><p>The tropical space of phylogenetic trees with N leaves is characterised by those points in R N (N -1)/2 /R1 satisfying the four-point condition <ref type="bibr" target="#b5">(Buneman, 1974)</ref>.</p><p>Definition 27 (Four-Point Condition). Let d be a metric on N points. Then d corresponds to the graph distance on some tree with N leaves if and only if, ∀i, j, k, l ∈ [N ], the maximum of the following three terms is achieved twice:</p><formula xml:id="formula_84">d(i, j) + d(k, l), d(i, k) + d(j, l), d(i, l) + d(j, k).</formula><p>Definition 28 (Tropical Tree Space). The tropical tree space on N leaves, denoted by T N , is the set of vectors x ∈ R N (N -1)/2 /R1 such that {x ij } i̸ =j∈[N ] satisfies the four-point condition.</p><p>In light of these definitions, when calculating Wasserstein distances between measures which are supported on tropical tree space, it is natural to ask; which simple projections map tropical tree space into tropical tree space? Do such maps necessarily minimise the Wasserstein distance? The advantages of studying these simple projections are two-fold; we may be able to speed up computations by computing an infimum over a subset of simple projections rather than over all simple projections, and a theoretical understanding such maps may allow us to interpret the optimal simple projection as interpretable relations between the two leaf sets. Formally, we pose these questions in the following way:</p><p>Open Problem 29. Let MT tr be the set of simple projections M such that, for all x ∈ R N (N -1)/2 /R1 satisfying the four-point condition, M x ∈ R M (M -1)/2 /R1 satisfies the four-point condition. Can we find a parametric description of the set MT tr ? Open Problem 30. Suppose µ ∈ P p (T N ) and ν ∈ P p (T M ). Is it true that</p><formula xml:id="formula_85">W m,n tr,p (µ, ν) := inf M ∈Mtr W tr,p (M µ, ν) = inf M ∈MTtr W tr,p (M µ, ν)?</formula><p>A natural approach to Open Problem 29 may involve utilising the deep connections between tropical geometry and matroid theory <ref type="bibr" target="#b2">(Ardila &amp; Klivans, 2006)</ref>, which is beyond the scope of this paper. An affirmative proof of Open Problem 30 would most likely require the parametrisation of MT tr from Open Problem 29, but it may be possible to directly construct a counter-example by exploiting the lack of tropical convexity of tropical tree space.</p><p>It may also be useful to first address simpler versions of Open Problems 29 and 30 by restricting to the case of ultrametric trees. These are special cases of phylogenetic trees which are equidistant; they are rooted phylogenetic trees where the distance from every leaf to its root is a constant. The set of such trees forms a tropical linear space, and hence is tropically convex <ref type="bibr" target="#b21">(Lin et al., 2017)</ref>. This convexity has been recently used to characterise the combinatorial behaviour of tree topologies in the tropical setting <ref type="bibr" target="#b22">(Lin et al., 2022)</ref>. The Open Problems 29 and 30 can also be posed with respect to ultrametric tree space rather than general tropical tree space, and may prove to be more tractable by utilising the tropical convexity of ultrametric space.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Computation</head><p>Having defined tropical projection and embedding Wasserstein distances with sufficiently nice theoretical properties, in this section we demonstrate how existing optimisation techniques can be used for the computation of W m,n tr,p . The computation of W m,n tr,p is not a simple optimisation problem, as we require a minimal Wasserstein distance over the set of simple projections, which is a disconnected set. Lemma 31 shows that we can separate this problem into discrete and continuous parts by expressing W m,n tr,p as a minimisation problem over three components; the support of real entries in the simple projection matrix, the exact real entries of our matrix, and the joint weights λ r,s between the data points x r and y s . The proof of this lemma can be found in Appendix A.</p><p>Lemma 31. Let X = {x} r∈[R] and Y = {y} s∈[S] be finite datasets in R n /R1 and R m /R1 respectively. The Wasserstein distance W m,n tr,p (X, Y ) is the infimum of the function</p><formula xml:id="formula_86">f (M, λ, t) = r,s λ r,s ∥M (x (r) + t) -y∥ p tr 1/p (<label>14</label></formula><formula xml:id="formula_87">)</formula><p>where t ∈ R N /R1, λ is a joint probability matrix with uniform marginals on [R] and [S], and M ∈ M ′ tr , where M ′ tr is the set of simple projections with all real entries equal to zero and exactly one real entry per column.</p><p>In this section we first outline the existing optimisation methods which can be used to optimise over M, λ, and t independently, before combining these methods to present our coordinate descent algorithm (Algorithm 1) for the computation of W m,n tr,p (X, Y ). We then apply this algorithm to simulated branching process data, coalescent data, and Gaussian data. To conclude, we compute the Wasserstein distances between phylogenetic influenza datasets across different annual seasons. The full results of numerical experiments are presented in Appendices B and C; the implementation for these experiments and the computations on simulated and real data are available in the GitHub repository at <ref type="url" target="https://github.com/Roroast/WDDD">https://github.com/Roroast/WDDD</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Algorithm</head><p>We take a coordinate descent approach to the minimisation of the objective given in ( <ref type="formula" target="#formula_86">14</ref>), iteratively minimising a single component while fixing the others. To optimise the shift component t, we will consider gradient methods as f is piece-wise polynomial in terms of t. We will implement simulated annealing to solve the discrete optimisation problem of the optimal matrix support M , while optimising over λ is a classic discrete optimal transport problem, which is a linear program with efficient solvers <ref type="bibr" target="#b12">(Flamary et al., 2021)</ref>. In the following subsections we review various options for the gradient based optimisation of t and possible graph structures for simulated annealing in M , with full numerical experiments to compare the performances of various methods in Appendices B and C.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.1">Gradient Methods and Learning Rate</head><p>The objective function given in ( <ref type="formula" target="#formula_86">14</ref>) -for fixed M, λ -is piecewise polynomial in t with regions of sparse gradient. This raises what is known as the zig-zagging problem; when outside the tropical convex hull of the data, the sparse gradient of f can cause gradient methods to zig-zag across a "valley" of local minima. This behaviour is explored by <ref type="bibr" target="#b33">Talbut &amp; Monod (2024)</ref>, where it is shown that tropical gradient methods can achieve smaller error on average and avoid convergence to local (non-global) minima.</p><p>In this paper we consider classical gradient descent (CD), tropical gradient descent (TD), Adamax (CA) and TrAdamax (TA) for the optimisation of t, and provide an outline of these methods below. For a detailed explanation and motivation for their implementation, see <ref type="bibr" target="#b33">Talbut &amp; Monod (2024)</ref>.</p><p>Classical gradient descent(CD) follows the steepest descent algorithm with respect to the Euclidean norm. This is given by the following iterative rule:</p><formula xml:id="formula_88">t k+1 = t k -α k d k , α k = αk -1/2 ∥∇f (t k )∥, d k = ∇f (t k ).<label>(15)</label></formula><p>Tropical gradient descent(TD) follows the steepest descent algorithm with respect to the tropical norm, which leads to the following iterative rule:</p><formula xml:id="formula_89">t k+1 = t k -α k d k , α k = αk -1/2 ∥∇f (t k )∥ tr , d k = 1 ∇f (t k )&gt;0 .<label>(16)</label></formula><p>Adamax(CA) is a variant of the Adam algorithm <ref type="bibr" target="#b18">(Kingma, 2014)</ref>, which uses exponentially weighted moments of the gradient to act as momentum terms. These momentum terms can independently adapt step sizes in each coordinate direction appropriately. While Adam uses L 2 moments of the gradient, Adamax uses L ∞ moments and is shown to behave better than Adam in tropical optimisation problems <ref type="bibr" target="#b33">(Talbut &amp; Monod, 2024)</ref>.</p><p>TrAdamax(TA) is a heuristic adaptation of the Adamax algorithm, which uses exponentially weighted moments of the tropical descent directions 1 ∇f (t k )&gt;0 , rather than the gradient ∇f (t k ).</p><p>Using data of varying dimensionality and distribution, we implemented CA, CD, TA and TD for the minimisation of the loss function f with respect to t. We present the full methodology and results in Appendix B, while Table <ref type="table" target="#tab_0">1</ref> presents the mean loss over all data types. We see that TA (with learning rate α = e -1 ) achieves the best mean loss. The optimal TA learning rates for each data dimension pair is presented in Table <ref type="table">2</ref> Table 2:</p><p>The TA learning rate α achieving the minimal mean loss f over 10 initialisations and 9 sample distributions for each dimension pairs m ≤ n ∈ {6, 10, 15}.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.2">Simulated Annealing Graph and Scale</head><p>The most intensive challenge in minimising the objective ( <ref type="formula" target="#formula_86">14</ref>) is the combinatorial problem of identifying the optimal support of our matrix map. As shown in Lemma 31, it suffices to consider matrices with exactly one real entry in each column as we are computing on finite datasets. We can identify this set of supports with the set of surjections [n] → [m], so the size of this set is given explicitly by m!S(n, m), where S(n, m) is the Stirling number of the second kind. Table <ref type="table">3</ref> shows these values for m ≤ n ≤ 6.</p><p>n m 1 2 3 4 5 6 1 1 2 1 2 3 1 6 6 4 1 14 36 24 5 1 30 150 240 120 6 1 62 540 1560 1800 720</p><p>Table <ref type="table">3</ref>: The number of possible matrix supports of n × m simple projections.</p><p>Due to the exponential growth of the number of supports, we implement simulated annealing <ref type="bibr" target="#b19">(Kirkpatrick et al., 1983)</ref> rather than an exhaustive search to find the optimal support. Simulated annealing is a Metropolis procedure on the set of supports, where we perform a random walk and accept any step which decreases f , while accepting increasing steps with probability exp(-∆f /T (k)), where T is linearly decreasing in the step number k.</p><p>To implement simulated annealing, we require a graph structure on our set of possible supports G = (M ′ tr , E); we shall consider E to contain exactly those edges between two supports M 1 , M 2 whose matrices differ in exactly one column or are the same up to column permutations. For any dimensions n, m, this results in a connected graph of supports. As a benchmark, we compare the computational performance of this graph G with a complete graph K. We also optimise over the scale factor σ of the linearly decreasing T (k). The full methodology and results are in Appendix C, while Table <ref type="table" target="#tab_2">4</ref> summarises the mean loss of simulated annealing with respect to the graph structure. The incomplete graph G outperforms the complete graph K, achieving minimal mean loss with a scale of e -2 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.3">Coordinate Descent Algorithm</head><p>Informed by the numerical experiments presented in Appendices B and C, our complete algorithm for the minimisation of the objective ( <ref type="formula" target="#formula_86">14</ref>) is given by Algorithm 1, with the default hyper-parameters given by the Table 5: The simulated annealing scale σ achieving the minimal mean loss f over 10 initialisations and 9 sample distributions for each dimension pairs m ≤ n ∈ {6, 10, 15}.</p><p>optimal learning rate α and scale σ shown in Tables <ref type="table">2</ref> and <ref type="table">5</ref>. To solve the optimal transport linear program for the optimal λ, we use the POT Python package <ref type="bibr" target="#b12">(Flamary et al., 2021)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Simulated Data</head><p>To visualise the results of Algorithm 1 and compare distances between distributions of different types, we consider simulated datasets of sample size 50 taken from branching tree and coalescent tree distributions on T 4 ⊂ R 6 /R1, T 5 ⊂ R 10 /R1, T 6 ⊂ R 15 /R1, as well as standard Gaussian distributions on R 6 , R 10 , R 15 . These distributions are all coordinate invariant, and so symmetric about the origin of the tropical projective torus. We therefore normalise these datasets by the average tropical norm of their data points to remove effects of the dimensionality on the scale of the data.</p><p>We then run Algorithm 1 for k max = 40 steps, and run simulated annealing and TrAdamax for i max , j max = 50 sub-steps for each k to compute the Wasserstein distances between branching process, coalescent, and Gaussian data in R 6 /R1, R 10 /R1, R 15 /R1. For each dataset pair, we run Algorithm 1 from 10 random initialisations and take the minimal value over all initialisations. Figure <ref type="figure">5</ref> shows the Wasserstein distances between these datasets as a matrix heatmap. We note from Figure <ref type="figure">5</ref> that the datasets from coalescent processes have a greater Wasserstein distance to other datasets, even to other coalescent datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Computation for Influenza Data</head><p>To conclude the computational section of this paper, we use Algorithm 1 to compute Wasserstein distances between real phylogenetic datasets which are supported on different datasets.</p><p>We use the pre-processed phylogenetic influenza datasets presented by <ref type="bibr" target="#b26">Monod et al. (2018)</ref>; this phylogenetic data is computed from the genetic sequences of the influenza A H3N2 hemagglutinin obtained for New York, 1993-2017, from the GISAID EpiFlu™database <ref type="bibr" target="#b11">(Elbe &amp; Buckland-Merrett, 2017)</ref>. The raw genomic data was then aligned using MUSCLE <ref type="bibr" target="#b10">(Edgar, 2004)</ref> with default settings, to construct a single large phylogenetic tree for the influenza strains across all seasons. Finally, tree dimensionality reduction <ref type="bibr" target="#b39">(Zairis et al., 2016)</ref> is applied to represent this large phylogenetic tree as a dataset of smaller trees using temporal windows of 5 years; this produces 21 datasets of approximately 20,000 trees each, where the leaf set of a given dataset corresponds to 5 consecutive years. For further details on data pre-processing, see <ref type="bibr" target="#b26">Monod et al. (2018)</ref>.</p><p>From each dataset, we sub-sample 50 tree data points to reduce the computational load on the optimal transport calculations. We use the R package APE <ref type="bibr" target="#b29">(Paradis et al., 2004)</ref> to compute the pairwise leaf distances from the Newick tree format for each tree, to produce 21 datasets of 50 data points of dimension 10. We note that though the dimensionality of each dataset is the same, the dimensions for each dataset correspond to different pairs of years; there is therefore no natural correspondence between the dimensions of the 1993-1997 dataset and the 2013-2017 dataset.</p><p>Figure <ref type="figure">5</ref>: The computed Wasserstein distance between branching, coalescent and Gaussian data of dimension 6, 10 and 15. We take a minimum over 10 initialisations of Algorithm 1, and use the tuned learning rate and scale from Tables <ref type="table" target="#tab_0">1</ref> and <ref type="table" target="#tab_2">4</ref>.</p><p>Figure <ref type="figure">6</ref> shows the computed Wasserstein distances between the 21 datasets. From Figure <ref type="figure">6</ref>, we observe that all datasets for temporal windows containing 2002 have relatively small distances to each other, while having larger distances to all other seasons. We note that this time window has significant overlap with the prominence of the A/Fujian/411/2002 virus strain, which led to an ineffective trivalent inactivated influenza vaccine in 2003 (Centers for Disease Control and Prevention (CDC) and others, 2004). We also observe a small computed Wasserstein distance between the datasets of <ref type="bibr">1996-2000 and 2003-2007</ref>, which may reflect the mutation reassortment events which are discussed by <ref type="bibr" target="#b15">Holmes et al. (2005)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Discussion</head><p>In this manuscript, we have studied the problem of comparing probability distributions over tropical projective tori with different dimensions and formulated an inter-dimensional Wasserstein distance for this purpose. Our construction was largely inspired by a recent solution to the same problem in Euclidean spaces. We highlighted the key components of semi-orthogonal maps used in the Euclidean setting and identified tropical matrices with the same properties to be able to arrive at the same conclusion on tropical projective tori. Specifically, we studied tropical simple projections; only the basic properties of non-expansivity, surjectivity, and fibres of consistent dimension were required in order to achieve the same result as in the Euclidean setting, even though the tropical projective torus can be seen as comparatively more restrictive (e.g., it is not a Hilbert space under the tropical norm <ref type="bibr" target="#b1">(Améndola &amp; Monod, 2024)</ref>).</p><p>Considering our motivating application of phylogenetic statistics, it would be natural to build on this work by a consideration of how simple projections act on tree space; which simple projections map tree space to tree space? Does it suffice to consider such maps when finding the optimal map between tree datasets? Can a simple projection which maps tree space to tree space be described by operations on leaves? These questions, which we discussed in more detail in Subsection 4.2 present the opportunity to improve the speed of calculations through a restricted search of simple projections, as well as gaining more interpretability from Figure <ref type="figure">6</ref>: The computed Wasserstein distance between branching, coalescent and Gaussian data of dimension 6, 10 and 15. We take a minimum over 10 initialisations of Algorithm 1, and use the tuned learning rate and scale from Tables <ref type="table" target="#tab_0">1</ref> and <ref type="table" target="#tab_2">4</ref>. our calculations on the leaf level.</p><p>While our computational method in Algorithm 1 is a natural heuristic approach and easy to implement, further research into more sophisticated optimisation tools for calculating tropical projection Wasserstein distances would significantly improve the applicability of our distance. Currently, we lack confidence bounds on our computations in Section 5, and we can see immediately that our computations are not necessarily accurate; in Figure <ref type="figure">5</ref>, we see datasets whose distance to themselves is not zero. This may be a result of simulated annealing never reaching the optimal support as it is more common for datasets of higher dimension, but without confidence bounds our distances lack interpretability.</p><p>Finally, while tropical projection Wasserstein distances may be a useful tool for certain statistical methods such as clustering, utilising these distances for more refined model selection methods would require an understanding of their behaviour for standard tree models such as branching and coalescent processes. The computed values shown in Figure <ref type="figure">5</ref> do not suggest a clear pattern in the distances between datasets of the same distribution but different dimensionality, but there are many avenues for further numerical experiments. By computing distances between several samples from the same distribution, we may see some indication as to which distributions are well-clustered under the tropical projection Wasserstein distance and hence can be detected for model selection using this distance.</p><p>Academy of Doctoral Studies (JADS) award (2021 cohort, PIs Drton/Monod), from which R.T. also receives partial support.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix A Proof</head><p>Proof of Lemma 31. Consider a simple projection matrix M , and let M ′ be a tropical matrix map with exactly one real entry per column such that M ij ∈ R ⇒ M ′ ij = 0. We begin by showing that on any ball B 0 (r) in R n /R1, there is some t ∈ R n /R1 such that M (x) = M ′ (x + t).</p><p>For each j ∈ ∪ i J i , let i j be the unique i such that j ∈ J i . Then we can define a vector t ∈ R n by</p><formula xml:id="formula_90">t j = -2r + min{M ij : M ij ̸ = -∞} if j / ∈ ∪ i J i M ij j</formula><p>otherwise.</p><p>We now show that for x ∈ B 0 (r), we have M x = M ′ (x + t). Let J ′ i be the support sets for M ′ . By definition, the sets J ′ i are disjoint, partition [n] exactly, and</p><formula xml:id="formula_91">J i ⊆ J ′ i . M ′ (x + t) = max j∈J ′ i {M ′ ij + x j + t j } = max{max j∈Ji {x j + M ij }, max j∈J ′ i \Ji x j + -2r + min{M ij : M ij ̸ = -∞}} = max j∈Ji {x j + M ij } = M (x)</formula><p>where the penultimate equality comes from ∥x∥ tr ≤ r. Now, denoting the empirical measure of X as ν X , our set of projected measures becomes: where the constraints on t, M ′ and λ are as described.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix B Gradient Methods</head><p>These experiments are aimed at the computation of the 2-Wasserstein projected distance W m,n tr,2 , and are restricted to samples X, Y of equal sizes R = S to reduce the computational complexity of optimal transport calculations.</p><p>We test the gradient methods CD, TD, CA, TA in the following way; for each dimension pair m ≤ n ∈ {6, 10, 15}, we have 9 dataset pairs (X, Y ) where X, Y have been taken from a branching, coalescent or Gaussian distribution. We then run Algorithm 1 with 10 random initialisations for max iters = 40. Each iteration of Algorithm 1 involves 50 steps of the specified gradient method -we do not perform any λ, M optimisation to minimise the random noise present. We do this for each dataset and gradient method for learning rates on a log scale between e -6 , e 4 . Table <ref type="table" target="#tab_4">6</ref> shows the mean loss achieved over 10 randomised initialisations and all 9 dataset pairs for each dimension pair and gradient settings.</p><p>We see that when n = m, classical and tropical methods behave similarly; their optimal mean loss is the same, though this minimum is achieved for different learning rates. However, when m &lt; n the tropical methods consistently achieve a smaller mean loss.  <ref type="bibr">.196 1.196 1.196 1.196 1.196 1.194 1.195</ref>  </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: The tropical ball under φ : R 3 /R1 → R 2</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: R 3 /R1 ∼ = R 2 partitioned by type with respect to M := a b c d e f .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: R 3 /R1 ∼ = R 2 partitioned by type with respect to M in Example 12.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><figDesc>- tr and Φ + tr are now given by Φ - tr (ν, m) := {β ∈ P (R m /R1) : β = ϕ * (ν) for some ϕ ∈ M tr }, Φ + tr (µ, n) := {α ∈ P (R n /R1) : µ = ϕ * (α) for some ϕ ∈ M tr }, while the tropical projection and embedding Wasserstein distances are given by</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Φ</head><figDesc>(x (r) +t) : t ∈ R n] /R1, M ′ ∈ M ′ express the Wasserstein distance W m,n tr,p by W m,n tr,p (µ, ν) = inf t,M ′ inf λ r,s λ r,s d tr (M ′ (x (r) + t), y) p s ∥M ′ (x (r) + t) -y∥ p tr</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><graphic coords="22,142.20,72.00,327.61,273.36" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><graphic coords="23,142.20,72.00,327.62,269.70" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 :</head><label>1</label><figDesc>.The mean loss f over 10 initialisations, 9 sample distributions and 6 dimension pairs m ≤ n ∈ {6, 10, 15} achieved by classical Adam, classical descent, TrAdamax, and tropical descent. Learning rate is varied on a linear log scale from e -5 , e 4 .</figDesc><table><row><cell>Learning rate, α</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 4 :</head><label>4</label><figDesc>The mean loss over 10 initialisations, 9 sample distributions and 6 dimension pairs m ≤ n ∈ {6, 10, 15} achieved by simulated annealing on the G and K graph structures. Scale is varied on a linear log scale from e -7 , e 2 .</figDesc><table><row><cell>Scale, σ</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 6 :</head><label>6</label><figDesc>Table 6 also shows the mean loss averaged over all dimension pairs; the globally optimum gradient settings are TA, α = 0.3679. The mean loss over 10 initialisations and 9 sample distributions achieved by classical Adam, classical descent, TrAdamax, and tropical descent for data of dimensionality m ≤ n ∈ {6, 10, 15}. Learning rate is varied on a linear log scale from e -6</figDesc><table><row><cell>Learning Rate</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 7 :</head><label>7</label><figDesc>The mean loss over 10 initialisations and 9 sample distributions achieved by simulated annealing on the incomplete and complete graph structures for data of dimensionality m ≤ n ∈ {6, 10, 15}. The scale factor is varied on a linear log scale from e -7</figDesc><table><row><cell>1.320 1.666 1.700</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div><head>Acknowledgments</head><p>The authors wish to thank <rs type="person">Yue Ren</rs> and <rs type="person">Felipe Rincón</rs> for helpful discussions. Y.C. is funded by a <rs type="funder">President</rs>'s PhD Scholarship at <rs type="institution">Imperial College London</rs>. <rs type="person">D.T.'s PhD</rs> scholarship is funded by the <rs type="funder">IGSSE/TUM-GS</rs> via a <rs type="affiliation">Technical University of Munich-Imperial College London Joint</rs></p></div>
			</div>
			<listOrg type="funding">
			</listOrg>

			<div type="availability">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Data Availability</head><p>The code and data used in this article are publicly available in the GitHub repository at <ref type="url" target="https://github.com/Roroast/WDDD">https://github.com/Roroast/WDDD</ref>.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm 1 Minimisation</head><p>Require: σ, α, ϵ &gt; 0,</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix C Simulated Annealing</head><p>As for the training of gradient methods for t optimisation, we run experiments for the 54 pairs of datasets X, Y . Algorithm 1 is run with 10 random initialisations for max iters = 40 and for each k, t optimisation is run for 40 steps using TrAdamax and α = 0.3679. For each k we perform 50 steps of simulated annealing, over which the scale factor decreases linearly from T = σ/ √ k to σ/50 √ k. We perform this computation for the incomplete graph structure described above as well as the complete graph of supports, and for scale factors on a log scale between e -6 , e 2 . The mean loss are then shown in Table <ref type="table">7</ref>.</p><p>We see that for data of any dimensionality, simulated annealing on the incomplete graph G outperforms simulated annealing on the complete graph K. We achieve the best mean loss when using the incomplete graph and the scale factor σ = 0.135.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix D Runtimes</head><p>Experiments were implemented on a AMD EPYC 7742 node using a single core, 8 GB. The average runtime over all simulated dataset computations was 2.90s. The average runtime over all real dataset computations was 3.66s.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Tropical logistic regression model on space of phylogenetic trees</title>
		<author>
			<persName><forename type="first">Georgios</forename><surname>Aliatimis</surname></persName>
		</author>
		<author>
			<persName><surname>Yoshida</surname></persName>
		</author>
		<author>
			<persName><surname>Ruriko</surname></persName>
		</author>
		<author>
			<persName><surname>Boyacı</surname></persName>
		</author>
		<author>
			<persName><surname>Burak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">James</forename><forename type="middle">A</forename><surname>Grant</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bulletin of Mathematical Biology</title>
		<imprint>
			<biblScope unit="volume">86</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1" to="42" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">An invitation to tropical Alexandrov curvature</title>
		<author>
			<persName><forename type="first">Carlos</forename><surname>Améndola</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algebraic Statistics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="181" to="214" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">The Bergman complex of a matroid and phylogenetic trees</title>
		<author>
			<persName><forename type="first">Federico</forename><surname>Ardila</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Caroline</forename><forename type="middle">J</forename><surname>Klivans</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Combinatorial Theory, Series B</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="38" to="49" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<author>
			<persName><forename type="first">David</forename><surname>Barnhill</surname></persName>
		</author>
		<author>
			<persName><surname>Yoshida</surname></persName>
		</author>
		<author>
			<persName><surname>Ruriko</surname></persName>
		</author>
		<author>
			<persName><surname>Aliatimis</surname></persName>
		</author>
		<author>
			<persName><surname>Georges</surname></persName>
		</author>
		<author>
			<persName><surname>Miura</surname></persName>
		</author>
		<author>
			<persName><surname>Keiji</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2309.01082</idno>
		<title level="m">Tropical Geometric Tools for Machine Learning: the TML package</title>
		<imprint>
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Geometry of the space of phylogenetic trees</title>
		<author>
			<persName><forename type="first">Louis</forename><forename type="middle">J</forename><surname>Billera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Susan</forename><forename type="middle">P</forename><surname>Holmes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Karen</forename><surname>Vogtmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Applied Mathematics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="733" to="767" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">A note on the metric properties of trees</title>
		<author>
			<persName><forename type="first">Peter</forename><surname>Buneman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Combin. Theory Ser. B</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="48" to="50" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Distances Between Probability Distributions of Different Dimensions</title>
		<author>
			<persName><forename type="first">Yuhang</forename><surname>Cai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lek-</forename><surname>Lim</surname></persName>
		</author>
		<author>
			<persName><surname>Heng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Information Theory</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="4020" to="4031" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Preliminary assessment of the effectiveness of the 2003-04 inactivated influenza vaccine-Colorado</title>
	</analytic>
	<monogr>
		<title level="j">MMWR. Morbidity and mortality weekly report</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="8" to="11" />
			<date type="published" when="2003">2004. December 2003</date>
		</imprint>
		<respStmt>
			<orgName>Centers for Disease Control and Prevention (CDC) and others</orgName>
		</respStmt>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">On information-type measure of difference of probability distributions and indirect observations</title>
		<author>
			<persName><forename type="first">Imre</forename><surname>Csiszr</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Studia Sci. Math. Hungar</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="299" to="318" />
			<date type="published" when="1967">1967</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">Mike</forename><surname>Develin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bernd</forename><surname>Sturmfels</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Tropical convexity. Documenta Mathematica</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="1" to="27" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">MUSCLE: multiple sequence alignment with high accuracy and high throughput</title>
		<author>
			<persName><forename type="first">Robert</forename><forename type="middle">C</forename><surname>Edgar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic acids research</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="1792" to="1797" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Data, disease and diplomacy: GISAID&apos;s innovative contribution to global health</title>
		<author>
			<persName><forename type="first">Stefan</forename><surname>Elbe</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gemma</forename><surname>Buckland-Merrett</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Global challenges</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="33" to="46" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">POT: Python Optimal Transport</title>
		<author>
			<persName><forename type="first">Rémi</forename><surname>Flamary</surname></persName>
		</author>
		<author>
			<persName><surname>Courty</surname></persName>
		</author>
		<author>
			<persName><surname>Nicolas</surname></persName>
		</author>
		<author>
			<persName><surname>Gramfort</surname></persName>
		</author>
		<author>
			<persName><surname>Alexandre</surname></persName>
		</author>
		<author>
			<persName><surname>Alaya</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Mokhtar</surname></persName>
		</author>
		<author>
			<persName><surname>Boisbunon</surname></persName>
		</author>
		<author>
			<persName><surname>Aurélie</surname></persName>
		</author>
		<author>
			<persName><surname>Chambon</surname></persName>
		</author>
		<author>
			<persName><surname>Stanislas</surname></persName>
		</author>
		<author>
			<persName><surname>Chapel</surname></persName>
		</author>
		<author>
			<persName><surname>Laetitia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Adrien</forename><surname>Corenflos</surname></persName>
		</author>
		<author>
			<persName><surname>Fatras</surname></persName>
		</author>
		<author>
			<persName><surname>Kilian</surname></persName>
		</author>
		<author>
			<persName><surname>Fournier</surname></persName>
		</author>
		<author>
			<persName><surname>Nemo</surname></persName>
		</author>
		<author>
			<persName><surname>Gautheron</surname></persName>
		</author>
		<author>
			<persName><surname>Léo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Nathalie</forename><forename type="middle">T H</forename><surname>Gayraud</surname></persName>
		</author>
		<author>
			<persName><surname>Janati</surname></persName>
		</author>
		<author>
			<persName><surname>Hicham</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alain</forename><surname>Rakotomamonjy</surname></persName>
		</author>
		<author>
			<persName><surname>Redko</surname></persName>
		</author>
		<author>
			<persName><surname>Ievgen</surname></persName>
		</author>
		<author>
			<persName><surname>Rolet</surname></persName>
		</author>
		<author>
			<persName><surname>Antoine</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Antony</forename><surname>Schutz</surname></persName>
		</author>
		<author>
			<persName><surname>Seguy</surname></persName>
		</author>
		<author>
			<persName><surname>Vivien</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Danica</forename><forename type="middle">J</forename><surname>Sutherland</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Romain</forename><surname>Tavenard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alexander</forename><surname>Tong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Titouan</forename><surname>Vayer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">78</biblScope>
			<biblScope unit="page" from="1" to="8" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Representations of partial leaf sets in phylogenetic tree space</title>
		<author>
			<persName><forename type="first">Gillian</forename><surname>Grindstaff</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Megan</forename><surname>Owen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Applied Algebra and Geometry</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="691" to="720" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Dimension of measures: the probabilistic approach</title>
		<author>
			<persName><forename type="first">Yanick</forename><surname>Heurteaux</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Publicacions Matemtiques</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="243" to="290" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Whole-genome analysis of human influenza A virus reveals multiple persistent lineages and reassortment among recent H3N2 viruses</title>
		<author>
			<persName><forename type="first">Edward</forename><forename type="middle">C</forename><surname>Holmes</surname></persName>
		</author>
		<author>
			<persName><surname>Ghedin</surname></persName>
		</author>
		<author>
			<persName><surname>Elodie</surname></persName>
		</author>
		<author>
			<persName><surname>Miller</surname></persName>
		</author>
		<author>
			<persName><surname>Naomi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jill</forename><surname>Taylor</surname></persName>
		</author>
		<author>
			<persName><surname>Bao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">St</forename><surname>Yiming</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kirsten</forename><surname>George</surname></persName>
		</author>
		<author>
			<persName><surname>Grenfell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Bryan</surname></persName>
		</author>
		<author>
			<persName><surname>Salzberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Steven</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Claire</forename><forename type="middle">M</forename><surname>Fraser</surname></persName>
		</author>
		<author>
			<persName><surname>Lipman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>David</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS biology</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page">300</biblScope>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Dynamic clustering of interval data using a Wassersteinbased distance</title>
		<author>
			<persName><forename type="first">Antonio</forename><surname>Irpino</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rosanna</forename><surname>Verde</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recognition Letters</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="1648" to="1658" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">On the translocation of masses</title>
		<author>
			<persName><forename type="first">Leonid</forename><forename type="middle">V</forename><surname>Kantorovich</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Dokl. Akad. Nauk. USSR (NS)</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<date type="published" when="1942">1942</date>
		</imprint>
	</monogr>
	<note>Pages 199-201 of</note>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<author>
			<persName><forename type="first">Diederik</forename><forename type="middle">P</forename><surname>Kingma</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1412.6980</idno>
		<title level="m">Adam: A method for stochastic optimization</title>
		<imprint>
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Optimization by Simulated Annealing</title>
		<author>
			<persName><forename type="first">S</forename><surname>Kirkpatrick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">D</forename><surname>Gelatt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">P</forename><surname>Vecchi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">220</biblScope>
			<biblScope unit="issue">4598</biblScope>
			<biblScope unit="page" from="671" to="680" />
			<date type="published" when="1983">1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Tropical optimal transport and Wasserstein distances</title>
		<author>
			<persName><forename type="first">Wonjun</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><surname>Li</surname></persName>
		</author>
		<author>
			<persName><surname>Wuchen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bo</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Information Geometry</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="247" to="287" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Convexity in tree spaces</title>
		<author>
			<persName><forename type="first">Bo</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><surname>Sturmfels</surname></persName>
		</author>
		<author>
			<persName><surname>Bernd</surname></persName>
		</author>
		<author>
			<persName><surname>Tang</surname></persName>
		</author>
		<author>
			<persName><surname>Xiaoxian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ruriko</forename><surname>Yoshida</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Discrete Mathematics</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="2015" to="2038" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Tropical Geometric Variation of Tree Shapes</title>
		<author>
			<persName><forename type="first">Bo</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ruriko</forename><surname>Yoshida</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Discrete &amp; Computational Geometry</title>
		<imprint>
			<biblScope unit="volume">68</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="817" to="849" />
			<date type="published" when="2022">2022</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Introduction to Tropical Geometry</title>
		<author>
			<persName><forename type="first">Diane</forename><surname>Maclagan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bernd</forename><surname>Sturmfels</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Graduate Studies in Mathematics</title>
		<imprint>
			<biblScope unit="volume">161</biblScope>
			<date type="published" when="2015">2015</date>
			<publisher>American Mathematical Society</publisher>
			<pubPlace>Providence, RI</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Gromov-Wasserstein distances and the metric approach to object matching</title>
		<author>
			<persName><forename type="first">Facundo</forename><surname>Mémoli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Foundations of computational mathematics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="417" to="487" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Mémoire sur la théorie des déblais et des remblais</title>
		<author>
			<persName><forename type="first">Gaspard</forename><surname>Monge</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mem. Math. Phys. Acad. Royale Sci</title>
		<imprint>
			<biblScope unit="page" from="666" to="704" />
			<date type="published" when="1781">1781</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<author>
			<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
		</author>
		<author>
			<persName><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><surname>Bo</surname></persName>
		</author>
		<author>
			<persName><surname>Yoshida</surname></persName>
		</author>
		<author>
			<persName><surname>Ruriko</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Qiwen</forename><surname>Kang</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1805.12400</idno>
		<title level="m">Tropical geometry of phylogenetic tree space: a statistical perspective</title>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title level="m" type="main">Statistical aspects of Wasserstein distances. Annual review of statistics and its application</title>
		<author>
			<persName><surname>Panaretos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Victor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yoav</forename><surname>Zemel</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2019">2019</date>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="405" to="431" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title level="m" type="main">An invitation to statistics in Wasserstein space</title>
		<author>
			<persName><surname>Panaretos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Victor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yoav</forename><surname>Zemel</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2020">2020</date>
			<publisher>Springer Nature</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">APE: analyses of phylogenetics and evolution in R language</title>
		<author>
			<persName><forename type="first">Emmanuel</forename><surname>Paradis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Claude</forename><surname>Julien</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Korbinian</forename><surname>Strimmer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="289" to="290" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<author>
			<persName><forename type="first">Yingying</forename><surname>Ren</surname></persName>
		</author>
		<author>
			<persName><surname>Zha</surname></persName>
		</author>
		<author>
			<persName><surname>Sihan</surname></persName>
		</author>
		<author>
			<persName><surname>Bi</surname></persName>
		</author>
		<author>
			<persName><surname>Jingwen</surname></persName>
		</author>
		<author>
			<persName><surname>Sanchez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>José</surname></persName>
		</author>
		<author>
			<persName><surname>Monical</surname></persName>
		</author>
		<author>
			<persName><surname>Cara</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Michelle</forename><surname>Delcourt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rosemary</forename><forename type="middle">K</forename><surname>Guzman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ruth</forename><surname>Davidson</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1708.02626</idno>
		<title level="m">A combinatorial method for connecting BHV spaces representing different numbers of taxa</title>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
		<title level="m" type="main">Density estimation. Statistical science</title>
		<author>
			<persName><forename type="first">Simon</forename><forename type="middle">J</forename><surname>Sheather</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004">2004</date>
			<biblScope unit="page" from="588" to="597" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">The Tropical Grassmannian</title>
		<author>
			<persName><forename type="first">David</forename><surname>Speyer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bernd</forename><surname>Sturmfels</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Geom</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="389" to="411" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Roan</forename><surname>Talbut</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Anthea</forename><surname>Monod</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2405.19551</idno>
		<imprint>
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
	<note type="report_type">Tropical Gradient Descent. arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Tropical support vector machine and its applications to phylogenomics</title>
		<author>
			<persName><forename type="first">Xiaoxian</forename><surname>Tang</surname></persName>
		</author>
		<author>
			<persName><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><surname>Houjie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ruriko</forename><surname>Yoshida</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algebraic Statistics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="133" to="165" />
			<date type="published" when="2024">2024</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
		<title level="m" type="main">Topics in Optimal Transportation</title>
		<author>
			<persName><forename type="first">Cédric</forename><surname>Villani</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003">2003</date>
			<publisher>American Mathematical Soc</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
		<author>
			<persName><forename type="first">Cédric</forename><surname>Villani</surname></persName>
		</author>
		<title level="m">Optimal transport: old and new</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2009">2009</date>
			<biblScope unit="volume">338</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Tropical principal component analysis and its application to phylogenetics</title>
		<author>
			<persName><forename type="first">Ruriko</forename><surname>Yoshida</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Leon</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bulletin of mathematical biology</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="568" to="597" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Hit and run sampling from tropically convex sets</title>
		<author>
			<persName><forename type="first">Ruriko</forename><surname>Yoshida</surname></persName>
		</author>
		<author>
			<persName><surname>Miura</surname></persName>
		</author>
		<author>
			<persName><surname>Keiji</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Barnhill</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algebraic Statistics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="37" to="69" />
			<date type="published" when="2023">2023</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<monogr>
		<author>
			<persName><forename type="first">Sakellarios</forename><surname>Zairis</surname></persName>
		</author>
		<author>
			<persName><surname>Khiabanian</surname></persName>
		</author>
		<author>
			<persName><surname>Hossein</surname></persName>
		</author>
		<author>
			<persName><surname>Blumberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Andrew</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Raul</forename><surname>Rabadan</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1607.07503</idno>
		<title level="m">Genomic data analysis in tree spaces</title>
		<imprint>
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b40">
	<monogr>
		<author>
			<persName><forename type="first">Günter</forename><forename type="middle">M</forename><surname>Ziegler</surname></persName>
		</author>
		<title level="m">Lectures on polytopes</title>
		<imprint>
			<publisher>Springer Science &amp; Business Media</publisher>
			<date type="published" when="2012">2012</date>
			<biblScope unit="volume">152</biblScope>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
