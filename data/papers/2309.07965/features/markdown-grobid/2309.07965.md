# A survey on relative Lipschitz saturation of algebras and its relation with radicial algebras

## Abstract

## 

In this work, we introduce the concept of relative Lipschitz saturation, along with its key categorical and algebraic properties, and demonstrate how such a structure always gives rise to a radicial algebra.

## Introduction

The study in equisingularity was started by Zariski in [[9]](#b8), where he was interested in investigating this concept in an algebraic variety along an irreducible (singular) subvariety. First, he dealt with different ways to define equivalent singularities of plane algebroid curves, and after in [[10]](#b9) Zariski worked with algebroid hypersurfaces with a singular point at its origin.

In the meantime, in [[11]](#b10) introduced an operation on a ring A, which he called saturation, which consists of passing from A to some ring Ã lying over A and under the integral closure of A in its total ring of fractions. In that work Zariski showed how useful this operation is for the theory of singularities by means of geometric applications to plane algebroid curves, and more generally, to algebroid hypersurfaces.

Having its applications in his mind, firstly Zariski restricted himself to the case in which A is a local domain of dimension one, and always with the assumption that the base field is algebraically closed and of characteristic zero. Then, in [[12,](#b11)[13,](#b12)[14]](#b13) he presented his general theory of saturation, extending several results and showing how to apply them to a more general setup in the theory of singularities.

The core of saturation theory developed by Zariski is to look for a special intermediate algebra between a ring A and its integral closure A. In [[8]](#b7), in the case of complex analytic algebras, Pham and Teissier observed that the germs of Lipschitz meromorphic functions lie between A and A. Thus, they studied this algebra from a formal and geometric viewpoint, showing that it coincides with the Zariski saturation in the hypersurface case. So, for a reduced complex analytic algebra A with normalization A, Pham and Teissier defined the Lipschitz saturation of A as

$A * := {f ∈ A | f ⊗ C 1 -1 ⊗ C f ∈ I A },$where I A denotes the kernel of the canonical map A ⊗ C A A ⊗ A A. Although Pham and Teissier were thinking with an analytic background, they left a good question about if A * B ⊆ A, in the case where B is an A-algebra and

$A * B := {f ∈ B | f ⊗ C 1 -1 ⊗ C f ∈ I A,B },$where I A,B now denotes the kernel of the canonical map B ⊗ C B B ⊗ A B. So, in [[7]](#b6) Lipman extended this definition for a sequence of ring morphisms R A g B, and defined what he called the relative Lipschitz saturation of A in B, denoted by A * B,R . Besides, Lipman developed several techniques and general properties on this operation in the ring A.

$D R A F T -G S N -2 0 2 2$Recently, Gaffney used this machinery to deal with bi-Lipschitz equisingularity of families of curves in [[3]](#b2), defining a notion of Lipschitz saturation for an ideal of a complex analytic algebra. After that, Gaffney showed this Lipschitz saturation is related to the integral closure of the double of the ideal, a concept that he defined and used to get a type of infinitesimal Lipschitz condition for a family of complex analytic hypersurfaces in [[4]](#b3).

The aim of this work is to introduce the concept of relative Lipschitz saturation and demonstrate that such a construction always results in a radicial algebra. Another objective of this work is to enhance the understanding of the presented results by providing additional details and auxiliary lemmas to support the central arguments of the main proofs.

In the first section, we provide the basic definitions and the most immediate results, along with the presentation of some classic examples.

In the second section, we present the main results regarding the categorical and algebraic properties of Lipschitz saturation. Finally, in the third section, we demonstrate how Lipschitz saturation serves as a source of radicial algebras.

## Basic properties

Let R be a ring and let A, B be R-modules and consider a sequence of ring morphisms

$R τ -A g -B.$Consider the map from B to its tensor product by R, in a diagonal way:

$∆ : B -B ⊗ R B b -b ⊗ R 1 -1 ⊗ R b.$It is easy to conclude the following properties of ∆:

$1. ∆(b 1 + b 2 ) = ∆(b 1 + b 2 ), ∀b 1 , b 2 ∈ B; 2. ∆(rb) = r∆(b), ∀r ∈ R and b ∈ B; 3. (Leibniz rule) ∆(b 1 b 2 ) = (b 1 ⊗ R 1)∆(b 2 ) + (1 ⊗ R b 2 )∆(b 1 ), ∀b 1 , b 2 ∈ B.$By the universal property of the tensor product, there exists a unique R-algebras morphism

$ϕ : B ⊗ R B -B ⊗ A B which maps x ⊗ R y$x ⊗ A y, for all x, y ∈ B. Furthermore, we already know (see [[1]](#b0), 8.7) that

$ker ϕ = ax ⊗ R y -x ⊗ R ay | a ∈ A and x, y ∈ B . Notice that ax ⊗ R y -x ⊗ R ay = (x ⊗ R y)(g(a) ⊗ R 1 -1 ⊗ R g(a)). Therefore, ker ϕ = g(a) ⊗ R 1 -1 ⊗ R g(a) | a ∈ A = ∆(g(A))(B ⊗ R B), i.e, ker ϕ is the ideal of B ⊗ R B generated by the image of ∆ • g. Definition 1.1. The Lipschitz saturation of A in B relative to R τ A g B is the set A * B,R := A * := x ∈ B | ∆(x) ∈ ker ϕ . D R A F T -G S N -2 0 2 2$If A * = g(A) then A is said to be saturated in B. One important particular case is when A is an R-subalgebra of B, taking g as the inclusion. Let us see the first properties of the Lipschitz saturation.

## Proposition 1.2 ([7]

). A * is an R-subalgebra of B which contains g(A).

Proof. Clearly g(A) ⊆ A * ⊆ B. Let x, y ∈ A * and r ∈ R. So, ∆(x), ∆(y) ∈ ker ϕ. Then: ∆(x + y) = ∆(x) + ∆(y) ∈ ker ϕ.

Thus, x + y ∈ A * . For the product, notice that

$∆(xy) = (x ⊗ R 1)∆(y) + (1 ⊗ R y)∆(x) ∈ ker ϕ. Hence xy ∈ A * . Finally, ∆(rx) = r∆(x) = g(τ (r))∆(x) ∈ ker ϕ,$and therefore, rx ∈ A * .

## Proposition 1.3 ([7]

). Let A be an R-subalgebra of B and let C be an R-subalgebra of B containing A as an R-subalgebra.

$R A C B τ g If C * = C * B,R then A * ⊆ C * . Proof. Consider the diagram B ⊗ R B B ⊗ A B B ⊗ C B ϕ ϕ C λ$where ϕ C e λ are the canonical morphisms. It is easy to see this diagram commutes, so ker ϕ ⊆ ker ϕ C , which implies ker ϕ ⊆ ker ϕ C . Therefore, A * ⊆ C * .

Corollary 1.4. If A is an R-subalgebra of B then:

$1. A ⊆ A * . 2. (A * ) * = A * .$Proof. [(1)](#b0) In this case g is the inclusion map, so A = g(A) ⊆ A * .

(2) Using (1), changing A by A * (which is contained in B), we conclude that A * ⊆ (A * ) * . For the converse, consider the canonical morphism

$ϕ * : B ⊗ R B B ⊗ A * B.$Notice that {∆(x) | x ∈ A * }, and consequently

${∆(x); x ∈ A * } ⊆ ker ϕ =⇒ ker ϕ * ⊆ ker ϕ.$Thus, ker ϕ * ⊆ ker ϕ = ker ϕ which implies ∆ -1 ker ϕ * ⊆ ∆ -1 ker ϕ . Hence,

$(A * ) * ⊆ A * . D R A F T -G S N -2 0 2 2$Here is the motivating example of relative saturation in the case of analytic complex varieties.

Example 1.5. Following the approach of Pham-Teissier in [[8]](#b7), let A be the local ring of an irreducible complex analytic space X ⊆ C n at the origin, and let A its normalization. Working with the canonical morphism ϕ : A ⊗ C A A ⊗ A A (and with the analytic tensor product), Pham and Teissier defined the Lipschitz saturation of A as the set A * of the elements h ∈ A such that h ⊗ 1 -1 ⊗ h ∈ A ⊗ C A is in the integral closure of ker ϕ. In our notation:

$A * = ∆ -1 (ker ϕ),$where ∆ : A A ⊗ C A is the diagonal map. Now we present a connection between this notion and that of Lipschitz functions. If we choose generators z 1 , . . . , z n of the maximal ideal of the local ring then {∆(z i )} n i=1 is a set of generators of ker ϕ. One can choose z 1 , . . . , z n so that they are restrictions of coordinates on the ambient space C n . Using the supremum criterion obtained by Jalabert and Teissier in [[6]](#b5), for all h ∈ A one has:

$h ∈ A * ⇐⇒ ∆(h) ∈ ker ϕ$which is equivalent to the existence of some neighborhood U of (0, 0) on X × X and a constant

$C > 0 such that |∆(h)(z, z ′ )| ≤ C sup{|∆(z i )(z, z ′ )|} n i=1 , ∀(z, z ′ ) ∈ U. This last inequality is equivalent to |h(z) -h(z ′ )| ≤ C|z -z ′ | sup , ∀(z, z ′ ) ∈ U,$which is what is meant by the meromorphic function h being Lipschitz at the origin in X.

## Next, we see an algebraic version of the previous example.

Example 1.6. Let k be an algebraically closed field, denote A n as the n-dimensional affine space over k, and let V ⊆ A n be an irreducible affine algebraic set. We recall some important notations:

$• k[V ]$the coordinate ring of V (which is a domain, once V is irreducible);

$• k(V ) field of fractions of k[V ]; • k[V ] integral closure of k[V ] in k(V );$• For each i ∈ {1, . . . , n} we denote x i : V ⊆ A n k as the projection onto the i th -factor.

In this example we consider

$∆ : k[V ] k[V ] ⊗ k k[V ] f - f ⊗ k 1 -1 ⊗ k f$and the canonical map

$ϕ : k[V ] ⊗ k k[V ] - k[V ] ⊗ k[V ] k[V ].$In this way, clearly k

$[V ] = k[x 1 , . . . , x n ]$. For all i 1 , . . . , i n ∈ Z ≥0 , using the Leibniz rule to get the equations

$∆(x i 1 1 ) = (x i 1 -1 1 ⊗ k 1)∆(x 1 ) + (1 ⊗ k x 1 )∆(x i 1 -1 1 ) D R A F T -G S N -2 0 2 2 ∆(x i 1 1 • • • x in n ) = ((x i 1 1 • • • x i n-1 n-1 ) ⊗ k 1)∆(x in n ) + (1 ⊗ k x in n )∆(x i 1 1 • • • x i n-1 n-1 ) as inductive steps, one can see that ∆(x i 1 1 • • • x in n ) ∈ ∆(x i ) | ∀i ∈ {1, . . . , n} , for every i 1 , . . . , i n ∈ Z ≥0 . Since every g ∈ k[V ] is a polinomial at x 1 , . . . , x n , one has ker ϕ = ∆(x i ) | i ∈ {1, . . . , n} . It is known that k[V ] ⊗ k k[V ] ∼ = k[V × V ] in a such way that for every f, g ∈ k[V ], the tensor product f ⊗ k g can be identified as the map f ⊗ k g : V × V - k (x, y) - f (x)g(y) .$Thus, for each i ∈ {1, . . . , n} we have

$(x i ⊗ k 1 -1 ⊗ k x i )(x 1 , . . . , x n , y 1 , . . . , y n ) = x i -y i .$Besides, we can conclude the Lipschitz saturation of k

$[V ] on k[V ] is k[V ] * = {f ∈ k[V ] | f ⊗ k 1 -1 ⊗ k f ∈ x i ⊗ k 1 -1 ⊗ k x i n i=1 }.$2 Some categorical results on the Lipschitz saturation Lemma 2.1. Suppose that

$A B A ′ B ′ α α ′ ψ φ is a commutative diagram of ring morphisms. Then φ(ker α) ⊆ ker α ′ .$If φ is surjective and ψ is injective then the equality holds.

Proof. Since ψ • α = α ′ • φ then φ(ker α) ⊆ ker α ′ . Let v ∈ φ(ker α). So there exists u ∈ ker α such that v = φ(u). Further, there are a 1 , . . . , a r ∈ A such that

$a r + a r-1 u + • • • + a 1 u r-1 + u r = 0, (⋆)$where

$a i ∈ (ker α) i , ∀i ∈ {1, . . . , r}. Thus, b i := φ(a i ) ∈ (ker α ′ ) i and applying φ on (⋆) we obtain b r + b r-1 v + • • • + b 1 v r-1 + v r = 0.$Therefore, v ∈ ker α ′ . In the case where φ is surjective we have α ′ (A ′ ) ⊆ ψ(B), and if ψ is injective then

$A B A ′ ψ(B) α α′ ψ φ$is a commutative diagram, where ψ is an isomorphism. Analogously, φ -1 (ker α′ ) ⊆ ker α and therefore ker α ′ ⊆ φ(ker α).

$D R A F T -G S N -2 0 2 2 Proposition 2.2 ([7]). Suppose that R A B R ′ A ′ B ′ τ g τ ′ g ′ f R f f A is a commutative diagram of ring morphisms. Then f A * B,R ⊆ (A ′ ) * B ′ ,R ′ . Proof. Consider the canonical morphism ϕ ′ : B ′ ⊗ R ′ B ′ B ′ ⊗ A ′ B ′ and ∆ ′ : B ′ -B ′ ⊗ R ′ B ′ x ′ -x ′ ⊗ R ′ 1 -1 ⊗ R ′ x ′ .$The universal property of the tensor product guarantees the existence of morphisms φ and ψ which maps

$b 1 ⊗ R b 2 f (b 1 ) ⊗ R ′ f (b 2 ) b 1 ⊗ A b 2 f (b 1 ) ⊗ A ′ f (b 2 ) φ ψ$and consequently, the diagram

$B B ⊗ R B B ⊗ A B B ′ B ′ ⊗ R ′ B ′ B ′ ⊗ A ′ B ′ ∆ ϕ ∆ ′ ϕ ′ f φ ψ commutes. Since A * B,R = ∆ -1 (ker ϕ) then ∆(A * B,R ) ⊆ ker ϕ =⇒ φ(∆(A * B,R$)) ⊆ φ(ker ϕ). Now, Lemma 2.1 and the commutativeness of the above diagram imply that ∆ ′ (f (A * B,R )) ⊆ ker α ′ , and therefore

$f (A * B,R ) ⊆ ∆ ′-1 (ker α ′ ) = (A ′ ) * B ′ ,R ′ .$Here we point out that Proposition 1.3 proved by Lipman is true even in the case where the sequence of rings A C B is not necessarily a chain of subalgebras.

$Proposition 2.3. If R A C B τ λ g C$g is a sequence of ring morphisms then

$A * B,R ⊆ C * B,R . Proof.$Indeed, the given sequence of ring morphisms induces the commutative diagram

$R A B R C B τ g id B id R τ C λ g C . Now it suffices to apply Proposition 2.2 to get A * B,R ⊆ C * B,R . D R A F T -G S N -2 0 2 2$Let us fix some notation before the next result. Let I be a directed set. We denote a direct system over I as (A • , ν), which means that we have a collection {A i } i∈I of rings and for every i ≤ j ∈ I we have a ring morphism ν ij : A i A j satisfying the known conditions for a direct system.

It is well known that the category of rings is complete and cocomplete. In particular, (A • , ν) admits a direct limit lim -

$I A • = (A, α), i.$e, there exists a collection of ring morphisms {α i : A i A} satisfying the known conditions for a direct limit. This collection we denote as α

$• : A • A.$In the case of rings we can construct explicitly lim -

$I A • as the quotient i∈I A i S ν$, where S ν is the Z-submodule of i∈I A i generated by sequences on the form (x i ) i∈I where ν ij (x i ) = x j , for all i ≤ j ∈ I. This limit can be endowed with a ring structure induced by A i , i ∈ I, such that the canonical maps α i : A i A (i ∈ I) (which are formed by composing inclusion with the quotient map) satisfies the universal property for the direct limit.

$Proposition 2.4 ([7]). Let (R • , µ) τ• (A • , ν) g• (B • , θ) be$a sequence of morphisms of direct systems of rings over a directed set I. Suppose that ρ • : R • R, α • : A • A and β • : B • B are direct limits of R • , A • and B • , respectively. It is well known that there exist ring morphisms τ : R A and g : A B such that

$R i A i B i R A B τ i g i τ g ρ i α i β i is a commutative diagram, ∀i ∈ I.$1. For all i ≤ j ∈ I the map

$θ * ij : (A i ) * B i ,R i - (A j ) * B j ,R j z - θ ij (z)$is a well-defined morphism of rings.

## ((A

$• ) * B•,R• , θ *$) is a direct system of rings over I.

## lim -

$I (A • ) * B•,R• ∼ = A * B,R .$Proof.

(1) Since τ • and g • are morphisms of direct systems, for i ≤ j ∈ I we have the following commutative diagram:

$R i A i B i R j A j B j τ i g i τ j g j µ ij ν ij θ ij Now, Proposition 2.2 implies θ ij ((A i ) * B i ,R i ) ⊆ (A j ) * B j ,R j .$Hence, θ * ij is well-defined, and clearly it is a ring morphism.

(

$) (i) For each i ∈ I, since (B • , θ) is a direct system then θ ii = id B i . Hence, θ * ii = id (A i ) * B i ,R i . (ii) Let i ≤ j ≤ k ∈ I. Since θ ik = θ jk • θ ij then θ * ik = θ * jk • θ * ij . D R A F T -G S N -2 0 2 22$(3) Using the previous notation it is straightforward to check that the map ψ : lim -

$I (A i ) * B i ,R i - A * B,R (x i ) i∈I + S θ * - (β i (x i )) i∈I + S θ$is an isomorphism.

## Proposition 2.5 ([7]

). Let g i : A i B i be R-algebra morphisms and let g : A B be the direct product of those maps. That is,

$A = n i=1 A i g= g i - n i=1 B i = B. Então, A * B,R = n i=1 (A i ) * B i ,R .$Proof. For each i ∈ {1, . . . , n} consider the canonical morphism ϕ i :

$B i ⊗ R B i B i ⊗ A i B i and the diagonal ∆ i : B i B i ⊗ R B i .$Let φ be the composition of the morphisms n i,j=1

$(B i ⊗ R B j ) n i=1 (B i ⊗ R B i ) n i=1 (B i ⊗ A i B i ) p=projection ϕ i Thus, ker φ = ker( ϕ i )× n i =j=1 (B i ⊗ R B j ) .$Once the kernel and integral closure for ideals commute with a finite direct product, one has

$ker φ = n i=1 ker ϕ i × n i =j=1 (B i ⊗ R B j ) = p -1 n i=1 ker ϕ i .$On the other hand, we have a commutative diagram n i,j=1

$(B i ⊗ R B j ) n i=1 (B i ⊗ A i B i ) B ⊗ R B B ⊗ A B φ ϕ φ ψ$where φ is an isomorphism, ψ is a canonical injective morphism and p • φ -1 • ∆ = ∆ i . Hence, φ(ker φ) = ker ϕ. Therefore:

$A * B,R = ∆ -1 (ker ϕ) = ∆ -1 (φ(ker φ)) = ∆ -1 φ p -1 n i=1 ker ϕ i = (p • φ -1 • ∆) -1 n i=1 ker ϕ i = ∆ i n i=1 ker ϕ i = n i=1 ∆ -1 i (ker ϕ i ) = n i=1 (A i ) * B i ,R . D R A F T -G S N -2 0 2 2$In the next proposition, we prove the base change for a flat algebra partially preserves Lipschitz saturation. Proposition 2.6. Let R τ A g B be a sequence of ring morphisms, let R ′ be a flat R-algebra and consider the induced sequence

$R ′ ∼ = R ⊗ R R ′ A ⊗ R R ′ B ⊗ R R ′ τ ′ g ′ =g⊗ R id R ′ Then: A * B,R ⊗ R R ′ ⊆ (A ⊗ R R ′ ) * B⊗ R R ′ ,R ′ . Proof. Denote A ′ := A ⊗ R R ′ , B ′ := B ⊗ R R ′ ,$and consider the canonical maps

$B ′ B ′ ⊗ R ′ B ′ B ′ ⊗ A ′ B ′ ∆ ′ ϕ ′$We have

$B ′ ⊗ R ′ B ′ = (B ⊗ R R ′ ) ⊗ R ′ (B ⊗ R R ′ ) ∼ = B ⊗ R (R ′ ⊗ R ′ B) ⊗ R R ′ ∼ = (B ⊗ R B) ⊗ R R ′ ∼ = B ⊗ R B ′ , and (B ⊗ A B) ⊗ R R ′ ∼ = B ⊗ A (B ⊗ R R ′ ) = B ⊗ A B ′ which maps canonically to B ′ ⊗ A B ′$, and then to B ′ ⊗ A ′ B ′ . Thus, there exists a commutative diagram

$B ′ B ⊗ R B ′ (B ⊗ R B) ⊗ R R ′ (B ⊗ A B) ⊗ R R ′ B ′ ⊗ R ′ B ′ B ′ ⊗ A ′ B ′ ϕ ′ γ ϕ⊗ R id R ′ ∆⊗ R id R ′ φ ψ φ -1 •∆ ′$where γ and φ are ring isomorphisms. Let x ∈ A * B,R and y ∈ R ′ . So, ∆(x) ∈ ker ϕ and consequently

$γ • φ -1 • ∆ ′ (x ⊗ R y) = (∆ ⊗ R id R ′ )(x ⊗ R y)) = ∆(x) ⊗ R y ∈ ker ϕ ⊗ R R ′ . Since ker ϕ is an ideal of B ⊗ R B then ker ϕ ⊗ R R ′ ⊆ ker ϕ ⊗ R R ′ , which is contained in ker(ϕ ⊗ R id R ′ ). In particular, ∆ ′ (x ⊗ R y) ∈ φ(γ -1 (ker(ϕ ⊗ R id R ′ ))). Once γ is an isomorphism, we have γ -1 (ker(ϕ ⊗ R id R ′ )) = γ -1 (ker(ϕ ⊗ R id R ′ )) ⊆ ker((ϕ ⊗ R id R ′ ) • γ) ⊆ ker(ψ • (ϕ ⊗ R id R ′ ) • γ) = ker(ϕ ′ • φ). Hence, ∆ ′ (x ⊗ R y) ∈ φ(ker(ϕ ′ • φ)). Since φ is an isomorphism then φ(ker(ϕ ′ • φ)) = φ(ker(ϕ ′ • φ)) = ker ϕ ′ . Therefore, ∆ ′ (x ⊗ R y) ∈ ker ϕ ′ =⇒ x ⊗ R y ∈ (A ′ ) * B ′ ,R ′ , which finishes the proof.$The next corollary is in [[7]](#b6), and here we get it as a straightforward consequence of our previous proposition.

$D R A F T -G S N -2 0 2 2$Corollary 2.7 (Faithfully flat descent). Under the notation of 2.6, assume that R ′ is a faithfully flat R-algebra.

$If A ⊗ R R ′ is R ′ -saturated in B ⊗ R R ′ then A is R-saturated on B.$Proof. Indeed, by hypothesis

$(A ′ ) * B ′ ,R ′ = g ′ (A ′ ) = (g ⊗ R id R ′ )(A ⊗ R R ′ ) = g(A) ⊗ R R ′ . Propo- sition 2.6 implies that A * B,R ⊗ R R ′ ⊆ g(A) ⊗ R R ′ , and so A * B,R ⊗ R R ′ = g(A) ⊗ R R ′ . Since R ′ is R-flat then 0 = A * B,R ⊗ R R ′ g(A) ⊗ R R ′ = A * B,R g(A) ⊗ R R ′ and the faithfulness of R ′ implies that A * B,R g(A) = 0, i.e, A * B,R = g(A).$
## Relative Lipschitz saturation and radicial algebras

Let us recall some important definitions before continuing.

Definition 3.1. Let h : S T be a ring morphism. We say that T is a radicial S-algebra if:

1. The induced map on spectra Spec(h) : Spec T Spec S is injective;

2. For every q ∈ SpecS the embedding

$h q : Frac S h -1 (q) ֒ Frac T q induced by h is purely inseparable. 1$In this case, we also say that h is a radicial ring morphism.

Recall that if K is a field and T is a ring we can identify Mor Schemes (SpecK, SpecT ) as the set {(q, β) | q ∈ Spec T and β : Frac T q K is a ring morphism}.

We recall some properties of radicial algebras.

Theorem 3.2. The following conditions are equivalent:

(a) h : S T is a radicial ring morphism;

(b) Any two distinct morphisms of T into a field have distinct composition with h;

(c) The kernel of the canonical morphism γ :

$T ⊗ S T T is a nil ideal of T ⊗ S T ; (d) t ⊗ S 1 -1 ⊗ S t is nilpotent in T ⊗ S T , ∀t ∈ T .$Proof. Let ĥ : Spec T Spec S be the morphism of schemes induced by h and let K be a field. Then we have a canonical commutative diagram of maps Mor Rings (T, K)

Mor Rings (S, K)

Mor Schemes (SpecK, SpecT ) Mor Schemes (SpecK, SpecS)

$h * Ψ λ T λ S$where 1 Frac stands for the field of fractions.

$D R A F T -G S N -2 0 2 2$• λ T and λ S are canonical bijections;

$• h * (δ) = δ • h, ∀δ ∈ Mor Rings (T, K);$• Ψ(α) = ĥ • α, ∀α ∈ Mor Schemes (SpecK, SpecT );

• Ψ(q, β) = (h -1 (q), β • h q ), ∀(q, β) ∈ Mor Schemes (SpecK, SpecT ). Now, it is clear that h is radicial if and only if Ψ is injective, and since the above diagram commutes and λ T and λ S are bijections, then Ψ is injective if and only if h * is injective.

Hence, the equivalence (a) ⇐⇒ (b) is proved. The equivalence (c) ⇐⇒ (d) holds because the kernel of the canonical map T ⊗ S T T is generated by the elements of the form t

$⊗ S 1 -1 ⊗ S t is nilpotent in T ⊗ S T , ∀t ∈ T . (b) ⇐⇒ (c)$In this case it is useful to work with the diagonal map

$∆ X/S : X X × Spec S X,$where X := Spec T , which corresponds to the ring morphism γ : T ⊗ S T T . Thus, (b) is equivalent to ∆ X/S to be surjective (see [[5]](#b4), Prop. 3.7.1).

## Definition 3.3 (Unramified algebra).

Let T be a S-algebra and γ : T ⊗ S T T be the canonical morphism which takes u ⊗ S v uv, ∀u, v ∈ T . We say that T is an unramified S-algebra if the following conditions hold:

1. ker γ is a finitely generated ideal of T ⊗ S T ; 2. (ker γ) 2 = ker γ.

Using the determinant trick it is easy to see that condition [(2)](#b1) implies that there exists e ∈ ker γ such that ker γ is the principal ideal generated by e, and e 2 = e. Lemma 3.4. Let h : S T be a surjective ring morphism, x ∈ S, and let I be an ideal of S.

If h(x) ∈ h(I) then x is integral over I mod ker h, i.e, x + ker h ∈ I ker h .

Proof. By hypothesis there exist b i = h(a i ), a i ∈ I i , ∀i ∈ {1, . . . , n}, such that

$h(x n + a 1 x n-1 + • • • + a n-1 x + a n ) = 0.$If we denote ū := u + ker h, ∀u ∈ S, the last equation implies that

$xn + a 1 xn-1 + • • • + a n-1 x + a n = 0,$with a i ∈ I ker h i , ∀i ∈ {1, . . . , n}, which finishes the proof.

Before we continue, let us prove a useful lemma to proceed with this section. Lemma 3.5. Let R be an ideal and I, J 1 , . . . , J n ideals of R where the product

$J 1 • • • J n is a nil ideal of R. If x ∈ R is integral over I mod J i , ∀i ∈ {1, . . . , n} then x ∈ I.$Proof. For each i ∈ {1, . . . , n} there exists a monic polynomial p i ∈ R[X], with suitable coefficients related to the integral dependence over I mod J i , such that p i (x) ∈ J i . Setting p := p 1 • • • p n , one has p(x) ∈ J 1 • • • J n ⊆ (0) which ensures the existence of an r ∈ N such that (p(x)) r = 0. Therefore, x ∈ I.

$D R A F T -G S N -2 0 2 2$In the following result, Lipman demonstrated that a radicial base change does not alter the relative Lipschitz saturation.

## Proposition 3.6 ([7]). Consider the diagram of ring morphisms

$R R ′ A B g τ ′ λ τ :=τ ′ •λ Then: a) A * B,R ⊆ A * B,R ′ ; b) If R ′ is a radicial or unramified R-algebra then A * B,R = A * B,R ′ .$Proof. (a) By hypothesis the diagram

$R A B R ′ A B λ id A id B τ g τ ′ g is commutative. Now Proposition 2.2 implies that A * B,R = id B (A * B,R ) ⊆ A * B,R ′ . (b) Let γ : R ′ ⊗ R R ′$R ′ be the canonical morphism. Let us prove that in either case there exists e ′ ∈ ker γ such that e ′2 = e ′ and ker γ ⊆ (e ′ ).

(i) Assuming that R ′ is a radicial R-algebra, the previous theorem says that ker γ is a nil ideal of R ′ ⊗ R R ′ . In this case, take e ′ := 0.

(ii) Suppose that R ′ is an unramified R-algebra. As we observed, there exists e ′ ∈ ker γ such that e ′2 = e ′ and ker γ = (e ′ ). In particular, ker γ ⊆ (e ′ ), and our claim is proved. Now, before to prove another inclusion, let us prepare the way. Consider the commutative diagram

$R ′ ⊗ R R ′ A ⊗ R A B ⊗ R B B ⊗ A B B B ⊗ R ′ B τ ′ ⊗ R τ ′ g⊗ R g ϕ ∆ ′ ϕ ′ ψ ∆$where ψ is the canonical morphism, and set σ :

$= (g ⊗ R g) • (τ ′ ⊗ R τ ′ ). We already know that ker ψ is the ideal of B ⊗ R B by the image of ∆ • g • τ ′ . It is straightforward to conclude that ∆(g(τ ′ (b))) = σ(b ⊗ R 1 R ′ -1 R ′ ⊗ R b), ∀b ∈ R ′ ,$and since ker γ is generated by which implies that ∆(x) is integral over ker ϕ mod J. Since (ker ϕ)J is a nil ideal, Lemma 3.5 ensures that ∆(x) ∈ ker ϕ, and therefore x ∈ A * B,R . Before presenting the proof of the main theorem of this work, let us establish some auxiliary results first. Lemma 3.7. Let h : S T be a ring morphism, x ∈ S, and suppose that ker h is a nil ideal of S. If h(x) ∈ (0 T ) then x ∈ (0 S ).

${b ⊗ R 1 R ′ -1 R ′ ⊗ R b | b ∈ R ′ }$Proof. By hypothesis there exists r ∈ N such that (h(x)) r = 0 T , i.e, h(x r ) = 0 T . So, x r ∈ ker h ⊆ (0 S ), which implies that x ∈ (0 S ) = √ 0 S .

In the next lemma, we observe that we do not need to require the kernel of h to be a nil ideal in order to guarantee that ker(h ⊗ R h) is a nil ideal, as in [[7]](#b6). q := ker β ∈ Spec(T ⊗ R T ). Clearly α = β • (h ⊗ R h), and since p = ker α then we conclude that (h ⊗ R h) -1 (q) = p. (b) The persistence of the integral closure of ideals implies h(I) ⊆ IT . Conversely, assume that x ∈ h -1 (IT ). Thus, y := h(x) is integral over IT , and then yX is integral over T [(IT )X], which is integral over h(S)[h(I)X], once h is an integral morphism. Thus, for each there exist a i ∈ I i , i ∈ {1, . . . , n} such that h(a n ) + • • • + h(a 1 )y n-1 + y n = 0.

Hence, a n + • • • + a 1 x n-1 + x n ∈ ker h ⊆ (0), which implies the existence of r ∈ N such that (a n + • • • + a 1 x n-1 + x n ) r = 0. Therefore, x ∈ I.

Finally, we present the main theorem of this work, where Lipman showed that relative Lipschitz saturation always gives rise to a radical algebra. 

![then ker ψ is the ideal of B ⊗ R B generated by σ(ker γ). In particular, e := σ(e ′ ) ∈ ker ψ and e 2 = e. Further, since ker γ ⊆ (e ′ ) then ker ψ ⊆ (e). Setting J as the ideal of B ⊗ R B generated by 1-e. Thus, once e(1-e) = 0, it follows that (ker ψ)J ⊆ (e)(1e) = (0), and consequently, (ker ψ)J is a nil ideal of B ⊗ R B. Since ψ is surjective and ϕ = ϕ ′ • ψ then ψ(ker ϕ) = ker ϕ ′ . Finally, let us check the inclusionA * B,R ′ ⊆ A * B,R . Taking any x ∈ A * B,R ′ , one has ψ(∆(x)) = ∆ ′ (x) ∈ ker ϕ ′ = ψ(ker ϕ),Lemma 3.4 implies that ∆(x) is integral over ker ϕ mod ker ψ. Besides, since e ∈ ker ψ then c := ∆(x)e ∈ ker ψ, and clearly ker ψ ⊆ ker ϕ, hence c ∈ ker ϕ. Notice that ∆(x)c = ∆(x)(1e) ∈ J,]()

![Let h : S T be an integral morphism of R-algebras.a) ker(h ⊗ R h) is a nil ideal of S ⊗ R S;b) Suppose that ker h is a nil ideal of S. Then I = h -1 (IT ), for every I ideal of S.Proof. (a) We want to show that ker(h⊗ R h) ⊆ p∈Spec(S⊗ R S)p, so it suffices to show that theinduced map (h ⊗ R h) ♯ : Spec(T ⊗ R T ) Spec(S ⊗ R S) is surjective. Let p ∈ Spec(S ⊗ R S).The domain S ⊗ R S p can be embedded into an algebraically closed field F such that the kernel of the composition S ⊗ R S projection -S ⊗ R S p ֒ F is p. Let α be this composition and let γ 1 , γ 2 : S S ⊗ R S be the canonical maps which takes s ⊗ R 1 γ 1 s γ 2 1 ⊗ R s, for all s ∈ S. Since h is an integral morphism then there exist ring morphisms δ 1 , δ 2 : T F for which the diagram The universal property of the tensor product ensures the existence of a unique ring morphism β : T ⊗ R T F such that β(u ⊗ R v) = δ 1 (u)δ 2 (v), ∀u, v ∈ T . Defines]()

![[7]). Consider the sequence of ring morphisms R A g B, and suppose that g is an integral morphism. Then A * B,R is a radicial A-algebra. Proof. By Theorem 3.2 we have to check if the kernel of the canonical morphismγ : A * B,R ⊗ A A * ideal of A * B,R ⊗ A A * B,R . Once ker γ is the ideal generated by {x⊗ A 1 B -1 B ⊗ A x | x ∈ A * B,R }, it suffices to show that δ(x) := x ⊗ A 1 B -1 B ⊗ A x ∈ (0 A * B,R ⊗ A A * B,R ), ∀x ∈ A * B,R .Before to take care of it, observe that since g is an integral morphism then B is integral over g(A), and we already know that g(A) ⊆ A * B,R , hence B is integral over A * B,R . Consequently, the inclusion ι : A * B,R ֒ B is an integral morphism of A-algebras. By Lemma 3.82 we can conclude that the kernel of the map ι ⊗ A ι :A * B,R ⊗ A A * B,R B ⊗ A B is a nil ideal of A * B,R ⊗ A A * B,R . Finally, let us check what remains. If x ∈ A *B,R then ∆(x) ∈ ker ϕ, and there exist a i ∈ (ker ϕ) i , i ∈ {1, . . . , n} such that(∆(x)) n + a 1 (∆(x)) n-1 + • • • + a n-1 ∆(x) + a n = 0 B⊗ A B .Applying ϕ in the last equation we obtain (ϕ(∆(x))) n = 0 B⊗ A B . It is easy to see that (ι ⊗ A ι)(δ(x)) = ϕ(∆(x)), hence (ι ⊗ A ι)(δ(x)) ∈ (0 B⊗ A B ). Since ker(ι ⊗ A ι)is a nil ideal then by Lemma 3.7 we conclude that δ(x) ∈ (0 A * B,R ⊗ A A * B,R ), which ends the proof.]()

Notice that to apply this lemma as we have done, we do not have to be concerned whether ker ι is a nil ideal or not.

