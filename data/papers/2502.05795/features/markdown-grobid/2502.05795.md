# The Curse of Depth in Large Language Models

## Abstract

## 

In this paper, we introduce the Curse of Depth, a concept that highlights, explains, and addresses the recent observation in modern Large Language Models (LLMs) where nearly half of the layers are less effective than expected. We first confirm the wide existence of this phenomenon across the most popular families of LLMs such as Llama, Mistral, DeepSeek, and Qwen. Our analysis, theoretically and empirically, identifies that the underlying reason for the ineffectiveness of deep layers in LLMs is the widespread usage of Pre-Layer Normalization (Pre-LN). While Pre-LN stabilizes the training of Transformer LLMs, its output variance exponentially grows with the model depth, which undesirably causes the derivative of the deep Transformer blocks to be an identity matrix, and therefore barely contributes to the training. To resolve this training pitfall, we propose Layer-Norm Scaling, which scales the variance of output of the layer normalization inversely by the square root of its depth. This simple modification mitigates the output variance explosion of deeper Transformer layers, improving their contribution. Our experimental results, spanning model sizes from 130M to 1B, demonstrate that LayerNorm Scaling significantly enhances LLM pre-training performance compared to Pre-LN. Moreover, this improvement seamlessly carries over to supervised fine-tuning. All these gains can be attributed to the fact that LayerNorm Scaling enables deeper layers to contribute more effectively during training. Our code is available at LayerNorm-Scaling.

## Introduction

Recent studies reveal that the deeper layers (Transformer blocks) in modern LLMs tend to be less effective than the On the other hand, having many layers ineffective is undesirable as modern LLMs are extremely resource-intensive to train, often requiring thousands of GPUs trained for multiple months, let alone the labor used for data curation and administration [(Achiam et al., 2023;](#b0)[Touvron et al., 2023)](#b35). Ideally, we want all layers in a model to be well-trained, with sufficient diversity in features from layer to layer, to maximize the utility of resources [(Li et al., 2024b)](#). The existence of ill-trained layers suggests that there must be something off with current LLM paradigms. Addressing such limitations is a pressing need for the community to avoid the waste of valuable resources, as new versions of LLMs are usually trained with their previous computing paradigm which results in ineffective layers.

To seek the immediate attention of the community, we introduce the concept of the Curse of Depth (CoD) to systematically present the phenomenon of ineffective deep layers in various LLM families, to identify the underlying reason behind it, and to rectify it by proposing LayerNorm Scaling. We first state the Curse of Depth below.

The Curse of Depth. The Curse of Depth refers to the observed phenomenon where deeper layers in modern large language models (LLMs) contribute significantly less to learning and representation compared to earlier layers. These deeper layers often exhibit remarkable robustness to pruning and perturbations, implying they fail to perform meaningful transformations. This behavior prevents these layers from effectively contributing to training and representation learning, resulting in resource inefficiency.

Empirical Evidence of CoD. The ineffectiveness of deep layers in LLMs has been previously reported. [Yin et al. (2024)](#b43) found that deeper layers of LLMs can tolerate significantly higher levels of pruning compared to shallower layers, achieving high sparsity. Similarly, Gromov et al. (2024) and [Men et al. (2024)](#b25) demonstrated that removing early layers causes a dramatic decline in model performance, whereas removing deep layers does not. [Lad et al. (2024)](#b18) showed that the middle and deep layers of GPT-2 and Pythia exhibit remarkable robustness to perturbations such as layer swapping and layer dropping. Recently, [Li et al. (2024a)](#) highlighted that early layers contain more outliers and are therefore more critical for fine-tuning. While these studies effectively highlight the limitations of deep layers in LLMs, they stop short of identifying the root cause of this issue or proposing viable solutions to address it.

To demonstrate that the Curse of Depths is prevalent across popular families of LLMs, we conduct layer pruning experiments on various models, including LLaMA2-7/13B, Mistral-7B, DeepSeek-7B, and Qwen-7B. We measure performance degradation on the Massive Multitask Language Understanding (MMLU) benchmark [(Hendrycks et al., 2021)](#b14) by pruning entire layers of each model, one at a time, and directly evaluating the resulting pruned models on MMLU without any fine-tuning in Figure [2](#fig_1).

Results: 1). Most LLMs utilizing Pre-LN exhibit remarkable robustness to the removal of deeper layers, whereas BERT with Post-LN shows the opposite trend. 2). The number of layers that can be pruned without significant performance degradation increases with model size.

Identifying the Root Cause of CoD. We theoretically and empirically identify the root cause of CoD as the use of Pre-Layer Normalization (Pre-LN) [(Baevski and Auli, 2019;](#b2)[Dai et al., 2019)](#b8), which normalizes layer inputs before applying the main computations, such as attention or feedforward operations, rather than after. Specifically, while stabilizing training, we observe that the output variance of Pre-LN accumulates significantly with layer depth (see Appendix C), causing the derivatives of deep Pre-LN layers to approach an identity matrix. This behavior prevents these layers from introducing meaningful transformations, leading to diminished representation learning.

Mitigating CoD through LayerNorm Scaling. We pro-pose LayerNorm Scaling, which scales the output of Layer Normalization by the square root of the depth 1 √ l . Layer-Norm Scaling effectively scales down the output variance across layers of Pre-LN, leading to considerably lower training loss and achieving the same loss as Pre-LN using only half tokens. Figure [1](#fig_0) compares the layerwise output variance across different setups: (1) Pre-LN, (2) Pre-LN with Scaled Initialization [(Takase et al., 2023b)](#), and (3) Lay-erNorm Scaling. As shown, Pre-LN exhibits significant variance explosion in deeper layers. In contrast, LayerNorm Scaling effectively reduces output variance across layers, enhancing the contribution of deeper layers during training. This adjustment leads to significantly lower training loss compared to Pre-LN. Unlike previous LayerNorm variants [(Li et al., 2024b;](#)[Liu et al., 2020)](#b22), LayerNorm Scaling is simple to implement, requires no hyperparameter tuning, and introduces no additional parameters during training. Furthermore, we further show that the model pre-trained with LayerNorm Scaling achieves better performance on downstream tasks in self-supervised fine-tuning, all thanks to the more effective deep layers learned.

## Contributions.

• We introduce the Curse of Depth to highlight, understand, and rectify the phenomenon in LLMs that is commonly overlooked-deep layers fail to contribute as effectively as they should.

• We identify the root cause as Pre-LN, which causes output variance to grow exponentially with model depth. This leads to deep Transformer blocks having derivatives close to the identity matrix, rendering them ineffective during training. While scaled initialization [(Shoeybi et al., 2020)](#b30) helps mitigate variance at initialization, it does not prevent explosion during training.

• To mitigate this issue, we propose LayerNorm Scaling, which inversely scales the output of Pre-LN by the square root of the depth. This adjustment ensures that all layers contribute effectively to learning, thereby improving LLM performance. • We hope this work brings greater attention to this issue, contributes to the improvement of LLMs, and maximizes the utilization of computational resources dedicated to training large models.

## Empirical Evidence of the Curse of Depth

To empirically analyze the impact of layer normalization on the Curse of Depth in LLMs, we conduct a series of evaluations inspired by [Li et al. (2024b)](#), extending their methodology to compare Pre-LN and Post-LN models.

## Experimental Setup

Methods: We evaluate Pre-LN and Post-LN models by assessing the impact of layer pruning at different depths.

Our hypothesis is that Pre-LN models exhibit diminishing effectiveness in deeper layers, whereas Post-LN has less effective early layers. To verify this, we empirically quantify the contribution of individual layers to overall model performance across a diverse set of LLMs.

## LLMs:

We conduct experiments on multiple widely adopted LLMs: BERT-Large [(Devlin, 2019)](#b9), [Mistral-7B (Jiang et al., 2023)](#), LLaMA2-7B/13B [(Touvron et al., 2023)](#b35), DeepSeek-7B [(Bi et al., 2024)](#b5), and Qwen-7B [(Bai et al., 2023)](#b3). These models were chosen to ensure architectural and application diversity. BERT-Large represents a Post-LN model, whereas the rest are Pre-LN-based. This selection enables a comprehensive evaluation of the effects of layer normalization across varying architectures and model scales.

Evaluation Metric: To empirically assess the impact of deeper layers in LLMs, we adopt the Performance Drop metric ∆P (ℓ) , inspired by [Li et al. (2024b)](#). This metric quantifies the contribution of each layer by measuring the degradation in model performance following its removal. Specifically, it is defined as:

$∆P (ℓ) = P (ℓ) pruned -P original ,(1)$where P original represents the performance of the unpruned model, and

$P (ℓ)$pruned denotes the performance after removing layer ℓ. A lower ∆P (ℓ) suggests that the pruned layer plays a minor role in the model's overall effectiveness. For BERT-Large, we evaluate performance on the SQuAD v1.1 dataset [(Rajpurkar, 2016)](#b28), which measures reading comprehension. For Mistral-7B, LLaMA2-13B, and Qwen-7B, we assess model performance on the MMLU benchmark [(Hendrycks et al., 2021)](#b14), a widely-used dataset for multi-task language understanding.

## Layer Pruning Analysis

Figure [2](#fig_1) presents the performance drop (∆P (ℓ) ) across different layers for six LLMs, including one Post-LN model (BERT-Large) and five Pre-LN models (Mistral-7B, LLaMA2-13B, Qwen-7B, DeepSeek-7B and LLaMA2-7B).

As shown in Figure [2](#fig_1) (a), pruning deeper layers in BERT-Large leads to a significant decline in accuracy on SQuAD v1.1, while pruning earlier layers has minimal impact. The performance drop ∆P (ℓ) becomes particularly severe beyond the 10th layer, highlighting the crucial role of deeper layers in maintaining overall performance in Post-LN models. In contrast, removing layers in the first half of the network results in negligible changes, indicating their limited contribution to the final output.

However, as shown in Figure [2](#fig_1) (b)-(f), Pre-LN models exhibit a contrast pattern, where deeper layers contribute significantly less to the overall model performance. For instance, as shown in Figure [2](#fig_1) (b) and (c), pruning layers in the last third of Mistral-7B and Qwen-7B results in a minimal performance drop on MMLU, indicating their limited contribution to overall accuracy. In contrast, pruning the first few layers leads to a substantial accuracy degradation, highlighting their crucial role in feature extraction. Similarly, Figure [2 (d](#fig_1)) and (e) show that DeepSeek-7B and LLaMA2-7B follow a similar pattern, where deeper layers have little impact on performance, while earlier layers play a more significant role. Finally, as shown in Figure [2](#fig_1) (f), more than half of the layers in LLaMA2-13B can be safely removed. This suggests that as model size increases, the contrast between shallow and deep layers becomes more pronounced, with earlier layers playing a dominant role in representation learning. This observation underscores the need for the community to address the Curse of Depth to prevent resource waste.

## Analysis of the Curse of Depth

## Preliminaries

This paper primarily focuses on Pre-LN Transformer [(Baevski and Auli, 2019;](#b2)[Dai et al., 2019)](#b8). Let x ℓ ∈ R d be the input vector at the ℓ-th layer of Transformer, where d denotes the feature dimension of each layer. For simplicity, we assume all layers to have the same dimension d. The layer output y is calculated as follows:

$y = x ℓ+1 = x ′ ℓ + FFN(LN(x ′ ℓ )),(2)$$x ′ ℓ = x ℓ + Attn(LN(x ℓ )),(3)$where LN denotes the layer normalization function. In addition, the feed-forward network (FFN) and the multihead self-attention (Attn) sub-layers are defined as follows:

$FFN(x) = W 2 F(W 1 x), Attn(x) = W O (concat(head 1 (x), . . . , head h (x))), head i (x) = softmax (W Qi x) ⊤ (W Ki X) √ d head (W V i X) ⊤ ,(4$) where F is an activation function, concat concatenates input vectors, softmax applies the softmax function, and

$W 1 ∈ R d ffn ×d , W 2 ∈ R d×d ffn , W Qi ∈ R d head ×d , W Ki ∈ R d head ×d , W V i ∈ R d head ×d$, and W O ∈ R d×d are parameter matrices, and d FFN and d head are the internal dimensions of FFN and multi-head self-attention sub-layers, respectively. X ∈ R d×s , where s is the input sequence length.

The derivatives of Pre-Ln Transformers are:

$∂Pre-LN(x) ∂x = I + ∂f (LN(x)) ∂LN(x) ∂LN(x) ∂x ,(5)$where f here represents either the multi-head attention function or the FFN function. If the term ∂f (LN(x))

∂LN(x) ∂LN(x) ∂x becomes too small, the Pre-LN layer ∂Pre-LN(x) ∂x behaves like an identity map. Our main objective is to prevent identity map behavior for very deep Transformer networks. The first step in this process is to compute the variance σ 2

x ℓ of vector x ℓ .

## Pre-LN Transformers

Assumption 1. Let x ℓ and x ′ ℓ denote the input and intermediate vectors of the ℓ-th layer. Moreover, let W ℓ denote the model parameter matrix at the ℓ-th layer. We assume that, for all layers, x ℓ , x ′ ℓ , and W ℓ follow normal and independent distributions with mean µ = 0. Lemma 1. Let σ 2

x ′ ℓ and σ 2

x ℓ denote the variances of x ′ ℓ and x ℓ , respectively. These two variances exhibit the same overall growth trend, which is:

$σ 2 x ℓ = σ 2 x1 Θ ℓ-1 k=1 1 + 1 σ x k ,(6)$where the growth of σ 2 x l is sub-exponential, as shown by the following bounds:

$Θ(L) ≤ σ 2 x l ≤ Θ(exp(L)).(7)$Here, the notation

$Θ means: if f (x) ∈ Θ g(x) , then there exist constants C 1 , C 2 such that C 1 |g(x)| ≤ |f (x)| ≤ C 2 |g(x)| as x → ∞. The lower bound Θ(L) ≤ σ 2 x ℓ indi- cates that σ 2$x ℓ grows at least linearly, while the upper bound σ 2

x ℓ ≤ Θ(exp(L)) implies that its growth does not exceed an exponential function of L.

Based on Assumption 1 and the work of [(Takase et al., 2023b)](#), we obtain the following: Theorem 1. For a Pre-LN Transformer with L layers, using Equations (2) and (3), the partial derivative ∂y L ∂x1 can be written as:

$∂y L ∂x 1 = L-1 ℓ=1 ∂y ℓ ∂x ′ ℓ • ∂x ′ ℓ ∂x ℓ . (8$$)$The Euclidean norm of ∂y L ∂x1 is given by:

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + 1 σ x ℓ A + 1 σ 2 x ℓ B ,(9)$where A and B are constants for the Transformer network.

Then the upper bound for this norm is given as follows: when σ 2 x ℓ grows exponentially, (i.e., at its upper bound), we have:

$σ 2 x ℓ ∼ exp(ℓ), ∂y L ∂x 1 2 ≤ M,(10)$where the gradient norm converges to a constant M . Conversely, when σ 2 x ℓ grows linearly (i.e., at its lower bound), we have

$σ 2 x ℓ ∼ ℓ, ∂y L ∂x 1 2 ≤ Θ(L),(11)$which means that the gradient norm grows linearly in L.

The detailed description of A and B, as well as the complete proof, are provided in Appendix A.2.

From Theorem 1, we observe that when the variance grows exponentially, as the number of layers L → ∞, the norm

$∂y L ∂x1 2$is bounded above by a fixed constant M . This result implies that even an infinitely deep Transformer remains stable, and by the Weierstrass Theorem, the network is guaranteed to converge. Consequently, this implies that for very large L, deeper layers behave nearly as an identity map from x ℓ to y ℓ , thereby limiting the model's expressivity and hindering its ability to learn meaningful transformations. This outcome is undesirable, therefore, we would instead prefer the variance to increase more gradually-e.g., linearly-so that ∂y L ∂x1 2 exhibits linear growth. This observation highlights the necessity of appropriate variance control mechanisms, such as scaling strategies, to prevent excessive identity mappings and enhance network depth utilization.

## Post-LN Transformers

For Post-LN Transformers, we continue to adopt Assumption 1. In this setting, each layer is followed by a layer normalization (LN) step, ensuring that the variances σ 2 x ℓ and σ 2

x ′ ℓ remain fixed at 1 across all layers. Consequently, the norm ∂y ℓ ∂x ℓ 2 exhibits minimal variation from one layer to the next, indicating stable gradient propagation.

Since the variance is effectively controlled by LN in Post-LN Transformers, an explicit variance-based analysis becomes less critical. Nonetheless, there remain other important aspects to investigate in deeper Post-LN architectures, such as the evolution of feature mappings and the behavior of covariance kernels over deep layers. These directions will be pursued in future work. reducing the effectiveness of deeper layers. To mitigate this issue, we propose LayerNorm Scaling, a simple yet effective normalization strategy. The core idea of LayerNorm Scaling is to control the exponential growth of output variance in Pre-LN by scaling the normalized outputs according to layer depth. Specifically, we apply a scaling factor inversely proportional to the square root of the layer index to scale down the output of LN layers, stabilizing gradient flow and enhancing the contribution of deeper Transformer layers during training. LayerNorm Scaling is illustrated in Figure [3](#fig_2).

## LayerNorm Scaling

Formally, for a Transformer model with L layers, the output of Layer Normalization in each layer ℓ is scaled by a factor of 1 √ ℓ . Let h (ℓ) denote the input to Layer Normalization at layer ℓ. The modified output is computed as:

$h (l) = LayerNorm(h (ℓ) ) × 1 √ ℓ ,(12)$where ℓ ∈ {1, 2, . . . , L}.

This scaling prevents excessive variance growth with depth, addressing a key limitation of Pre-LN. Unlike Mix-LN, which stabilizes gradients in deeper layers but suffers from training instability caused by Post-LN (Nguyen and Salazar, 2019; Wang et al., 2024), LayerNorm Scaling preserves the stability advantages of Pre-LN while enhancing the contribution of deeper layers to representation learning. Applying LayerNorm Scaling leads to a notable reduction of layerwise output variance, resulting in lower training loss and faster convergence than vanilla Pre-LN. Moreover, compared with previous LayerNorm variants [(Li et al., 2024b;](#)[Liu et al., 2020)](#b22), LayerNorm Scaling is hyperparameter-free, easy to implement, and does not introduce additional learnable parameters, making it computationally efficient and readily applicable to existing Transformer architectures.

## Theoretical Analysis of LayerNorm Scaling

Lemma 2. After applying our scaling method, the variances of x ′ ℓ and x ℓ , denoted as σ 2

x ′ ℓ and σ 2 x ℓ , respectively, exhibit the same growth trend, which is:

$σ 2 x ℓ+1 = σ 2 x ℓ Θ(1 + 1 √ ℓσ x ℓ ),(13)$with the following growth rate bounds:

$Θ(L) ≤ σ 2 x L ≤ Θ(L (2-ϵ) ). (14$$)$where ϵ is a small number with 0 < ϵ ≤ 1/4.

From Lemma 2, we can conclude that our scaling method effectively slows the growth of the variance upper bound, reducing it from exponential to polynomial growth. Specifically, it limits the upper bound to a quadratic rate instead of an exponential one. Based on Theorem 1, after scaling, we obtain the following:

Theorem 2. For the scaled Pre-LN Transformers, the Euclidean norm of ∂y L ∂x1 is given by:

$∂y L ∂x 1 2 ≤ L-1 ℓ=1 1 + 1 ℓσ x ℓ A + 1 ℓ 2 σ 2 x ℓ B ,(15)$where A and B are dependent on the scaled neural network parameters. Then the upper bound for the norm is given as follows: when σ 2

x ℓ grows at ℓ (2-ϵ) , (i.e., at its upper bound), we obtain:

$σ 2 x ℓ ∼ ℓ (2-ϵ) , ∂y L ∂x 1 2 ≤ ω(1),(16)$where

$ω denotes that if f (x) = ω(g(x)), then lim x→∞ f (x) g(x) = ∞.$Meanwhile, when σ 2 x ℓ grows linearly (i.e., at its lower bound), we obtain:

$σ 2 x ℓ ∼ ℓ, ∂y L ∂x 1 2 ≤ Θ(L).(17)$The detailed descriptions of A and B, and ϵ, along with the full proof, are provided in Appendices A.3 and A.4.

By comparing Theorem 1 (before scaling) with Theorem 2 (after scaling), we observe a substantial reduction in the upper bound of variance. Specifically, it decreases from exponential growth Θ(exp(L)) to at most quadratic growth Θ(L 2 ). In fact, this growth is even slower than quadratic expansion, as it follows Θ(L (2-ϵ) ) for some small ϵ > 0.

When we select a reasonable upper bound for this expansion, we find that  

## LayerNorm Scaling Reduces Output Variance

As LayerNorm Scaling aims to reduce output variance, we validate this by comparing it with two scaling approaches: LayerScale [(Touvron et al., 2021)](#b34) and Scaled Initialization [(Shoeybi et al., 2020)](#b30). LayerScale applies per-channel weighting using a diagonal matrix, diag(λ 1 , . . . , λ d ), where each weight λ i is initialized to a small value (e.g., λ i = ϵ). Unlike LayerNorm Scaling, LayerScale learns the scaling factors automatically, which does not necessarily induce a down-scaling effect. Scaled Initialization scales the initialization of W 0 and W 2 to small values by 1 √ 2L where L is the total number of transformer layers. Since scaling is applied only at initialization, we argue that Scaled Initialization may not effectively reduce variance throughout training. We further verify this in Figure [1](#fig_0), where we can see the output variance of Scaled Initialization is as large as Pre-LN. Table [4](#tab_4) presents the results of LLaMA-130M and LLaMA-250M. First, we can see that LayerScale degrades performance. While Scaled Initialization slightly improves over Pre-LN, it falls short of LayerNorm Scaling and the gap becomes larger for the larger model.

## Enhancing Deep Layers with LayerNorm Scaling

To evaluate how LayerNorm Scaling improves deep layer effectiveness, we conduct a layer pruning experiment on LLaMA-130M, systematically removing individual layers and measuring the performance drop (∆P (ℓ) ) on the ARCe benchmark [(Clark et al., 2018)](#b7). Figure [4](#fig_3) compares the pruning effects between standard Pre-LN and LayerNorm Scaling. In the Pre-LN, removing deep layers results in minimal performance degradation, indicating their limited   

## Related Work

Layer Normalization in Language Models. [LN (Ba, 2016)](#) was initially applied after the residual connection in the original Transformer [(Vaswani, 2017)](#b36), which is known as Post-LN. Later on, Pre-LN [(Baevski and Auli, 2019;](#b2)[Dai et al., 2019;](#b8)[Nguyen and Salazar, 2019)](#b27) dominated LLMs, due to its compelling performance and stability [(Brown et al., 2020;](#b6)[Touvron et al., 2023;](#b35)[Jiang et al., 2023;](#b16)[Bi et al., 2024)](#b5).

Prior works have studied the effect of Pre-LN and Post-LN. [Xiong et al. (2020)](#b42) proves that Post-LN tends to have larger gradients near the output layer, which necessitates smaller learning rates to stabilize training, whereas Pre-LN scales down gradients with the depth of the model, working better for deep Transformers. [Wang et al. (2019)](#b39) empirically confirmed that Pre-LN facilitates stacking more layers and Post-LN suffers from gradient vanishing. The idea of connecting multiple layers was proposed in previous works [(Bapna et al., 2018;](#b4)[Dou et al., 2018;](#b11)[Wang et al., 2019)](#b39). Adaptive Model Initialization (Admin) was introduced to use additional parameters to control residual dependencies, stabilizing Post-LN. DeepNorm [(Wang et al., 2024)](#b38) enables stacking 1000-layer Transformer by upscaling the residual connection before applying LN. Additionally, Ding et al. (2021) proposed Sandwich LayerNorm, normalizing both the input and output of each transformer sub-layer. Takase et al. (2023a) introduced B2T to bypass all LN except the final one in each layer. Li et al. (2024b) recently combines Post-LN and Pre-LN to enhance the middle layers. The Curse of Depth in Large Language Models

## Conclusion

In this paper, we introduce the concept of the Curse of Depth in LLMs, highlighting an urgent yet often overlooked phenomenon: nearly half of the deep layers in modern LLMs are less effective than expected. We discover the root cause of this phenomenon is Pre-LN which is widely used in almost all modern LLMs. To tackle this issue, we introduce LayerNorm Scaling. By scaling the output variance inversely with the layer depth, LayerNorm Scaling ensures that all layers, including deeper ones, contribute meaningfully to training. Our experiments show that this simple modification improves performance, reduces resource usage, and stabilizes training across various model sizes. Layer-Norm Scaling is easy to implement, hyperparameter-free, and provides a robust solution to enhance the efficiency and effectiveness of LLMs.

## Impact Statement

This paper introduces the Curse of Depth in LLMs to call attention to the AI community an urgent but often overlooked phenomenon that nearly half of layers in modern LLMs are not as effective as we expect. The impact of this phenomenon is large that a significant amount of resources used to train LLMs are somehow wasted. We further introduce LayerNorm Scaling to ensure that all layers contribute meaningfully to model training. The result is a significant improvement in model efficiency, enabling better performance with fewer computational resources and training tokens. This innovation not only enhances LLM effectiveness across a variety of tasks but also reduces the environmental and financial costs of training large-scale models, making LLM development more sustainable and accessible. Layer-Norm Scaling presents a simple, hyperparameter-free solution that can be easily adopted, offering immediate practical benefits to the AI research community.

The Curse of Depth in Large Language Models

## A. Proofs of the Theorems

A.1. Proof of Lemma 1

Proof. Given Equation ( [2](#formula_2)) from [(Takase et al., 2023b)](#), we have:

$y = x ℓ+1 = x ′ ℓ + FFN(LN(x ′ ℓ )), x ′ ℓ = x ℓ + Attn(LN(x ℓ )).(18)$Based on our Assumption 1, let Var(Attn(LN(x ℓ ))) = σ 2 Attn . Then we can write:

$Var(x ′ ℓ ) = Var(x ℓ ) + Var(Attn(LN(x ℓ ))) + Cov(Attn(LN(x ℓ )), Var(x ℓ )) = σ 2 x ℓ + σ 2 Attn + ρ 1 • σ x ℓ • σ Attn ,(19)$where ρ 1 is the correlation factor. Similarly, let Var(FFN(LN(x ′ ℓ ))) = σ 2 FFN . Then we have:

$σ 2 x ℓ+1 = σ ( x ′ ℓ ) 2 + σ 2 FFN + ρ 2 • σ x ′ ℓ • σ FFN ,(20)$where ρ 2 is the correlation factor. Thus, the relationship between Var(x ℓ+1 ) and Var(x ℓ ) becomes:

$σ 2 x ℓ+1 = σ 2 x ℓ + σ 2 Attn + σ 2 FFN + ρ 1 • σ x ℓ • σ Attn + ρ 2 • σ x ′ ℓ • σ FFN .(21)$A.1.1. VARIANCE OF THE ATTENTION

The scaled dot-product attention mechanism is defined as:

$Attn(Q, K, V ) = softmax QK T √ d k V.$The softmax function outputs a probability distribution over the keys. Let the softmax output be

$A = softmax QK T √ d k$, where A is a matrix with each row summing to 1. The final attention output is obtained by multiplying the softmax output A with the value matrix V :

$Attn(Q, K, V ) = AV.$To simplify the analysis, we make the following additional assumptions: The softmax output A is approximately uniform, meaning each element of A is roughly 1/n, where n is the number of keys/values. Given this assumption, the variance of the attention is:

$Var(Attn(Q, K, V )) ∼ Var(AV ) = 1 n n i=1 Var(V i ) = 1 n • n • σ 2 V = σ 2 V = σ 2 W . (22$$)$where W is the universal weight matrix defined as before.

## A.1.2. VARIANCE OF THE FEED-FORWARD NETWORK

The feed-forward network (FFN) in transformers typically consists of two linear transformations with a ReLU activation in between. The FFN can be written as:

$FFN(x) = W 2 • ReLU(W 1 • x + b 1 ) + b 2 . (23$$)$where W 1 and W 2 are weight matrices, and b 1 and b 2 are bias vectors.

Using the result obtained by [Wang et al. (2024)](#b38), we get:

$σ 2 FFN ∼ σ 2 W1 • σ 2 W2 = σ 4 W .(24)$In conclusion:

$σ 2 x ′ ℓ = σ 2 x ℓ + σ 2 W + ρ 2 • σ x ℓ • σ W = σ 2 x ℓ (1 + σ W σ x ℓ + σ 2 W σ 2 x ℓ ) = σ 2 x ℓ Θ(1 + 1 σ x ℓ ).(25)$For simplicity, we set the numerator part to 1. Substitute

$σ x ′ ℓ = σ x ℓ 1 + σ 2 W σ 2 x ℓ + ρ 2 • σ W σx ℓ$. into Equation ( [21](#formula_27)) we get:

$σ 2 x ℓ+1 = σ 2 x ℓ + σ 2 W + σ 4 W + ρ 1 • σ x ℓ • σ W + ρ 2 • σ x ′ ℓ • σ 2 W = σ 2 x ℓ + σ 2 W + σ 4 W + ρ 1 • σ x ℓ • σ W + ρ 2 • σ x ℓ • σ 2 W + ρ 2 σ 4 W 2σ x ℓ + ρ 2 2 σ 3 W σ x ℓ 2 = σ 2 x ℓ Θ(1 + 1 σ x ℓ ).(26)$From the result we can generally infer that the variance accumulates layer by layer. The variance with regard to σ x1 :

$σ 2 x ℓ = σ 2 x1 Θ ℓ-1 k=1 1 + 1 σ x k .(27)$We can also obtain a similar result for σ 2

x ′ ℓ .

We observe that for any σ 2 x k ≥ 1, the sequence is increasing, meaning each term in the product is bounded. Consequently, the entire product is bounded above by:

$σ 2 x ℓ ≤ σ 2 x1 ℓ-1 k=1 1 + 1 σ x1 = σ 2 x1 1 + 1 σ x1 ℓ-1 = exp Θ(L). (28$$)$Taking the natural logarithm of both sides:

$log(σ 2 x ℓ ) = log σ 2 x1 ℓ-1 k=1 1 + 1 σ 2 x k = ℓ-1 k=1 log 1 + 1 σ 2 x k + log(σ 2 x1 ) ≥ ℓ-1 k=1 1 σ 2 x k - 1 2 1 σ 2 x k 2 + log(σ 2 x1 ).(29)$Exponentiating both sides to find the lower bound for σ 2 x ℓ , we obtain:

$σ 2 x ℓ ≥ σ 2 x1 exp ℓ-1 k=1 1 σ 2 x k - 1 2σ 2 x k .$This provides a tighter lower bound for σ 2

x ℓ compared to the upper bound of Equation ( [28](#formula_40)). Since we know the upper bound of variance grows exponentially, the lower bound must be sub-exponential. Therefore, for σ 2

x ℓ = ℓ, we must have:

$σ 2 x ℓ ≥ σ 2 x1 exp ℓ-1 k=1 1 k - 1 2k = Θ(exp( √ L)) ≥ Θ(L).$Therefore, the increasing lower bound for σ 2 x ℓ must grows faster than a linear function. So, the increasing of variance is sub-exponential.

## A.2. Proof of Theorem 1

In this proof, we will divide the argument into two parts: first, the calculation of the Lemma 3, and second, the analysis of ∂y ℓ ∂x1 . Lemma 3. For an L-layered Pre-LN Transformer, ∂y L ∂x1 using Equations (2) and (3) is given by:

$∂y L ∂x 1 = L-1 n=1 ∂y ℓ ∂x ′ ℓ • ∂x ′ ℓ ∂x ℓ . (30$$)$The upper bound for the norm of ∂y L ∂x1 is:

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + σ 2 σ x ′ ℓ ( √ d + √ d FFN ) 2 × 1 + 2dh √ s + 2 + 1 √ s σ 2 σ x ℓ σ 2 d d head + 1 + d head /d .(31)$Here, h denotes the number of heads, s is the sequence length, and d, d FFN , and d head are the dimension of the embedding, FFN layer and multi-head attention layer, respectively. The standard deviation of W Q , W K , W V , and W FFN at layer ℓ is σ based on Assumption 1.

A.2.1. PROOF OF LEMMA 3

Proof. Our derivation follows results in [(Takase et al., 2023b)](#), specifically Equation ( [7](#formula_8)), which provides an upper bound on the norm of ∂y ℓ ∂x1 as:

$∂y ℓ ∂x 1 2 = L-1 l=1 ∂y ℓ ∂x ′ ℓ ∂x ′ ℓ ∂x ℓ 2 . (32$$)$Thus, we can estimate the upper bound of the gradient norm of ∂y ℓ ∂x1 by analyzing the spectral norms of the Jacobian matrices for the FFN layer and the self-attention layer, namely, FFN:

$∂y ℓ ∂x ′ ℓ 2 Attention: ∂x ′ ℓ ∂x ℓ 2 . (33$$)$We now derive an upper bound of ∥ ∂y ℓ ∂x ′ ℓ ∥ 2 as follows:

$∂y ℓ ∂x ′ ℓ 2 ≤ 1 + ∂FFN(LN(x ′ ℓ )) ∂LN(x ′ ℓ ) 2 ∂LN(x ′ ℓ ) ∂x ′ ℓ 2 . (34$$)$Let σ w1 ℓ and σ w2 ℓ be the standard deviations of W 1 ℓ and W 2 ℓ , respectively. From Assumption 1, the spectral norms of W 1 ℓ and W 2 ℓ are given by their standard deviations and dimensions [(Vershynin, 2018)](#b37), so wo have:

$∥W 1 ∥ 2 ∼ σ 1 d + d FFN .$. For simplicity, we assume that d, and d FFN are equal, thus,

$∂FFN(LN(x ′ ℓ )) ∂LN(x ′ ℓ ) 2 = ∥W 1 ℓ W 2 ℓ ∥ 2 ≤ σ 1 σ 2 ( √ d + d ffn ) 2 . (35$$)$Finally, we have the following bound:

$∂y ℓ ∂x ′ ℓ 2 ≤ 1 + σ w1 ℓ σ w2 ℓ σ x ′ ℓ ( √ d + √ d FFN ) 2 = 1 + σ 2 ℓ σ x ′ ℓ ( √ d + √ d FFN ) 2 . (36$$)$Following a similar procedure for the FFN, we rewrite ∥ ∂x ′ ∂x ∥ 2 in Equation ( [33](#formula_50)) as:

$∂x ′ ∂x 2 ≤ 1 + ∂Attn(LN(x)) ∂LN(x) 2 ∂LN(x) ∂x 2 . (37$$)$Let Z(•) = concat(head 1 (•), . . . , head h (•)) and J Z denote the Jacobian of the Z(•). We can now express the spectral norm of the Jacobian matrix of attntion as:

$∂Attn(LN(x ℓ )) ∂LN(x ℓ ) 2 = W O ℓ Z(LN(x ℓ )) ∂Z(LN(x ℓ )) ∂LN(x ℓ ) 2 = ∥W O ℓ J Z ℓ ∥ 2 . (38$$)$From [(Vershynin, 2018)](#b37), we know that:

$∥J Z ℓ ∥ 2 ≤ h √ s + 2 + 1 √ s σ 3 d 3 d head + σ ℓ x √ d + d head . (39$$)$Here h is the number of heads, s is the sequence length, and the standard deviation of W Q , W K , and W V is σ.

By combining the inequalities ( [36](#formula_57)), ( [39](#formula_63)) and ( [37](#formula_59)), and assuming that all σ values are the same for simplicity. we obtain:

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + σ 2 σ x ′ ℓ ( √ d + √ d FFN ) 2 × 1 + 2dh √ s + 2 + 1 √ s σ 2 σ x ℓ σ 2 d d head + 1 + d head /d .(40)$
## A.2.2. ANALYSIS OF THE UPPER BOUND

As discussed in [(Takase et al., 2023b)](#), σ should be sufficiently small, and the standard deviation, σ x ′ ℓ or σ x ℓ should satisfy the condition σ 2 ≪ σ x ′ ℓ to maintain the lazy training scheme. Thus, we obtain the following bound for the product over ℓ from 1 to L:

To find the bound for ∂y ℓ ∂x1 2 with respect to ℓ, we simplify the given inequality by approximating σ x ℓ and σ x ′ ℓ . Based on Equation (25), σ x ℓ is only one layer ahead of σ x ′ ℓ , and this layer does not significantly affect the overall performance of deep Transformer networks. Furthermore, based on Lemma 1, we assume that σ x ′ ℓ = σ x ℓ . Equation (3) can be expressed in a traditional product form [(Whittaker and Watson, 1996)](#b40) for σ x ℓ :

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + 1 σ x ℓ A + 1 σ 2 x ℓ B ,(41)$where

$A = σ 2 ( √ d + √ d FFN ) 2 + 2dh √ s + 2 + 1 √ s σ 2 d d head + 1 + d head /d ,(42)$and

$B = 2dh √ s + 2 + 1 √ s σ 4 d d head ,(43)$where A and B are independent of σ x ℓ , and under our assumption, are treated as constants.

From classical infinite series analysis, it is known that as σ x ℓ grows at a faster rate, the upper bound of the product decreases. The proof is omitted here for brevity. For the upper bound on the convergence rate of σ 2 x ℓ , we assume σ 2 x ℓ = exp(ℓ) without loss of generality. Under this condition, we can derive the following result:

Taking the natural logarithm of the product:

$log L-1 k=1 1 + A e k + B e 2k = L-1 k=1 log 1 + A e k + B e 2k .$Using the Taylor series expansion for log(1 + x), and applying this to our sum, we get:

$∞ k=1 log 1 + A e k + B e 2k = ∞ k=1 A e k + B e 2k - 1 2 A e k + B e 2k 2 + 1 3 A e k + B e 2k 3 -• • • .$By evaluating the sums for each order of terms, we find that the result is a constant. Carrying this out for each term, we obtain:

$log L-1 k=1 1 + A e k + B e 2k ∼ A e -1 + B e 2 -1 - 1 2 A 2 e 2 -1 + 2 A • B e 3 -1 + B 2 e 4 -1.$Thus, the product is approximately:

$∂y L ∂x 1 2 ≤ exp A e -1 + B e 2 -1 - 1 2 A 2 e 2 -1 + 2 A • B e 3 -1 + B 2 e 4 -1 = M,(44)$where M is a constant.

For the lower bound on the convergence rate of σ 2 x ℓ , we assume σ 2 x ℓ = ℓ without loss of generality. Under this condition, we derive the following result. Taking the logarithm of the product, applying the Taylor series expansion for log(1 + x), and applying this to our sum:

$∞ k=1 log 1 + A k + B e k 2 = ∞ k=1 A k + B e k 2 - 1 2 A k + B e k 2 2 + 1 3 A k + B e k 2 3 -• • • .$For the first-order terms:

$∞ k=1 A k + B e k 2 = A ∞ k=1 1 k + B ∞ k=1 1 e k 2 .$
## The series

∞ k=1 1 k is the harmonic series, which diverges. However, we approximate it using the Euler-Mascheroni constant γ and the fact recognize that the harmonic series grows logarithmically:

$∞ k=1 1 k ∼ log n + γ (for large n).$The other series such as ∞ k=1 1 e k 2 converge because e k 2 grows very rapidly.

For higher-order terms, they converge to constant, involving the series ∞ k=1 1 k 2 converges to π 2 6 , so they contribute a constant. Exponentiating both sides, we get:

$∞ k=1 1 + A k + B e k 2 ∼ exp (A(log n + γ) + const) .$Thus, the growth rate of the upper bound for ∂y L ∂x1 2 is:

$∂y L ∂x 1 2 ≤ Θ(L).(45)$A.3. Proof of Lemma 2

Proof. After scaling, the equation becomes:

$y = x ℓ+1 = x ′ ℓ + FFN( 1 √ ℓ LN(x ′ ℓ )), x ′ ℓ = x ℓ + Attn( 1 √ ℓ LN(x ℓ )).(46)$Folloing the same analysis as before, we scale the Attention and FFN sub-layers, yielding:

$σ 2 Attn = 1 nℓ • n • σ 2 V = 1 ℓ σ 2 V = σ 2 W ℓ , σ 2 FFN ∼ σ 2 W1 ℓ • σ 2 W2 ℓ = σ 4 W ℓ 2 . (47$$)$In conclusion:

$σ 2 x ′ ℓ = σ 2 x ℓ + σ 2 W + ρ 2 • σ x ℓ • σ W √ ℓ = σ 2 x ℓ Θ(1 + 1 √ ℓσ x ℓ ).(48)$Similarly, we obtain:

$σ 2 x ℓ+1 = σ 2 x ℓ Θ(1 + 1 √ ℓσ x ℓ ).(49)$Taking the natural logarithm of both sides:

$log(σ 2 x ℓ ) = log σ 2 x1 ℓ-1 k=1 1 + 1 ℓσ 2 x k = ℓ-1 k=1 log 1 + 1 ℓσ 2 x k + log(σ 2 x1 ) ≥ ℓ-1 k=1 1 ℓσ 2 x k - 1 2 1 ℓσ 2 x k 2 + log(σ 2 x1 ).(50)$To establish a lower bound for σ 2 x ℓ , we exponentiate both sides. Setting σ 2 x ℓ = ℓ, we must have:

$σ 2 x ℓ ≥ σ 2 x1 exp ℓ-1 k=1 1 k - 1 2k = Θ(exp(log L)) ≥ Θ(L).(51)$Therefore, the increasing lower bound σ 2 x ℓ is greater than a linear function.

Similarly, assuming σ 2 x ℓ = ℓ (2-ϵ) , we have:

$σ 2 x ℓ = σ 2 x1 ℓ-1 k=1 1 + 1 ℓ 2-ϵ/2 ∼ exp ℓ-1 k=1 1 k 2-ϵ/2 ∼ exp ℓ ϵ/2-1 -1 ϵ/2 -1 ≤ Θ(ℓ (2-ϵ) ) ≤ Θ(ℓ 2 ). (52$$)$Here ϵ is a small constant with 0 < ϵ ≤ 1/4. Therefore, the increasing upper bound of σ 2 x ℓ is slower than the ℓ 3 function, leading to: σ 2 x ℓ ≤ Θ(L 2 ) .

## A.4. Proof of Theorem 2

Proof. Similarly, after applying the scaling transformation, we derive an upper bound for ∥ ∂y ℓ ∂x ′ ℓ ∥ 2 as follows:

$∂y ℓ ∂x ′ ℓ 2 ≤ 1 + ∂FFN(LN(x ′ ℓ )) ∂LN(x ′ ℓ ) 2 1 √ ℓ 2 ∂LN(x ′ ℓ ) ∂x ′ ℓ 2 = 1 + σ 2 ℓ ℓσ x ′ ℓ ( √ d + √ d FFN ) 2 . (53$$)$Similarly, rewriting Equation (33) after scaling, we have

$∂x ′ ∂x 2 ≤ 1 + ∂Attn(LN(x)) ∂LN(x) 2 1 √ ℓ 2 ∂LN(x) ∂x 2 . (54$$)$By combining the bound (53), and inequality (54), and assuming all σ are equal for simplicity, we obtain:

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + σ 2 ℓσ x ′ ℓ ( √ d + √ d FFN ) 2 × 1 + 2dh √ s + 2 + 1 √ s σ 2 ℓσ x ℓ σ 2 d d head + 1 + d head /d .(55)$Equation ( [55](#formula_91)) is a traditional product form [(Whittaker and Watson, 1996)](#b40) for σ x ℓ . After scaling, it becomes:

$∂y L ∂x 1 2 ≤ L-1 l=1 1 + 1 ℓσ x ℓ A + 1 ℓ 2 σ 2 x ℓ B ,(56)$where A and B retain their forms from Equation (42) and Equation ( [43](#formula_68)) and are treated as constants.

Regarding the upper bound on the convergence rate of σ 2 x ℓ , we assume σ 2 x ℓ = ℓ (2-ϵ) without loss of generality. For large L, the product can be approximated using the properties of infinite products:

$L-1 ℓ=1 1 + A ℓ 2-ϵ/2 + B ℓ 4-ϵ ∼ exp L-1 ℓ=1 A ℓ 2-ϵ/2 + B ℓ 4-ϵ . (57$$)$Then, by evaluating the sum in the exponent, we obtain:

$L-1 ℓ=1 1 + A ℓ 2-ϵ/2 + B ℓ 4-ϵ ∼ exp A • ℓ ϵ/2-1 -1 ϵ/2 -1 + B • ℓ ϵ-3 -1 ϵ -3 . (58$$)$Therefore, we establish the upper bound:

$∂y L ∂x 1 2 ≤ Θ exp A • ℓ ϵ/2-1 -1 ϵ/2 -1 + B • ℓ ϵ-3 -1 ϵ -3 = ω(1),(59)$where ω(1) denotes a growth strictly greater than a constant as defined before.

## B. Training Loss Curve

We report the training loss curve of Pre-LN and LayerNorm Scaling in Figure [5](#fig_4).  

## C. Variance Growth in Pre-LN Training

To analyze the impact of Pre-LN on variance propagation, we track the variance of layer outputs across different depths during training.

Figure [6](#fig_5) illustrates the layer-wise variance in LLaMA-130M with Pre-LN at 1000, 3000, and 6000 epochs. Across all stages, variance remains low in shallow layers but grows exponentially in deeper layers, confirming that this issue persists throughout training rather than being a temporary effect. This highlights the necessity of stabilization techniques like LayerNorm Scaling to control variance and ensure effective deep-layer learning.

![Figure 1. Layerwise output variance. This figure compares the output variance across various layers for different setups: (1) Pre-LN; (2) Pre-LN with Scaled Initialization; and (3) LayerNorm Scaling. The experiments are conducted on the LLaM-130M model trained for 10,000 steps. The proposed LayerNorm Scaling effectively controls the variance across layers.]()

![Figure 2. Performance drop of layer pruning across different LLMs. (a) BERT-Large (Post-LN), (b) Mistral-7B (Pre-LN), (c) Qwen-7B (Pre-LN), (d) DeepSeek-7B (Pre-LN), (e) LLaMA2-7B (Pre-LN), and (f) LLaMA2-13B (Pre-LN). The results show that Pre-LN models exhibit significant inefficiency in deeper layers, while Post-LN models maintain strong deep-layer contributions.]()

![Figure 3. Comparison between Pre-LN (a) and LayerNorm Scaling (b). LayerNorm Scaling applies a scaling factor inversely proportional to the square root of the layer index l, preventing excessive variance growth and stabilizing training dynamics across layers.]()

![Figure 4. Performance drop of layer pruning on LLaMA-130M. LayerNorm Scaling enables deep layers to make a meaningful contribution to the model.]()

![Figure 5. Training loss of LLaMA-1B with Pre-LN and LayerNorm Scaling.]()

![Figure 6. Variance growth across layers in LLaMA-130M with Pre-LN. Each subplot shows the variance at different training stages (1000, 3000, and 6000 epochs). In all cases, the variance follows an exponential growth pattern as depth increases, indicating that deeper layers experience uncontrolled variance amplification regardless of training progress.]()

![Consequently, fewer layers act as identity mappings compared to the original Pre-LN where nearly all deep layers collapsed into identity transformations. Instead, the after-scaled network effectively utilizes more layers, even as the depth approaches infinity, leading to improved expressivity and trainability.To evaluate the effectiveness of LayerNorm Scaling, we follow the experimental setup ofLi et al. (2024b), using the same model configurations and training conditions to compare it with widely used normalization techniques, including Post-LN (Nguyen and Salazar, 2019), DeepNorm(Wang et al., 2024), and Pre-LN(Dai et al., 2019). In line with Lialin et al. (2023) and Zhao et al. (2024), we conduct experiments using LLaMA-based architectures with model sizes of 130M, 250M, 350M, and 1B parameters, ensuring consistency in architecture and training settings. Perplexity (↓) comparison of various layer normalization methods across various LLaMA sizes.]()

![Comparison against other normalization methods on LLaMA-130M. Perplexity (↓) is reported.]()

![Fine-tuning performance (↑) of LLaMA with various normalizations.]()

![Comparison against other scaling methods.]()

University of Oxford, UK. Correspondence to: Shiwei Liu <shiwei.liu@maths.ox.ac.uk>. earlier ones[(Yin et al., 2024;](#b43)[Gromov et al., 2024;](#b13)[Men et al., 2024)](#b25). On the one hand, this interesting observation provides an effective indicator for LLM compression. For instance, we can compress deeper layers significantly more[(Yin et al., 2024;](#b43)[Lu et al., 2024;](#b43)[Dumitru et al., 2024)](#b12) to achieve high compression ratios. Even more aggressively, entire deep layers can be pruned completely without compromising performance for the sake of more affordable LLMs[(Muralidharan et al., 2024;](#b26)[Siddiqui et al., 2024)](#b31).

