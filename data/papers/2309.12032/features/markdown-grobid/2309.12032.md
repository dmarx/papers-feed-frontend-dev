# Human-in-the-Loop Causal Discovery under Latent Confounding using Ancestral GFlowNets

## Abstract

## 

Structure learning is the crux of causal inference. Notably, causal discovery (CD) algorithms are brittle when data is scarce, possibly inferring imprecise causal relations that contradict expert knowledge -especially when considering latent confounders. To aggravate the issue, most CD methods do not provide uncertainty estimates, making it hard for users to interpret results and improve the inference process. Surprisingly, while CD is a human-centered affair, no works have focused on building methods that both 1) output uncertainty estimates that can be verified by experts and 2) interact with those experts to iteratively refine CD. To solve these issues, we start by proposing to sample (causal) ancestral graphs proportionally to a belief distribution based on a score function, such as the Bayesian information criterion (BIC), using generative flow networks. Then, we leverage the diversity in candidate graphs and introduce an optimal experimental design to iteratively probe the expert about the relations among variables, effectively reducing the uncertainty of our belief over ancestral graphs. Finally, we update our samples to incorporate human feedback via importance sampling. Importantly, our method does not require causal sufficiency (i.e., unobserved confounders may exist). Experiments with synthetic observational data show that our method can accurately sample from distributions over ancestral graphs and that we can greatly improve inference quality with human aid.

## Introduction

Drawing conclusions about cause-and-effect relationships presents a fundamental challenge in various scientific fields and significantly impacts decision-making across diverse domains [Pearl [2000]](#b43). The importance of having structural knowledge, often encoded as a causal diagram, for conducting causal inferences is widely recognized, a concept made prominent by [Cartwright [1989]](#b9)'s dictum: "no causes in, no causes out". When there is no objective knowledge to fully specify a causal diagram, causal discovery (CD) tools are instrumental in partially uncovering causal relationships among variables from, for example, observational data. Formally, let V = {V 1 , V 2 , . . . , V n } be a set of n observed variables and D be a dataset containing |D| = m samples for each V i ∈ V. A CD algorithm takes D as input and typically returns a single graph G = (V, E) with well-defined causal semantics, in which each node in V represents a variable V i ∈ V and each edge in E encodes the possible underlying (causal/confounding) mechanisms compatible with D. We first train an AGFN to fit a data-informed belief over AGs. Then, we iteratively refine it by 1) questioning (Q) experts on the relation between a highly informative pair of variables and 2) updating the belief given the potentially noisy answers (A). The histograms on top of the edges show marginals over edge types (green denotes ground truth). Notably, our belief increasingly concentrates on the true AG, 1 → 2 ↔ 3. This work focuses on recovering the structure of the underlying causal diagram when unobserved confounders may be at play. We propose to address this task by not only leveraging observational data but also by accounting for potentially noisy pieces of expert knowledge, otherwise unavailable as data. Throughout this work, we consider ancestral graphs (AGs) as surrogates for causal diagrams. AGs are particularly convenient since they encode latent confounding without explicitly invoking unobserved variables. Moreover, AGs capture all conditional independencies and ancestral relations among observed variables V, as entailed by a causal diagram [[Richardson and Spirtes, 2002]](#b46).

In the realm of CD from solely observational data, algorithms aim to construct a compact representation of the joint observational distribution P (V), which implies a factorization as a product of conditional probabilities. Notably, multiple models may entail the same conditional independencies; in such cases, they are denoted as Markov-equivalent. As a result, these algorithms can only reconstruct the class of Markov-equivalent models (AGs), denoted as the Markov Equivalence Class (MEC) and typically represented by a Partial Ancestral Graph (PAG). Importantly, CD beyond the MEC by leveraging domain knowledge presents a critical challenge. Notably, there is no proper characterization of an equivalence class that accounts for knowledge stemming from both humans and data [[Wang et al., 2022]](#).

There is a variety of algorithms for CD from observational data, primarily categorized into constraintand score-based methods. The former uses (in)dependence constraints derived via conditional independence tests to directly construct a PAG representing the MEC. The latter uses a goodness-of-fit score to navigate the space of AGs, selecting an optimum as a representative for the MEC.

Nonetheless, methods within both paradigms suffer from unreliability when data is scarce. Specifically, for the majority of the CD algorithms, formal assurances that the inferred MEC accurately represents the true causal model heavily rely on the so-called faithfulness assumption, which posits that all conditional independencies satisfied by P (V) are entailed by the true causal model [[Zhang and Spirtes, 2016]](#b65). However, this presents a critical challenge in real-world scenarios, as violations of the faithfulness assumption become more prominent when relying on P (V) estimated from limited data [Uhler et al. [2012]](#b54), [Andersen [2013]](#b0), [Marx et al. [2021]](#). For constraint-based methods, hypothesis tests may lack the statistical power to detect conditional independencies accurately. These errors may propagate and trigger a chain reaction of erroneous orientations [Zhang and Spirtes [2008]](#b64), [Zhalama et al. [2017b]](#), [Ng et al. [2021]](#). For scorebased methods, although score functions directly measure goodness-of-fit on observational data, small sample sizes can significantly skew the estimates for the population parameters. Consequently, structures deemed score-optimal may not necessarily align with the ground-truth MEC Ogarrio et al. [[2016]](#). A major concern is that the overwhelming majority of CD algorithms produce a single representation of the MEC as output, without quantifying the uncertainty that arises during the learning process [Claassen and Heskes [2012]](#b11), [Jabbari et al. [2017]](#b24). This poses a significant challenge for experts, as it hinders their ability to validate the algorithm's outcome or gain insights into potential venues for improving inference quality.

To alleviate the lack of uncertainty quantification in CD, we propose sampling AGs from a distribution defined using a score function, which places best-scoring AGs around the mode by design. This effectively provides end-users with samples that reflect the epistemic uncertainty inherent in CD, thus allowing their propagation through downstream causal inferences. In particular, we sample from our belief using Generative Flow Networks [GFlowNets; [Bengio et al., 2021a,b]](#), which are generative models known for sampling diverse modes while avoiding the mixing time problem of MCMC methods, and not requiring handcrafted proposals nor accept-reject steps [[Bengio et al., 2021a]](#).

Acknowledging the low-data regime as CD's primary challenge, we also propose actively integrating human feedback in the inferential process. This involves modeling user knowledge on the existence and nature (confounding/ancestral) of the relations and using it to weigh our beliefs over AGs. During our interactions with experts, we probe them about the relation of the pair of variables that optimizes a utility/acquisition function, for which we propose the negative expected cross-entropy between our prior and updated beliefs. Unlike prior strategies, our acquisition avoids the need to estimate the normalizing constant and predictive distribution of our updated belief, as needed for information gain and mutual information, respectively. Notably, we use importance sampling [[Marshall, 1954](#b34)[, Geweke, 1989]](#b20) to update our initial belief with the human feedback, which avoids retraining GFlowNets after each human interaction.

While incorporating expert knowledge into CD has been a long-standing goal [[Meek, 1995a](#)[, Chen et al., 2016](#b10)[, Li and Beek, 2018](#b28)[, Wang et al., 2022]](#), existing works either rely on strong assumptions (e.g., causal sufficiency) or assume the knowledge is noiseless, aligned with the ground truth [[Andrews, 2020](#b1)[, Wang et al., 2022]](#). Importantly, our work introduces the first iterative CD framework for AGs involving a human in the loop and accommodating potentially noisy feedback, as depicted in Figure [1](#fig_0).

To validate our approach, we conduct experiments using the BIC score, for linear Gaussian causal models. Specifically, we assess: i) our ability to sample from score-based beliefs over AGs, ii) how our samples compare to samples from bootstrapped versions of state-of-the-art (SOTA) methods, and iii) the efficacy of our active knowledge elicitation framework using simulated humans. We observe that our method, Ancestral GFlowNet (AGFN), i) accurately samples from our beliefs over AGs; ii) consistently includes AGs with low structural error among its top-scored samples; and iii) is able to greatly improve performance metrics (i.e., SHD and BIC) when incorporating human in the loop.

In summary, the contributions of our work are:

1. We leverage GFlowNets to introduce AGFN, the first CD algorithm for scenarios under latent confounding that employs fully-probabilistic inference on AGs;

2. We show AGFN accurately learns distributions over AGs, effectively capturing epistemic uncertainty.

3. We propose an experimental design to query potentially noisy expert insights on relationships among pairs of variables that lead to optimal uncertainty reduction.

4. We show how to incorporate expert feedback into AGFN without retraining them from scratch.

## Background

This section introduces the relevant notation and concepts. We use uppercase letters V to represent a random variable or node in a graph, and boldface uppercase letters V to represent matrices or sets of random variables or nodes. Ancestral graphs. Under the assumption of no selection bias, an ancestral graph (AG) G over V is a directed graph comprising directed (→) and bidirected (↔) edges [Richardson and Spirtes [2002]](#b46), [Zhang [2007]](#b61). In any directed graph, if a sequence of directed edges, V i → • • • → V j , connects two nodes V i and V j , we refer to this sequence as a directed path. In this case, we also say that V i is an ancestor of V j and denote this relation as V i ∈ An(V j ). By definition, any AG G must further satisfy the following:

$G 1 = {X 1 → X 2 } G 5 = {X 1 → X 2 , X 2 → X 3 } G 2 = {X 1 ↔ X 2 } G 0 = {} G 6 = {X 1 ↔ X 2 , X 1 → X 3 } □ G 3 = {X 1 → X 3 } G 4 = {X 2 → X 3 } G 7 = {X 1 ↔ X 2 , X 2 → X 3 } R(G5) R(G6) R(G7)$Figure [2](#): Illustration of the generative process of AGs {G 5 , G 6 , G 7 } using GFlowNets. Starting with an empty graph G 0 , we add edges between variables {X 1 , X 2 , X 3 } according to the action-policy π F . Solid edges trace trajectories leading to sampled graphs. Dashed lines represent non-realized transitions to terminal state □.

1. there is no directed cycle, i.e., if

$V i → V j is in G, then V j ̸ ∈ An(V i ); and$2. there is no almost directed cycle, i.e., if

$V i ↔ V j is in G, then V j ̸ ∈ An(V i ) and V i ̸ ∈ An(V j ).$As a probabilistic model, the nodes in an AG represent random variables, directed edges represent ancestral (causal) relationships, and bidirected edges represent associations solely due to latent confounding. For a complete characterization of AGs, refer to [Richardson and Spirtes [2002]](#b46). Data generating model. We assume that the data-generating model corresponds to a linear Gaussian structural causal model (SCM) [[Pearl, 2000]](#b43) defined by a 4-tuple M = ⟨V, U, F, P (U)⟩, in which V = {V 1 , V 2 , . . . , V n } is a set of n observed random variables and U = {U 1 , U 2 , . . . , U n } is the set of unobserved random variables. Further, let P a i ⊆ V \ {V i } be the set of observed causes (parents) of V i , and U i be the set of unobserved causes of V i . Then, each structural equation f i ∈ F is defined as:

$V i = j:Vj ∈P ai β ij V j + U i(1)$with P (U) being a multivariate Gaussian distribution with zero mean and a not necessarily identity covariance matrix Ω = (ω ij ) 1≤i,j≤n -the error terms {U i } are not necessarily mutually independent, implying that the system can be semi-Markovian (i.e., latent confounding may be present). Consider a lower triangular matrix of structure coefficients B = (β ij ) 1≤i,j≤n such that (I -B) is invertible, and β ij ̸ = 0 only if V j ∈ P a i . Then, the set of structural equations is given in matrix form by

$V = BV + U =⇒ V = (I -B) -1 U.$(2)

The class of all linear Gaussian SCMs parametrized as

$N M = {N (0, Σ)|Σ = (I -B) -1 Ω(I -B) -⊤ } (3)$is represented by an AG in which, for every i ̸ = j, there is a directed edge [[Richardson and Spirtes, 2002]](#b46).

$V j → V i if β ij ̸ = 0 and a bidirected edge V j ↔ V i if ω ij ̸ = 0$GFlowNets. Generative Flow Networks [GFlowNet; [Bengio et al., 2021a,b]](#) are generative models designed to sample from a finite domain X proportionally to some reward function R : X → R + , which may be parametrized using neural networks. In this work, we define R as a strictly decreasing transformation of the BIC (more details in section 3). GFlowNets also assume there is a compositional nature to the elements x ∈ X , meaning that they can be built by iteratively acting to modify a base object (i.e., an initial state). For instance, graphs can be built by adding edges to a node skeleton [[Deleu et al., 2022]](#) or molecules by adding atoms to an initial structure [[Bengio et al., 2021a]](#).

The generative process follows a trajectory of states s ∈ S guided by a transition probability π F : S 2 → [0, 1]. In turn, π F is proportional to a foward flow function F θ : S 2 → R + , which is parameterized by a neural network θ. Let Pa(s ′ ) (Ch(s ′ )) be the set of all states which can transition into (directly reached from) s ′ . Then, π F is defined as

$π F (s ′ |s) = F θ (s → s ′ ) s ′ ∈Ch(s) F θ (s → s ′ ) . (4$$)$The support X of R is contained within S. There are also two special states in S: an initial state s 0 and a terminal state s f . We start with the initial state s 0 and transform it to a new valid state s with probability π F (s|s 0 ; θ). We keep iterating this procedure until reaching s f . States s valid as final samples (s ∈ X ) are known as terminating states and have a positive probability for the transition s → s f . Figure [2](#) illustrates this process with X being the space of AGs. Crucially, the same parameterization θ is used for all transition probabilities π F (•|s; θ) given any departing state s, allowing for generalization to states never visited during training.

As the GFlowNet framework requires that no sequence of actions leads to a loop, we represent the space of possible action sequences by a pointed Directed Acyclic Graph (DAG) [[Bengio et al., 2021b]](#). The generation of any sample x ∈ X follows a trajectory τ = (s 0 , s 1 , . . . , s T = x, s f ) ∈ S T +2 for a T ≥ 0. Different trajectories may lead to the same sample x. To ensure we sample proportionally to R, we search for a GFlowNet that satisfies the flow-matching condition, i.e., ∀s ′ ∈ S:

$s∈Pa(s ′ ) F θ (s → s ′ ) = R(s ′ ) + s ′′ ∈Ch(s ′ ) F θ (s ′ → s ′′ ).$(5)

Equation ( [5](#)) implies the flow that enters s ′ equals the flow leaving s ′ , except for some flow R(s ′ ) leaking from s ′ into s f . We let R(s) = 0 for s / ∈ X . Eventually, it may be that all states s are valid candidates, i.e., S = X ∪ {s f }. If so, each of eq. ( [5](#))'s solutions satisfies a detailed-balance condition,

$R(s)F θ (s → s ′ )F θ (s ′ → s f ) F θ (s → s f ) = R(s ′ )F B,θ (s ′ → s),(6)$for a parametrized backward flow F B,θ : S 2 → R + [Deleu et al. [2022]](#). In practice, we enforce eq. ( [6](#formula_10)) by minimizing

$L(θ) = E s→s ′ log R(s ′ )π F B (s|s ′ ; θ)π F (s f |s; θ) R(s)π F (s ′ |s; θ)π F (s f |s ′ ; θ) 2 . (7$$)$3 Ancestral GFlowNets

We propose AGFN, a GFlowNet-based method for sampling AGs using a score function. Specifically, AGFN encompasses a GFlowNet with the following characteristics:

1. Each trajectory state is a valid AG G t .

2. A terminating state's reward R(G T ) is a score-based potential suitable for CD of AGs.

3. A well-trained AGFN samples AGs with frequencies proportional to their rewards and with the best-scoring AG being, by design, the mode.

The generation of a trajectory τ = {{}, G 1 , G 2 , . . . , G T } begins with a totally disconnected graph with nodes V, iteratively adding edges of types {←, →, ↔} between pairs of variables. The following paragraphs describe AGFN. For further details, please refer to the Appendix. Action constraints. To ensure AGFN only samples AGs, we mask out actions that would lead to paths forming cycles or almost cycles. To achieve this, we verify whether the resulting graph respects [Bhattacharya et al. [2021]](#)'s algebraic characterization of the space of AGs. More specifically, any AG G is characterized by an adjacency matrix A d ∈ R n×n for its directed edges and another adjacency matrix A b ∈ R n×n for its bidirected edges, adhering to:

$trace(exp{A d }) -n + 1 T (exp{A d } ⊙ A b )1 = 0, (8$$)$in which 1 is a n-dimensional unit vector and ⊙ denotes the Hadamard (elementwise) product of matrices. Score-based belief. We propose using a strictly decreasing transformation of a score function U as the reward R for AGFN. More precisely, we define R as

$R(G) = exp µ -U (G) σ (9)$for given constants µ ∈ R and σ ∈ R + that ensure numerical stability [[Zhang et al., 2023]](#). In practice, we sample S AGs {G (s) } S s=1 from an untrained AGFN, and set µ = 1 /S s U (G (s) ) and

$σ = 1 /S s (U (G (s) ) -µ) 2 .$Score for linear Gaussian models. Since we focus on linear Gaussian models, we choose the extended Bayesian Information Criterion [Foygel and Drton [2010]](#b19) as our score function. Specifically, for any AG G = (V, E):

$U (G) = -2l N ( B, Ω) + |E| log n + 2|E| log |V|,(10)$in which ( B, Ω) is the MLE estimate of model parameters (see eq. ( [3](#))) obtained using the residual iterative conditional fitting algorithm [Drton et al. [2009]](#b18).

Forward flow. We use a Graph Isomorphism Network (GIN) [Xu et al. [2019]](#b56) Φ to compute a ddimensional representation for each node in the AG G t at the t-th step of the generative process and use sum pooling to get an embedding for G t . Then, considering A t as the space of feasible actions at G t (i.e., those leading to an AG), we use an MLP ϕ : R d → R |At| with a softmax activation at its last layer to map G t 's embedding to a distribution over A t . More precisely, given

$H (t) = Φ(G t ) ∈ R |V|×d , we compute p = ϕ v∈V H (t) v (11$$)$as the probability distribution over the feasible actions at G t . Backward flow. Backward actions correspond to removing edges. Following [Shen et al. [2023]](#b48), we parametrize the backward flow F B with an MLP and alternate between updating π F and π F B , using gradient-based optimization.

4 Human-in-the-Loop Causal Discovery

Concluding the training, we propose leveraging the AGFN-generated samples to design questions for the expert that optimize the reduction of entropy in the distribution p θ (G) over the space of AGs. Then, we use the human feedback to update p θ (G), and iteratively repeat the process. The following paragraphs describe i) how we model human feedback, ii) how we update our belief over AGs given human responses, and iii) our experimental design strategy for expert inquiry.

Modeling human feedback.

We assume humans are capable of answering questions regarding the ancestral relationship between pairs of random variables. In this case, we model their prior knowledge on a relation r = {U, V } between nodes U, V ∈ V as a categorical distribution over a random variable denoted ω r . Fix an arbitrary total order < in V. By definition, ω r = 1 if there is no edge between U and

$V ; ω r = 2 if U is ancestor of V < U ; ω r = 3 if V is ancestor of U > V ;$and ω r = 4 if there is a bidirected edge between U and V . Since the human has access to our AGFN before being probed for the first time, we set ρ r,k = p θ (ω r = k) as the prior probability of ω r = k. Moreover, we consider that the expert's feedback f r ∈ {1, 2, 3, 4} on the relation r is a noisy realization of the true, unobserved value of the relation feature ω r under the expert's model. Putting all elements together results in a two-level Bayesian hierarchical scheme for categorical data:

$ω r ∼ Cat(ρ r ), (12$$) f r |ω r ∼ Cat δ ωr • π + (1 -δ ωr ) • 1 -π 3 ,(13)$in which ρ r = (ρ r,1 , ρ r,2 , ρ r,3 , ρ r,4 ) represents our prior beliefs about the relations' features, π ∈ [0, 1] reflects the reliability of the expert's feedback, and δ k is the k-th canonical basis of R 4 . Conveniently, the posterior distribution of the relation feature ω r given the feedback f r is a categorical distribution parametrized by with

$ρ r η r ⊙ π • δ fr + 1 -π 3 • (1 -δ fr ) ,(14)$$η r = ρ r,fr • π + 1-π 3 • (1 -ρ r,fr ).$Updating beliefs.

We update our AGFN by weighing it by our posterior over the expert's knowledge, described in the previous paragraph, similarly to a product-of-experts approach [Hinton [2002]](#b22). For this, let f K = (f r k ) 1≤k≤K be the sequence of K feedbacks issued by the expert and define our novel belief distribution q(G; f K ) over the space of AGs as q(G;

$f K ) ∝ p θ (G) 1≤k≤K p(ω r k |f r k ). (15$$)$Importantly, we use p θ as proposal distribution in importance (re-)sampling Gordon et al. [[1993]](#) to approximately sample from q(G; f K ) -or to approximate the expected value of a test function. More precisely, we estimate the value of a function h over the space of AGs as:

$E q [h(G)] ≈ T t=1 c -1 q(G (t) ; f K ) p θ (G (t) ) h(G (t) ) (16) with (G (t) ) T t=1 ∼ p θ (G) and c = T t=1 q(G (t) ;f K ) /p θ (G (t) ).$Active knowledge elicitation.

To make the most out of possibly costly human interactions, we query the human about the relation that maximally reduces the expected cross-entropy between our belief over AGs before and after human feedback. More precisely, we define an acquisition function a k : V 2 → R for the k > 1-th inquiry as:

$a k (r) = -E fr∼p(•|f K ) H (q(G; f K , f r ), q(G; f K )) (17)$in which p(f r |f K ) is the posterior predictive distribution according to the user model, q 0 ∝ R and H(•, •) is the cross-entropy. Then, we maximize this acquisition to select which relation rk we will probe the expert, i.e.: rk = arg max

$r∈( V 2 ) a k (r). (18$$)$As aforementioned, we use importance sampling with q 0 as a proposal to estimate the acquisition function a k . This allows us to leverage AGFN samples and effectively avoid the need for retraining them. It is worth mentioning that because H(p, p ′ ) ≥ H(p, p) for any two distributions p and p ′ of the same support, our strategy is equivalent to minimizing an upper bound on the entropy of q k . Also, different from acquisitions based on information gain or mutual information, approximating Equation (17) via Monte Carlo does not require exhaustive integration over the space of AGs to yield asymptotically unbiased estimates -see Appendix.

chain4 IV collfork SHD BIC SHD BIC SHD BIC FCI ⋆ 3.03±1.13 5481.33±2.69 3.75±0.64 5426.18±1.74 6.26±1.20 5433.80±6.94 GFCI ⋆ 2.24±0.64 5479.77±1.75 4.21±0.96 5427.09±2.85 5.23±1.08 5431.67±7.91 DCD ⋆ 3.38±1.30 5482.97±5.16 5.22±1.23 5429.51±4.37 6.02±1.22 5436.84±9.41 N-ADMG 6.14±1.49 5520.01±75.34 8.50±1.44 5583.17±79.47 7.16±1.50 5491.86±84.47 AGFN (ours) 6.04±2.12 5494.67±37.08 8.72±2.04 5456.16±52.25 6.58±2.34 5478.01±40.36 Table [1](#): Average SHD and BIC. The ⋆ denotes methods yielding point estimates. We use Bootstrap to report the mean and average standard deviation for these. For N-ADMG and AGFN, we estimate the quantities using 100k samples. Figure [4](#): Ancestral graphs representing the data generating models for the three considered datasets in Table [1](#).

## Experiments

Our experiments have three objectives. First, we validate that AGFN can accurately learn the target distribution over the space of AGs. Second, we show that AGFN performs competitively with alternative methods on three data sets. Third, we attest that our experimental design for incorporating the expert's feedback efficiently reduces the uncertainty over AGFN's distribution. We provide further experimental details in the Appendix. Code is available in the supplement.

## Distributional Assessment of AGFN

Data. Since violations of faithfulness are more likely in dense graphs [Uhler et al. [2012]](#b54), we create 20 5-node random graphs [Uhler et al. [2012]](#b54) from a directed configuration model [[Newman, 2010]](#b38) whose in-and out-degrees are uniformly sampled from {0, 1, 2, 3, 4}. We draw 500 independent samples from a structure-compatible linear Gaussian SCM with random parameters for each graph.

Setup. We train AGFN for each random graph using their respective samples. Then, we collect AGFN samples and use them to compute empirical distributions over the (i) edge features (i.e., p θ (U → V ), p θ (U ← V ), p θ (U ↔ V ) and p θ (U ̸ -V ) for each pair (U, V )), (ii) BIC, and (iii) structural Hamming distance to the true causal diagram (SHD).

Results. Figure [3](#fig_1) shows that the AGFN adequately approximates the theoretical distribution induced by the reward in Equation ( [9](#)). Furthermore, AGFNs induce distributions over BIC and SHD values that closely resemble those induced by p(G) ∝ R(G). We also note an important improvement over the prior art on probabilistic CD (N-ADMG): we found that over 60% of its samples were non-ancestral and that this method was of little use for making inferences over AGs. Meanwhile, AGFN does not sample non-ancestral graphs.

## Comparison with SOTA CD algorithms

Data. We generate 10 datasets with 500 independent samples from the randomly parametrized linear Gaussian SCMs corresponding to the canonical causal diagram [Richardson and Spirtes [2002]](#b46) in each AG depicted in Figure [4](#). Unshielded colliders and discriminating paths are fundamental patterns in the detection of invariances by CD algorithms under latent confounding [Spirtes and Richardson [1997]](#b50), [Zhang [2008b]](#). Thus, we consider the following 4-node causal diagrams with increasingly difficult configurations: (i) chain4, a chain without latent confounders; (ii) collfork, a graph with triplets involving colliders and non-colliders under latent confounding, and (iii) IV, a structure with a discriminating path for Z: Baselines. We compare AGFN with four notable CD methods: FCI [[Spirtes et al., 2001](#b51)[, Zhang, 2008b]](#), [GFCI [Ogarrio et al., 2016]](#), DCD [[Bhattacharya et al., 2021]](#), and N-ADMG [Ashman et al. [2023]](#b2). The baselines span four broad classes of CD methods. FCI is a seminal constraint-based CD algorithm that learns a PAG consistent with conditional independencies entailed by statistical tests. GFCI is a hybrid CD algorithm that learns a PAG by first obtaining an approximate structure using FGS [[Ramsey, 2015]](#b44) (a BIC-score-based search algorithm for causally sufficient scenarios) and then by applying FCI to identify possible confounding and remove some edges added by FGS. DCD casts CD as continuous optimization with differentiable algebraic constraints defining the space of AGs and uses gradient-based algorithms to solve it. N-ADMG computes a variational approximation of the joint posterior distribution over the space of bow-free causal diagrams [[Nowzohour et al., 2017]](#b40) associated with non-linear SCMs with additive noise. While N-ADMG focuses on a more restricted setting compared to AGs, it offers some uncertainty quantification in the variational pohttps[://www.overleaf.com/project/650454a084b798332af29ebesterior](://www.overleaf.com/project/650454a084b798332af29ebesterior), making it more closely comparable to our approach. We rigorously follow the experimental guidelines in the original works.

$W → X ← Z → Y .$Experimental setup We train AGFN on each dataset and use it to sample 100k graphs. We also apply FCI, GFCI, and DCD to 100 bootstrapped resamplings of each dataset to emulate confidence distributions induced by these algorithms. To compare the algorithms' outputs, we compute the sample mean and standard deviation of the BIC and SHD at the PAG level. Specifically, we compute the SHD between the ground-truth PAG and each estimated PAG obtained by each method. If the output is a PAG member (as for DCD, N-ADMG, and AGFN) we use FCI to transform the output using these graphs as oracles for conditional independencies. Furthermore, we directly compute the BIC for the outputs, as all PAG members are asymptotically score-equivalent.

Results. Table [1](#) compares AGFN against baseline CD algorithms. Notably, our method consistently outperforms the only probabilistic baseline in the literature (N-ADMG) in terms of both SHD and BIC. As expected, however, the average BIC and SHD induced by AGFN are larger than those induced by the bootstrapped versions of the non-probabilistic algorithms, and the variances are greater; this is due to the inherent sampling diversity of our method and the resulting generation of possibly implausible samples. Indeed, Table [2](#tab_1) shows that the three most rewarding samples from AGFN are as good as (and sometimes better than) the other CD algorithms. Results for N-ADMG comprise the three most frequent samples from the variational distribution.

## Simulating humans in the loop

Data. We follow the procedure from Section 5.1 to generate graphs with 4, 6, 8 and 10 nodes. We draw 500 samples from a compatible linear Gaussian SCM and use them to train an AGFN. Then, we follow our active elicitation strategy from Section 4 to probe simulated humans, adhering to the generative model described in the same section, with π = 0.9.

Setup. Since we are the first to propose an optimal design for expert knowledge elicitation, there are no baselines to compare AGFN against. That being said, we aim to determine whether the inclusion of expert feedback enhances the concentration of the learned distribution around the true AG, and evaluate the effectiveness of our elicitation strategy. To do so, we measure SHD to the true AG and BIC as a function of the number of expert interactions.

Results. Figure [5](#fig_3) shows that incorporating expert feedback substantially decreases the expected SHD and BIC under our belief over AGs. On the one hand, the remarkable decrease in expected SHD shows that our belief becomes increasingly focused on the true AG as we iteratively request the expert's feedback, regardless of the querying strategy. On the other hand, the second row shows that our querying strategy results in a substantial decrease in the BIC, demonstrating a faster reduction than random queries. This validates the notion that some edges are more informative than others, and we should prioritize them when probing the expert.

## Related Work

CD under latent confounding. Following the seminal works by [Spirtes et al. [2001]](#b51) and [Zhang [2008b]](#) introducing the complete FCI, a variety of works have emerged. Among them are algorithms designed for sparse scenarios, including RFCI [[Colombo et al., 2012]](#b13) and others [[Silva, 2013](#b49)[, Claassen et al., 2013]](#b12). Notably, [Silva [2013]](#b49)'s framework uses a Bayesian approach to CD of Gaussian causal diagrams based on sparse covariance matrices. Nonetheless, it requires sampling one edge at a time and relies on numerical heuristics that might effectively alter the posterior we are sampling from. [Colombo et al. [2012]](#b13) introduced the conservative FCI to handle conflicts arising from statistical errors in scenarios with limited data, even though it yields less informative results. Subsequent efforts to improve reliability led to the emergence of constraint-based CD algorithms based in Boolean satisfiability [[Hyttinen et al., 2014](#b23)[, Magliacane et al., 2016]](#b32), although they are known to scale poorly on [|V| [Lu et al., 2021]](#). In another paradigm, score-based search algorithms rank MAGs according to goodness-of-fit measures, commonly using BIC for linear Gaussian SCMs [[Triantafillou and Tsamardinos, 2016](#b52)[, Zhalama et al., 2017a](#)[, Rantanen et al., 2021]](#).

There are also hybrid approaches that combine constraint-based strategies to reduce the search space, such as GFCI [[Ogarrio et al., 2016]](#b41), M3HC [[Tsirlis et al., 2018]](#b53), BCCD [[Claassen and Heskes, 2012]](#b11),

and GSPo [[Bernstein et al., 2020]](#b6). Continuous optimization approaches have recently emerged as a novel approach to score-based CD, such as DCD [[Bhattacharya et al., 2021]](#) and N-ADMG [Ashman et al. [2023]](#b2).

CD with expert knowledge. Previous works on CD have explored various forms of background knowledge. This includes knowledge on edge existence/non-existence [Meek [1995b]](#), ancestral constraints [Chen et al. [2016]](#b10), variable grouping [Parviainen and Kaski [2017]](#b42), partial order [Andrews [2020]](#b1) and typing of variables [[Brouillard et al., 2022]](#). Incorporating expert knowledge is pivotal to reducing the search space and the size of the learned equivalence class. However, due to significant challenges, up to date, there are only a few works trying to integrate human knowledge into CD within the context of latent confounding [[Andrews, 2020](#b1)[, Wang et al., 2022]](#). These works operate under the assumption of perfect expert feedback. In contrast, our contribution is novel in that it confronts the challenges of real-world situations where expert input might be inaccurate.

## Discussion

We presented AGFN, the first probabilistic CD method that accounts for latent confounding and incorporates potentially noisy human feedback in the loop. AGFN samples AGs according to a score function, quantifying the uncertainty in the learning process. Furthermore, it can leverage human feedback in an optimal design strategy, efficiently reducing our uncertainty on the true data-generating model. This work is focused on linear Gaussian models, using BIC as our score. However, the implementation of AGFNs is not restricted by this choice. In principle, we could replace the BIC with alternative score functions that are more appropriate for different types of variables, e.g. for discrete data [[Drton and Richardson, 2008]](#b17). It is also important to highlight that our framework does not require retraining the AGFN after we see human feedback. Moreover, AGFN is a GPU-powered algorithm, and while we used only one GPU in our experiments, it is possible to greatly accelerate AGFN by using cluster architectures with multiple GPUs.

By offering uncertainty-quantified CD together with a recipe for including humans in the loop, we expect AGFNs will significantly enhance the accuracy and reliability of CD, especially in real-world domains. Moreover, AGFNs bring a novel perspective to developing more comprehensive tools for downstream causal tasks [Bareinboim and Pearl [2016]](#b3), as the resulting distribution encodes knowledge from data and human feedback while accounting for epistemic uncertainty. For example, methods for causal reasoning that currently rely on a single AG [Zhang [2008a]](#), [Jaber et al. [2022]](#) could exploit this distribution to incorporate a richer understanding of uncertainty and knowledge, thereby enhancing their robustness and reliability.

## A Additional Related Works

Generative Flow Networks [GFlowNets; [Bengio et al., 2021a,b]](#) are generative models that sample discrete composite objects from an unnormalized reward function. They have been successfully used to sample various structures such as protein sequences [[Jain et al., 2022]](#) and schedules [[Zhang et al., 2023]](#). They have also been used to train energy-based models [[Zhang et al., 2022]](#b60). In the field of structure learning, they have been applied to Bayesian networks -more specifically to sample a posterior over DAGs in linear Gaussian networks, although without accounting for unobserved confounding [[Deleu et al., 2022]](#). Recently, [Deleu et al. [2023]](#b16) proposed an extension to jointly infer the structure and parameters, also grounded in the assumption of causal sufficiency. It is worth highlighting that training GFlowNets in these scenarios presents optimization challenges, resulting in the utilization of a variety of loss functions [[Shen et al., 2023]](#b48). Moreover, [Lahlou et al. [2023]](#b27) proposed an extension of GFlowNets to continuous domains.

## B Cross-entropy acquisition

The expected mutual information and the information gain are the most widely used informationtheoretic measures to actively interact with a human and choose the most informative data points to be labeled [Ryan et al. [2015]](#b47). However, we instead use the negative expected cross-entropy between the current and updated beliefs as the acquisition function of our experimental design (see eq. ( [17](#))). As we show next, the approximation of both the mutual information and the information gain is intrinsically dependent upon the estimation of the log-partition of the updated beliefs over the space of ancestral graphs. Doing so is computationally intensive, and we would either need to use a Monte Carlo estimator of the integrals or use some posterior approximation -in both cases, leading to asymptotically biased estimates of the acquisition. In contrast, we can easily leverage AGFN samples to compute asymptotically unbiased estimates of our acquisition function. The next paragraphs provide further details.

Mutual information. The mutual information between two random variables X and Y with joint distribution p(X, Y ) and marginal distributions p(X) and p(Y ) is

$I(X, Y ) = D KL [p(X, Y )||p(X) ⊗ p(Y )],(19)$in which D KL is the Kullback-Leibler divergence. In this context, an alternative approach to our experimental design for active knowledge elicitation would consist in iteratively maximizing the expected mutual information between the observed samples, G, and the elicited feedback, f K , to select the relation about which the expert would provide feedback. More specifically, we could choose

$r K+1 = arg max r∈( V 2 ) E fr∼p(•|f K ) [I(G, f r )],(20)$in which

$I(G, f r ) = D KL [q(G, f r |f K )||q(G|f K ) ⊗ p(f r |f K )],(21)$at each interaction with the expert. Nonetheless, note that

$q(G, f r |f K ) = q(G|f K+1 )p(f r |f K ) = c K+1 (f r )p θ (G)   1≤k≤K+1 p(ω r k |f r k )   • p(f r |f K ), with f r K+1 = f r and c K+1 (f r ) =   G p θ (G)   1≤k≤K+1 p(ω r k |f r k )     -1(22)$as the partition function of our updated beliefs. Note also that Equation ( [21](#formula_34)) entails computing the entropy of q(G, f r |f K ). Thus, the selection criterion in eq. ( [20](#formula_33)) requires an accurate estimate of log c K+1 (f r ) -which is well-known for being a difficult problem [Ma et al. [2013]](#b31) -and the Monte Carlo estimator for the log-partition function is asymptotically biased.

Information gain. The expected information gain of an elicitation is defined as the expected KL divergence between our updated and current beliefs over ancestral graphs. This approach is widely employed in Bayesian experimental design [Ryan et al. [2015]](#b47). In our framework, the information gain resulting from a feedback f r is

$IG K (f r ) = D KL [q(G|f K ∪ f r )||q(G|f K )],(23)$which yields the criterion

$r K+1 = arg max r∈( V 2 ) E fr∼p(•|f K ) [IG K (f r )] .(24)$Nonetheless, eq. ( [24](#formula_37)) suffers from the same problems of eq. ( [20](#formula_33)): it requires approximating the logarithm of the partition function c K+1 (f r ) of a distribution over the combinatorially large space of ancestral graphs, which is notably very challenging to estimate. Indeed, as

$D KL [q(G|f K+1 )||q(G|f K )] = E G∼q(•|f K+1 ) log q(G|f K+1 ) q(G|f K ) = E G∼q(•|f K+1 ) [log p(f r |ω r ) + log c K+1 (f r ) -log c K ] ,$with f r K+1 = f r , c K as the partition function of q(•|f K ) -that does not depend upon f r -, and c K+1 (f r ) defined in eq. ( [22](#formula_35)), the estimation of the information gain is inherently dependent upon the estimation of the log-partition function.

Cross-entropy. The cross-entropy between our updated and current beliefs is an intuitively plausible and practically useful strategy to interact with an expert efficiently. In fact, since

$H[q(•|f K+1 ), q(•|f K )] = E G∼q(•|f K+1 ) [-log q(G|f K )] = E G∼q(•|f K+1 )   -log p θ (G) - 1≤k≤K log p(ω r k |f r k ) -l K   ,$in which l K is the log-partition function of the distribution q(•|f K ). Further, the cross-entropy depends exclusively upon i) the logarithm of the samples' rewards, log p θ (G), which is readily computed within AGFN's generative process, and ii) the posterior distribution over the relations' features ω r given the expert's feedbacks f r , which is available in closed form. Hence, the previously mentioned expectation is unbiasedly and consistently estimated by our importance sampling scheme. Furthermore, our empirical findings in fig. [5](#fig_3) suggest that the cross-entropy yields good results and consistently outperforms a uniformly random strategy with respect to the BIC score.

## C Experimental details

We lay out the experimental and implementational details of our empirical analysis in the next subsections. In Appendix C.1, we describe the specific configurations of the CD algorithms that we compared with our method in table 2. Then, we consider in appendix C.2 some practical guidelines and architectural specifications that enable us to train and make inferences with AGFN efficiently. Finally, we contemplate in appendix C.3 the algorithmic details for simulating the expert's feedback according to our model for active knowledge elicitation.

## C.1 Baselines

FCI. For the results in table 1, we first estimated a PAG using the stable version of FCI, which produces a fully order-independent final skeleton [[Colombo et al., 2014]](#b14). To identify conditional independencies, we used Fisher's Z partial correlation test with a significance level of α = 0.05. The BIC score associated with the PAG estimated by the FCI was computed as the BIC of a randomly selected maximal AG  [25](#))) enables us to increase the proportion of high-scoring graphs (i.e., with a low BIC-score) with the drawback of reducing the AGFN's sampling diversity.

(MAG) within the equivalence class characterized by such PAG. The maximality of an AG depends on the absence of inducing paths between non-adjacent variables, which are paths where every node along it (except the endpoints) is a collider and every collider is an ancestor of an endpoint [[Rantanen et al., 2021]](#). This ensures that in the MAG every non-adjacent pair of nodes is m-separated by some set of other variables. Importantly, Markov equivalent MAGs exhibit asymptotic equivalence in terms of BIC scores [[Richardson and Spirtes, 2002]](#b46). As a result, the choice of a random MAG does not disrupt the validity of our results.

GFCI. Similarly, we applied GFCI with an initial search algorithm (FGS) based on the BIC score and the subsequent application of the FCI with conditional independencies identified by the Fisher's Z partial correlation test with a significance level α = 0.05. This was performed for all datasets listed in table 1. Also similar to the procedure adopted with the FCI, the BIC score associated with the estimated PAG was computed as the BIC of a randomly selected MAG within the equivalence class characterized by such PAG.

DCD. We adhered to the instructions provided in the official repository[foot_0](#foot_0) to apply the DCD method on the datasets in table 1. The SHD was obtained between the ground-truth PAG and the PAG corresponding to the estimated ADMG (i.e., the one obtained via FCI by using the d-separations entailed by the estimated ADMG as an oracle for conditional independencies). On the other hand, the BIC was computed for the estimated ADMG directly.

N-ADMG. To estimate the parameters of the variational distribution defined by N-ADMG, we executed the code provided at the official repository[foot_1](#foot_1) For fairness, we used the same hyperparameters and architectures reported in their original work [Li et al. [2023]](#b29); in particular, we trained the models for 30k epochs. After this, we sampled 100k graphs from the learned distribution. It is worth mentioning that the constraints of bow-free ADMG are guaranteed in the N-ADMG samples only in an asymptotic sense. Thus, we manually removed any cyclic graphs from the learned distribution. Then, we proceeded exactly as with DCD to estimate both the average SHD and the average BIC under the variational distribution.

## C.2 Implementational details for AGFN

Masking. To ensure AGFN only samples ancestral graphs, we keep track of a binary mask m t that indicates which actions lead to a valid state at the iteration t of the generative process; this mask defines the support of the policy evaluated at the corresponding state. In more detail, let y t be the last layer embedding (prior to a softmax) at iteration t of the neural network used to parametrize the forward flow of AGFN. The probability distribution over the space of feasible actions is then  As expected, the improvements entailed by the expert's feedback become increasingly effective as we increase the expert's reliability from 0.1 to 0.9. Results reflect the outcome of 30 scenarios simulated accordingly to algorithm 1 with a random canonical diagram G ⋆ with 5 nodes. We used our active knowledge elicitation scheme to select the query at each iteration.

$p t = Softmax (y t ⊙ m t + ϵ • (1 -m t ))$for a large and negative constant ϵ. We empirically verified that ϵ = -10 5 is sufficient to avoid the sampling of non-ancestral graphs.

Exploratory policy. During training, we must use an exploratory policy that (i) enables the exploration of yet unvisited states within the pointed DAG and (ii) exploits highly valuable and already visited states. To alleviate this phenomenon, we also draw trajectories from a uniform policy, which is a widespread practice in the literature [[Bengio et al., 2021a](#)[, Deleu et al., 2022](#)[, Shen et al., 2023]](#b48). More precisely, let Ch(G t ) be the set of states (i.e., ancestral graphs) directly reachable from G t and α ∈ [0, 1].

At each iteration t of the generative process, we sample an action (either an edge to be appended to the graph or a signal to stop the process)

$a t ∼ (1 -α) • U(Ch(G t )) + α • π F (•|G t )$and modify G t accordingly. The parameter α quantifies the mean proportion of on-policy actions and represents a trade-off between choosing actions that lead to highly valuable states (α = 1) and actions that lead to unvisited states (α = 0). We fix α = 1 2 throughout the experiments. During inference, we set α = 1 to sample actions exclusively from the GFlowNet's learned policy.

Detection of invalid states. We use the algebraic condition in eq. ( [8](#formula_13)) to check whether a graph G is ancestral. At each iteration of the generative process, we draw an action from the current exploratory policy and test the ancestrality of the updated graph; if it is not ancestral, we revert the sampled action and mask it. Importantly, this protocol guarantees that all graphs sampled from AGFN are ancestral.

Batch sampling. We exploit batch sampling to fully leverage the power of GPU-based computing in AGFN. As both the maximum-log-likelihood-based reward and the validation of the states are parallelizable operations, we are able to distribute them across multiple processing units and efficiently draw samples from the learned distribution. Crucially, this end-to-end parallelization substantially improves the computational feasibility of our algorithm and is a notable feature generally unavailable in prior works [Zhang [2008b]](#), [Ogarrio et al. [2016]](#b41), [Rantanen et al. [2021]](#). We use a batch size of 256 for all the experiments -independently of the graph size.  

## Number of feedbacks

Figure [9](#): Human-aided AGFN significantly outperforms alternative CD algorithms. Updating AGFN's distribution according to the feedback of an oracle substantially improves AGFN's capacity to correctly identify the true ancestral graph; indeed, a single feedback is sufficient to yield results better than (or indistinguishable from) alternative CD algorithms. We select the sampled AG with the highest posterior reward as a point estimate of AGFN and use the same datasets listed in table 2. The plots summarize the results of 30 HITL simulations using π = 0.9 and an oracle as an expert (see algorithm 1).

as the reward upon which the GFlowNet is trained; if T → 0, the distribution p T ∝ R T converges to a point mass in R(G)'s mode and, if T → ∞, p T converges to an uniform distribution. This approach resembles the simulated tempering scheme commonly exploited in Monte Carlo methods [Marinari and Parisi [1992]](#b33) and was previously considered in the context of GFlowNets by [Zhang et al. [2023]](#). Figure [6](#fig_4) shows that progressively cold distributions (i.e., with T → 0) lead to progressively concentrated and decreasingly diverse samples. Notably, the use of cold distributions may be adequate if we are highly confident in our score and are mostly interested in high-scoring samples [e.g., as in [Rantanen et al., 2021]](#).

Sensitivity analysis for different noise levels. Figure [7](#fig_6) displays the effect of the feedback of an increasingly reliable expert over the expectations of both the SHD and the BIC. Notably, the usefulness of these feedbacks increases as the feedback noise decreases. This is expected as, for example, a completely unreliable expert consistently rules out only one of four possibilities for the features of each relation;

then, there remains a great ambiguity, albeit not as much as there was prior to their feedback, about the true nature of the elicited causal relation. Moreover, this experiment highlights the potential to adjust the reliability parameter π to incorporate knowledge into AGFN's learned distribution regarding the non-existence of a particular relation, rather than its existence. More specifically, assume that the expert is certain that there is no directed edge from the variable U to the variable V in the underlying ancestral graph; for instance, a doctor may be certain that cancer (U ) is not an ancestor (cause) of smoking (V ), but may be uncertain about the definite relation between U and V (i.e., smoking may or may not cause cancer). To incorporate such knowledge into our model, one approach is to set a necessarily small reliability parameter π (possibly, π = 0) along with the improbable relation U → V . This feedback will then be modeled as a relation unlikely to exist in the true ancestral graph. We emphasize that our model for the expert's responses is straightforwardly extensible to accommodate multiple feedbacks about the same causal relation under different reliability levels.

Ablation studies. Figure [8](#fig_7) shows the increase in the training efficiency due to our architectural designs for parametrizing both the forward and backward flows of AGFN. Noticeably, the use of a two-layer graph isomorphism network [GIN; [Xu et al., 2019]](#b56) with a 256-dimensional embedding for the forward flow entailed a decrease of more than 10x in the number of epochs required for successfully training AGFN; this highlights the effectiveness of an inductively biased architectural design for the parametrization of GFlowNet's flows. Correlatively, the use of a parametrized backward flow significantly enhances the training efficiency of AGFN and emphasizes the inadequacy of a uniformly distributed backward policy pointed out in a previous work [Shen et al. [2023]](#b48).

Human-aided AGFN versus alternative CD methods. Figure [9](#) exposes the significant enhancement of AGFN's point estimates entailed by our HITL framework for CD. This underlines the usefulness of the elicited knowledge, which is simply incorporated into our model through a re-weighting of the reward function, enabling the identification of the true ancestral graph. In contrast, most alternative CD algorithms cannot be as easily adapted to include various forms of expert knowledge -and such incorporation, when it is possible, usually precedes any inferential process [Andrews [2020]](#b1) or assumes the knowledge is perfect [Wang et al. [2022]](#).

![Figure1: Human-in-the-loop probabilistic CD. We first train an AGFN to fit a data-informed belief over AGs. Then, we iteratively refine it by 1) questioning (Q) experts on the relation between a highly informative pair of variables and 2) updating the belief given the potentially noisy answers (A). The histograms on top of the edges show marginals over edge types (green denotes ground truth). Notably, our belief increasingly concentrates on the true AG, 1 → 2 ↔ 3.]()

![Figure 3: Sampling quality. The reward-induced marginal distribution over graph features is adequately approximated by the marginal distribution learned by the GFlowNet.]()

![Figure5: CD with simulated human feedback. The top/bottom row shows the mean SHD/BIC of AGFN samples as a function of human interactions. Probing the expert about the edge that minimizes the mean cross-entropy leads to a faster decrease in BIC compared to a random strategy. The SHD decreases similarly in both cases. Results reflect the outcomes of 30 simulations.]()

![Figure 6: Tempered rewards. Training AGFN to sample from increasingly cold distributions (eq. (25)) enables us to increase the proportion of high-scoring graphs (i.e., with a low BIC-score) with the drawback of reducing the AGFN's sampling diversity.]()

![Figure7: Sensitivity of our active knowledge elicitation framework to the reliability of the expert. Each column represents either the expected SHD (top) or expected BIC (bottom) as a function of the degree of confidence π ∈ [0, 1] in the expert as a function of the number of feedbacks. As expected, the improvements entailed by the expert's feedback become increasingly effective as we increase the expert's reliability from 0.1 to 0.9. Results reflect the outcome of 30 scenarios simulated accordingly to algorithm 1 with a random canonical diagram G ⋆ with 5 nodes. We used our active knowledge elicitation scheme to select the query at each iteration.]()

![Figure 8: Architectural design of AGFN. Top: The inductively biased parametrization of AGFN's forward flow -based upon a GNN -enables the substantial reduction of the number of epochs required for training. Bottom: The use of a parametrized backward policy similarly enhances the training efficiency compared to a uniform policy. For both experiments, we considered L(θ) < 0.1 as the early stopping criterion to interrupt AGFN's training.]()

![SHD for point estimates. The mean SHD of the top-3 AGFN draws is comparable to or better than baselines.]()

Available online at https://gitlab.com/rbhatta8/dcd.

Available online at https://github.com/microsoft/causica/releases/tag/v0.0.0.

